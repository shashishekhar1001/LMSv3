var Markdown={};Markdown={regexes:{markdown_link:/(^|\s)\[(.+?)\]\(((?:https?:\/\/(?:www\.)?|www\.)[a-z0-9][^@ ]*?)\)(?=$|\s)/gi,markdown_quote:/(?:^|\n)!(.+?)(?:\n|$)/gm,markdown_heading:/(?:^|\n)(\#{1,6}) (.*?\S *)(?:\n|$)/gm,markdown_line:/(^|[\n])(\*{3,}|\-{3,})(?=$|[\n])(.*)/g,markdown_codeblock:/(^|\s)`{3}((?:(?:.*?$)\n)?(?:[\s\S]*?))`{3}(?=$|\s)/g,markdown_code:/(^|\s)\`(.*?\S *)?\`(?=$|\s)/g,markdown_bold:/(^|\s|[{\[])\*(.*?\S *)?\*(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_italic:/(^|\s|[{\[])\_(.*?\S *)?\_(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g,markdown_strike:/(^|\s|[{\[])\~(.*?\S *)?\~(?=$|\s|[\.,\?:;\-}\]](?:$|\s))/g},apply:function(a){return a=this.applyOnce(a),a=this.applyRecursive(a),a=this.decodeChars(a),a},applyOnce:function(a){return a=a.replace(this.regexes.markdown_link,this.getLinkHTML),a=a.replace(this.regexes.markdown_quote,this.getQuoteHTML),a=a.replace(this.regexes.markdown_heading,this.getHeadingHTML),a=a.replace(this.regexes.markdown_codeblock,this.getCodeblockHTML),a=a.replace(this.regexes.markdown_code,this.getCodeHTML),a},applyRecursive:function(a){return a=a.replace(this.regexes.markdown_bold,this.getBoldHTML),a=a.replace(this.regexes.markdown_italic,this.getItalicHTML),a=a.replace(this.regexes.markdown_strike,this.getStrikeHTML),a=a.replace(this.regexes.markdown_line,this.getLineHTML),a},getLinkHTML:function(a,b,c,d,e){var f=e==="www."?"http://"+d:d;return b+'<a href="'+f+'" target="_blank">'+Markdown.encodeChars(c)+"</a>"},getQuoteHTML:function(a,b){return b=$.trim(b),b.length===0?a:'<blockquote class="blkqote">'+Markdown.applyRecursive(b)+"</blockquote>"},getHeadingHTML:function(a,b,c){var d=b.length;return"<h"+d+">"+Markdown.encodeChars(c)+"</h"+d+">"},getLineHTML:function(a,b,c,d){return'<hr class="hr">'+Markdown.applyRecursive($.trim(d))},getCodeblockHTML:function(a,b,c){return c=$.trim(c),c.length===0?a:b+'<pre class="pre">'+Markdown.applyRecursive(c)+"</pre>"},getCodeHTML:function(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="`"||c[c.length-1]==="`"||c[0]===" "&&c[c.length-1]===" "?a:b+'<code class="code">'+Markdown.encodeChars(c)+"</code>"},getBoldHTML:function(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="*"||c[c.length-1]==="*"||c[0]===" "&&c[c.length-1]===" "?a:b+"<strong>"+Markdown.applyRecursive(c)+"</strong>"},getItalicHTML:function(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="_"||c[c.length-1]==="_"||c[0]===" "&&c[c.length-1]===" "?a:b+"<i>"+Markdown.applyRecursive(c)+"</i>"},getStrikeHTML:function(a,b,c){return!c||!c.match(/[^_*`~]/)||c[0]==="~"||c[c.length-1]==="~"||c[0]===" "&&c[c.length-1]===" "?a:b+"<strike>"+Markdown.applyRecursive(c)+"</strike>"},encodeChars:function(a){return a.replace(/\*/g,"&ast;").replace(/\_/g,"&#95;").replace(/\~/g,"&#126;")},decodeChars:function(a){return a.replace(/&ast;/g,"*").replace(/&#95;/g,"_").replace(/&#126;/g,"~")}};(function(){$Support={LSDB:parent.$ZSIQLSDB?parent.$ZSIQLSDB:opener?opener.$ZSIQLSDB:undefined,convlistindex:0,convlistlimit:{1:5,2:6,3:7},isallconvlistfetched:!1,getParent:function(){if(window.parent.$ZSIQWidget)return window.parent;if(window.opener&&opener.$ZSIQWidget)return window.opener},DEPT_ONLINESTATUES:"1",DEPT_OFFLINESTATUES:"2",DEPT_ENGAGESTATUES:"3",init:function(a){try{$Support.EmbedObj=new $SupportConfig(a),this.setTheme(a),$Support.Util.updateParentFontFamily(),this.isscript=a.params.src==="script",this.Util.setBrowserValues(),DynamicMsg.init();try{Self.status.init()}catch(b){}this.cachearr=[],this.checkAndShowUI(),$Support.Util.isPreview()&&$CWPreview.init(),window.parent.$ZSIQChatWindow.handleESCEvent(window)}catch(b){}},setTheme:function(a){this.theme="theme"+a.theme},isFloat:function(){return $Support.type==="float"},checkAndShowUI:function(a){$Support.appendMetaTag();var b=$Support.EmbedObj,c=this.getCookieValue("ZLD"+b.livelsid),d=this.getWaitingCookie(),e=this.getTriggerCookie();$UI.setContainer();var f=$Support.getParent().$ZSIQUtil.getAPIValues();if(window.parent.$ZSIQWidget.getWidgetObject().isshowcallbubble){$Support.container.append($Support.contentdiv=CallUIHandler.getInitialHtml()),handleDrag();return}$Support.Util.updateViewAttribute("msgarea");if($Support.Util.isPreview()){$UI.init(),this.Util.setTextareaHeight(),$Support.handleApiData(f);return}(f.floatwindowfields||f.customfield)&&$Support.handleFieldVisibility(f.floatwindowfields,f.customfield);if(e){$Support.Util.handleChatTrigger(e),$Support.isConversationAllowed()&&$Support.container.find("#showsiqconv").click();return}c&&(b.setVisitorName(c.name),b.setVisitorEmail(c.email)),clearTimeout($Support.Util.jsdownloadtimer),c&&c.cid&&c.cid!="-1"&&$Support.getParent().$ZSIQWidgetUI.getWidgetState()==$Support.getParent().$ZSIQWidgetUI.F_WINDOW?$Support.Util.downloadAdditionalFiles():$Support.Util.jsdownloadtimer=setTimeout($Support.Util.downloadAdditionalFiles,1e4);if(c&&c.cid&&c.cid!="-1"&&($Support.isFloat()||$Support.type=="personal")){this.handleChatCookie(c);var g=$Support.getUnreadCount();g&&$Support.isFloat()&&$Support.getParent().$ZSIQWidgetUI.updateCount(g),$Support.isBotChat&&d&&($Support.handleWaitingDisplay(!0,!0),$UI.showTransferWaiting())}else d&&$Support.isFloat()?(this.handleWaitingCookie(d),d.chid&&this.updateTranscriptFromSession()):b.status?($UI.init(),this.Util.setTextareaHeight()):(DynamicMsg.setValues($Support.getValuesForDynamicMsg()),$Support.Util.isPreview()&&($Support.contentdiv=""),$UI.updateOfflineUI(),$Support.isFloat()||this.Util.showOfflineBanner());if($Support.isConversationAllowed())$Support.container.find("#showsiqconv").click();else{var h=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");this.LSDB.removeSessionStore(h+"_conversation")}a!=-1?$Support.handleApiData(f):"",this.Util.bindUtilEvents(),$Support.Util.calculateContentHeight();if(avimpl.curr_status){CallImpl.isCallWithChat=!1;switch(avimpl.curr_status){case"connecting":$("body").append($Temp.getReconnectionUI(avimpl.attenderimgurl,"av.info.connecting"));break;case"ongoing":$("body").append($Temp.getOnCallUI(avimpl.attenderimgurl));break;case"outgoing":$("body").append($Temp.getOutgoingcallUI(avimpl.attenderimgurl,$Support.EmbedObj.attendername));break;case"reconnecting":$("body").append($Temp.getReconnectionUI(avimpl.attenderimgurl,"av.info.reconnecting"))}$("body").find("#faqcall").remove(),document.getElementsByClassName("zsembd_audiocl")[0].sdrag()}a!=-1?avimpl.checkOngoingCall():""},handleFieldVisibility:function(a,b){var c=$Support.EmbedObj,d=[];c.status&&a&&a.online?d=a.online.split(","):!c.status&&a&&a.offline&&(d=a.offline.split(","));if(b&&b.length!=0)try{$.each(b,function(a,b){b.index=a;var c=b.name,e=d.length;if(/^_default./.test(c)){var f=c.replace("_default.","");(f=="name"||f=="email"||f=="phone")&&d.indexOf(f)==-1&&d.push(f)}})}catch(e){}if(!d.length)return;c.eprops.isname[0]=!1,c.eprops.isemail[0]=!1,c.eprops.isphoneno[0]=!1;for(var f=0;f<d.length;f++){if(d[f]=="contactnumber"||d[f]=="phone")d[f]="phoneno";var g="is"+d[f];c.eprops[g]&&(c.eprops[g][0]=!0)}},handleChatCookie:function(a){var b=$Support.EmbedObj;this.updateCommonKeys(a);var c=b.visitorID;b.attenderimagefkey=a.imagefkey,b.uvid=a.uvid||b.uvid,b.question=a.ques,b.setAttender(a.attender),b.setAttenderZUID(a.attenderZUID),a.attenderuseragent&&b.setAttenderUserAgent(a.attenderuseragent),a.attendername=b.attendername=a["attname_"+c]||"",a.aboutme=a["aboutme_"+c]||"",b.attenderemail=a.attenderemail,$Support.proactive=a.isproactive,$Support.istriggeredchat=a.istriggeredchat,$Support.isBotChat=a.isbotchat,$Support.botchatprops=a.botchatprops,LSMessanger.setNickName(a.name),LSMessanger.register($Support.Util.productCode,b.vwmsid),$UI.setInnerHeader(a),this.updateTranscriptFromSession(),DynamicMsg.setValues($Support.getValuesForDynamicMsg()),avimpl.checkAudioCallButton()},updateTranscriptFromSession:function(){var a=$Support.EmbedObj,b=this.LSDB.getFromSession(a.chatID+"_transcript");b&&b.length&&(myMsgObj.sender=a.vwmsid,myMsgObj.dname=a.visitorname,this.Util.showChatUI(b))},startChat:function(){$Support.initiateChat()},initiateChat:function(a){DynamicMsg.setValues($Support.getValuesForDynamicMsg()),this.intime=(new Date).getTime(),this.LSDB.remove("ZLD"+$Support.EmbedObj.livelsid+"WTIME"),this.removeBroadCast();var b=this.getBotUser(),c=$Support.EmbedObj.attender;if(!c){var d=this.LSDB.get("ZLDPERSONALIZE");c=$Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&d?d:undefined}var e=!b||c&&b.indexOf(c)==-1,f=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj,g=f.isgdprenabled==1?!0:!1,h=this.EmbedObj.pprops,i=this.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent"),j=h.chatcookiepolicyurl,k=g&&JSON.parse(h.isgdprenabled)&&JSON.parse(h.chatprivacyconfig)==1&&!i?!0:!1;CallImpl.isCallAloneEmbed()||this.handleWaitingDisplay(null,null,!e,k),LSMessanger.setNickName($Support.EmbedObj.visitorname);if(k){var l=$Support.contentdiv;l.find(".sqico-edit").remove(),l.find("div[purpose=name]").attr("documentclick",""),$UI.hideUserEditUI(),$UI.appendChatConsentDiv(a,!1,j);return}a||LSMessanger.sid?$Support.addVisitor():this.EmbedObj.vwmsid?LSMessanger.register($Support.Util.productCode,this.EmbedObj.vwmsid):$Support.getAnnonID($Support.EmbedObj.visitorname)},updateInputValues:function(){$Support.container.find("[purpose]").each(function(){var a=$(this),b=a.attr("purpose"),c=a.val()||a.attr("val");if(isUndefined(c)||c=="")return!0;$Support.EmbedObj[b]=c}),$Support.updateVisitorName()},updateVisitorName:function(){var a=$Support.EmbedObj;if(a.visitorname)return;var b=a.visitoremail;if(b){a.setVisitorName(b.split("@")[0]);return}a.setVisitorName("Visitor "+Math.round(Math.random()*1e5))},storeInCookie:function(a,b,c){var d=parent.$ZSIQCookie?parent.$ZSIQCookie:opener?opener.$ZSIQCookie:undefined;a=_SCREENNAME+"-"+a,d.set(a,b,c)},addVisitor:function(){var a=this,b=a.EmbedObj;CallImpl.isCallAloneEmbed()&&(b.question=LSResource.getRealValue("av.info.callquesmsg",b.visitorname),b.isaudiocall=!0);var c=lsnocachefix("json");typeof b.question=="undefined"&&(b.question=$.trim(this.composer.val())),$.extend(c,Browser.getInfo(),{referrer:processInput("trimlength",c.referrer,3e3),currentpage:processInput("trimlength",c.currentpage,950),name:b.visitorname,lsid:b.livelsid,email:processInput("emailid",b.visitoremail),ques:b.question,deptid:b.department,annonid:b.vwmsid,platform:navigator.platform,embeduniquename:b.embedname,autotrigger:$Support.istrigmsg}),$.extend(c,$Support.getCaptcha),b.uvid&&(c.uvid=b.uvid),$Support.istrigmsg&&$Support.Util.handleCallbacks("visitor.triggerresponded",{});var d=b.attender,e=this.LSDB.get("ZLDPERSONALIZE");d!=null&&d!=""?c.attender=d:$Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&e&&(c.attender=e),b.visitorphone&&(c.phone=b.visitorphone);var f=b.attenderemail;f&&(avimpl.attenderemail=c.attenderemail=f);var g=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");g&&(c.avuid=g);var h=$Support.getParent().$ZSIQUtil.getAPIVisitorID();h&&(c.cvuid=h);var i=b.cinfo;if($Support.getParent().$ZSIQChat.getWidgetData().embedobj.ismailchimpenabled&&!$Support.getParent().$ZSIQChat.istrackedfrommailchimp){c.mc_cid=$Support.getParent().$ZSIQUtil.getURLParameterByName("mc_cid"),c.mc_eid=$Support.getParent().$ZSIQUtil.getURLParameterByName("mc_eid");if(c.mc_cid!=null&&c.mc_cid!=""&&c.mc_eid!=null&&c.mc_eid!="")$Support.storeInCookie("mc_cid",c.mc_cid,864e5),$Support.storeInCookie("mc_eid",c.mc_eid,864e5);else{var j=$Support.getCookieValue("mailchimp");if(j){var k=j;typeof j=="string"&&(j=JSON.parse(k)),c.name=k.name,c.email=k.email}else c.mc_cid=$Support.getCookieValue("mc_cid"),c.mc_eid=$Support.getCookieValue("mc_eid")}if(c.mc_cid==null||c.mc_cid==""||c.mc_eid==null||c.mc_eid=="")c.mc_cid=undefined,c.mc_eid=undefined}else{var j=$Support.getCookieValue("mailchimp");if(j){var k=j;typeof j=="string"&&(j=JSON.parse(k)),c.name=k.name,c.email=k.email}}var l=b.exid;l&&(c.exid=l),i&&(typeof i=="object"&&(i=JSON.stringify(i)),c.cinfo=i),$Support.Util.isCampaignEnabled()&&$Support.subscribe&&(c.subscribe="true");var m=$Support.getParent().$ZSIQUtil.getAPIValues();m.triggermsg&&b.pmsg&&(c.prevtrigg=b.pmsg),c.includebots=!0,m.waitime&&(c.custom_waitime=m.waitime);if(b.isaudiocall){CallImpl.isCallWithChat=!0,CallImpl.updateUI(AV_OUTGOINGCALL),c.isaudiocall=b.isaudiocall,EmbedSound.play("outgoingcall",60),this.LSDB.remove("av_call"),this.LSDB.set("av_call",!0);var n=$Support.waitingtime||$Support.EmbedObj.embedwaitingtime;this.LSDB.set("ZLD_ApiAVCall",!0,n*1e3),clearTimeout(avimpl.ApiCalltimer),avimpl.ApiCalltimer=setTimeout(function(){avimpl.terminateAudioCall();var a={attenderemail:avimpl.attenderemail,waitingduration:n};avimpl.handleUserBusy(),$Support.Util.handleCallbacks("call.missed",a)},n*1e3),$Support.setWaitingCookie(),avimpl.attenderemail&&(c.attenderemail=avimpl.attenderemail)}this.handleAjax("addvist",c,function(c){var d=c.objString;d.CLEARBITINFO&&(DynamicMsg.updateClearBitValues(JSON.parse(d.CLEARBITINFO)),delete d.CLEARBITINFO),DynamicMsg.setValues(d),$Support.EmbedObj.feedbackcomplete=DynamicMsg.fillValues($Support.EmbedObj.feedbackcomplete),a.updateAddVistObj(d);if(c.objType==="object"&&d.ERROR==="EMBEDOFFLINE"){a.handleAddVisitStatusChange(d);return}var e=d.ATTENDER;e&&b.attender!=e&&(b.attendername=b.attenderemail),b.setAttender(e),b.setVisitID(d.VISIT_ID),b.setChatID(d.CHID),$Support.isBotChat=""+d.ISBOTCHAT=="true"?!0:!1,b.isaudiocall||$UI.hideCaptcha(),a.deleteTriggerCookie(),a.handleTrigAddVist(d);if(!$Support.istriggeredchat){var f=(new Date).getTime()-parseInt(d.DIFFTIME),g=f-a.intime;a.latency=g/(a.remwaitingtime+g)*a.stepinterval,a.setWaitingCookie()}else a.setCookie();delete a.rating;var h={name:b.visitorname,email:b.visitoremail,question:b.question,visitid:b.VISITID};h.phone=b.visitorphone?b.visitorphone:"",h.customfields=b.cinfo?b.cinfo:"",$Support.istriggeredchat?a.Util.handleCallbacks("visitor.triggeredchat",h):a.Util.handleCallbacks("visitor.chat",h),b.isaudiocall||$Support.handleOnGoingchatActionsInConversation("newchat"),delete b.isaudiocall},function(c){a.addVisitErrorHandling(c),delete b.isaudiocall})},addVisitErrorHandling:function(a){if(/module/.test(a.responseText))try{var b=JSON.parse(a.responseText),c=b[0].objString.digest;c?setTimeout(function(){$UI.showCaptcha(c)},300):$UI.updateOfflineUI();return}catch(d){}},updateAddVistObj:function(a){var b=this.EmbedObj;b.setVisitorName(a.NAME),b.setVisitorEmail(a.EMAIL),b.setVisitorID(a.CU_ID)},handleTrigAddVist:function(a){var b=a.ADDINFO;if(!b)return;b=JSON.parse(b),$Support.istrigmsg&&b[ADDINFO_TRIGGER]&&(this.istriggeredchat=!0,delete $Support.istrigmsg,$UI.hideUserEditUI(),$UI.populateVisitorQuestion(),$Support.getComposer().attr("dockeyup","sendmessage").val(""),$Support.EmbedObj.setChatID(a.CHID),_JOINED=!0),$Support.isBotChat&&$UI.appendTransferDiv()},handleWaitingDisplay:function(a,b,c,d){if(this.istriggeredchat)return;if(d){$Support.waitingtime=this.EmbedObj.embedwaitingtime,$UI.showWaitingUI(!0);return}clearTimeout(this.waitTimer);var e=$Support.remwaitingtime=$Support.getWaitingHandlerCookie().remwaitingtime,f=Math.round(e/1e3),g=$Support.EmbedObj;this.waitingtime=f;var h=typeof $Support.nochatforward=="undefined"?!0:$Support.nochatforward;g.attender&&h&&this.waitingtime==Math.floor(g.embedwaitingtime/2)&&!b&&$Support.broadcastVisitor();if(e<=0){this.LSDB.remove("ZLD"+g.livelsid+"WTIME"),this.removeBroadCast();if(b){$Support.botchatprops.status="missed",$Support.setCookie(),$UI.showTransferMissed();var i={};i.chid=g.chid,$Support.handleOnGoingchatActionsInConversation("missedchat",i)}else this.handleMissed("CWTOUT","2",!0);return}if($Support.Util.isApiWaitHandler())try{$Support.Util.handleCallbacks("chat.waitinghandler",{WTIME:g.embedwaitingtime,CURRENTTIME:f,waitingtime:g.embedwaitingtime,currenttime:f})}catch(j){}a?$UI.updateWaitingTime():$UI.showWaitingUI(c),this.stepinterval||(this.stepinterval=500),this.waitTimer=setTimeout(function(){$Support.handleWaitingDisplay(!0,b)},$Support.stepinterval)},handlePickUp:function(a){var b=this.EmbedObj;$Support.isBotChat=""+a.isbotpickup=="true"?!0:!1,$Support.botchatprops={status:"connected"},b.setAttender(a.attender),$Support.isBotChat&&$Support.contentdiv.stop(!1,!1,!0),this.removeCookie("ZLD"+b.livelsid+"WAITING"),this.LSDB.remove("ZLD"+b.livelsid+"WTIME"),this.removeBroadCast(),this.composer&&this.composer.removeAttr("disabled"),$UI.removeCWaitHandler(),clearTimeout(this.waitTimer),handlePaste(),delete this.istriggeredchat,delete this.proactive,delete this.waitingtime,b.setChatID(a.chid),b.setVisitorID(a.visitorid),b.setAttender(a.attender),b.setAttenderZUID(a.attenderzuid),b.setAttenderUserAgent(a.attender_useragent),b.chatintime=$Support.intime;var c=CallImpl.isCallWithChat;c?"":$UI.hideBanner(),b.attenderimagefkey=a.image_fkey,c?"":$UI.setInnerHeader(a),b.attendername=getUnescapedText(a.attendername),b.attenderemail=a.attenderemail,b.attenderaboutme=a.aboutme,DynamicMsg.updateValue("attendername",b.attendername),DynamicMsg.updateValue("attenderemail",b.attenderemail),LSMessanger.joinchat(a.chid,b.vwmsid),this.setCookie(),c?"":$UI.populateUserAction(),c?"":$UI.populateSmileyIcon(),avimpl.checkAudioCallButton();var d=parseInt(a.pickuptime)-parseInt($Support.intime),e={attendername:b.attendername,attenderemail:b.attenderemail,visitid:b.VISITID,waitingduration:d};$Support.Util.handleCallbacks("visitor.attend",e)},sendMessage:function(a,b){var c=this.EmbedObj,d=c.chatID;if(c.visitorID!==-1)return b.val(""),Message.send(d,a),!1;d!==-1&&this.joinProactiveChat(a)},handleSendMessage:function(a,b,c){try{this.endtimer&&this.clearEndTimer(),b!=16&&Self.status.active(c)}catch(c){}this.Util.handlePredictMsg(a);if(b==13&&c.shiftKey)return this.Util.calculateTextareaHeight(),!0;this.toggleSendButton(a);if(b==13){if(!Smiley.handleInSertSmiley(null,c.target))return this.Util.calculateTextareaHeight(),!1;this.triggerSendMessage(a),c.preventDefault()}var d=$Support.EmbedObj.eprops;JSON.parse(d.showsmiley)&&Smiley.checkAndTriggerSmiley(c,b),this.Util.calculateTextareaHeight()},toggleSendButton:function(a){var a=a||$Support.getComposer();$.trim(a.val())===""?$Support.Util.removeSendClickAction():$("#sqico-send").attr("documentclick",a.attr("dockeyup"))},triggerSendMessage:function(a){var b=this.Util;clearTimeout(b.prdcttimer),a=a||$Support.getComposer();var c=$.trim(a.val());if(c=="")return;if(Licence.verify("creditmask")&&Message.checkMaskOccurance(c,!0)){$UI.appendConsentDiv(!1),$Support.disableTextarea();var d=document.getElementById("msgmaindiv");Message.scroll(d)}else this.getUserConsent(0,a)},getUserConsent:function(a,b){var c=a==1?!0:!1,d=this.Util;clearTimeout(d.prdcttimer),b=b||$Support.getComposer();var e=$.trim(b.val());c&&(e=Message.checkMaskOccurance(e,!1)),this.endtimer&&$Support.clearEndTimer(),this.sendMessage(e,b),$Support.Util.removeSendClickAction(),$UI.removeConsentDiv(),$Support.enableTextarea(),$Support.Util.calculateTextareaHeight(),d.enablepmsg=!1},getChatUserConsent:function(a,b,c){if(a==0){this.closeChatConsentCallBk(c),$UI.removeChatConsentDiv();return}$Support.LSDB.storeInSession(_SCREENNAME+"_gdpr_chatconsent",!0);if(c&&$Support.proactivedata){$UI.populateUserAction(),$UI.populateSmileyIcon(),handlePaste(),$Support.startProactiveChat($Support.proactivedata),$UI.removeChatConsentDiv();return}$Support.istriggeredchat||$Support.startWaitingTimer(),b||LSMessanger.sid?$Support.addVisitor():this.EmbedObj.vwmsid?LSMessanger.register($Support.Util.productCode,this.EmbedObj.vwmsid):$Support.getAnnonID($Support.EmbedObj.visitorname),$UI.removeChatConsentDiv()},startWaitingTimer:function(){$UI.showWaitingUI(),$Support.stepinterval||($Support.stepinterval=500),$Support.waitTimer=setTimeout(function(){$Support.handleWaitingDisplay(!0,null)},$Support.stepinterval)},startProactiveChat:function(a){var b=this.EmbedObj,c=$Support.getComposer();c.val(""),$("#msgarea").val(""),Message.displaySendMessage(b.chatID,b.question),$Support.handleAjax("joinproactive",a,function(a){$Support.Util.handleUpdateBTN();var b=a.objType;b!="error"&&($Support.handleJoinProActive(a.objString),$Support.Util.handleCallbacks("visitor.triggerresponded",{}))})},closeChatConsentCallBk:function(a){if(a||$Support.istriggeredchat){$Support.istriggeredchat&&this.getComposer().attr("dockeyup","triggermsg");var b=$Support.getComposer();b.val(""),$("#msgarea").val(""),$Support.getParent().$ZSIQChatWindow.closeChatWindow();return}$Support.getParent().$ZSIQChatWindow.closeChatWindow(),setTimeout(function(){$Support.Util.closeEmbed(),1e3})},chatWindowUICallBk:function(){var a=this.composer=$Support.getComposer(),b=$Support.getParent().$ZSIQUtil.getCookieValue("state");a.val(""),(this.EmbedObj.chatID==-1||!this.EmbedObj.chatID)&&$UI.populateVisitorQuestion(),this.handleComposerEvents();var c=this.istrigmsg;if(this.proactive||c){c||(this.updateTranscriptFromSession(),a.attr("dockeyup","sendmessage")),b==2&&$Support.getParent().$ZSIQChatWindow.expandChatWindow(),c&&a.attr("dockeyup","triggermsg");return}var d=this.EmbedObj.addinfo.autochat;d&&""+d=="true"&&$Support.getParent().$ZSIQChatWindow.expandChatWindow()},handleComposerEvents:function(){this.composer.on("focus.blinktitle keyup.blinktitle click.blinktitle",function(){$Support.iscomposerfocus=!0,Message.stopBlinking()}),this.composer.bind("blur.blinktitle",function(){$Support.iscomposerfocus=!1})},reJoin:function(){var a=this,b=a.EmbedObj,c=lsnocachefix("json");c.visitorid=b.visitorID,this.handleAjax("rejoinvisitor",c,function(c){if(c.objType!="error"){var d=c.objString,e=d.chid?d.chid:b.chatID();b.setChatID(e),LSMessanger.joinchat(e,b.vwmsid),d.visitid&&(b.VISITID=d.visitid);if(d.ispickup){var f=$Support.getCookieValue("ZLD"+b.livelsid);(!f||f&&!f.cid)&&a.handlePickUp(d)}}})},handleMissed:function(a,b,c){$UI.removeCWaitHandler(),this.missedVisitorAction(a,b,c)},missedVisitorAction:function(a,b,c){var d={};d=lsnocachefix("json");var e=$Support.EmbedObj;d={lsid:e.livelsid,visitorid:encodeURIComponent(e.visitorID),vwmsid:e.vwmsid,mode:"visitor",debuginfo:CommonUtil.toJSON({"Missed By":a}),actiontype:b},this.handleAjax("missedvisitor",d,function(b){$Support.handleMissedVisitor(b.objType!="error",a)},function(a){})},handleMissedVisitor:function(a,b,c,d){$Support.callquitstatus=!0,LSMessanger.disable(),clearTimeout($Support.waitTimer),$Support.removeChatCookie();if(!a)return;if(b&&b=="ONHAS")$Support.init($Support.getParent().$ZSIQWidget.getEmbedObject()),$Support.getParent().$ZSIQChatWindow.constructIframe();else if(!$Support.waitingtime||$Support.waitingtime<=0){var e=$Support.EmbedObj;e.setPrevCHID(e.chatID),e.setChatID(-1),$UI.showMissedVisitorBanner(d),$("#msgarea").after($Temp.getSendIcon(!0));if(!c){var f={name:e.visitorname,email:e.visitoremail,question:e.question,visitid:e.VISITID};f.phone=e.visitorphone?e.visitorphone:"",f.customfields=e.cinfo?e.cinfo:"",$Support.Util.handleCallbacks("visitor.missed",f)}}var g={};g.chid=e.lchid,$Support.handleOnGoingchatActionsInConversation("missedchat",g)},transferMissedLeaveMessage:function(a){$Support.callquitstatus=!0,LSMessanger.disable(),$Support.removeChatCookie();var b=$Support.EmbedObj;b.setPrevCHID(b.chatID),b.setChatID(-1);var c=!1;a.attr("purpose")=="offline"&&(c=!0),$TH.handleMissedStatus(c)},handleLeaveMessage:function(){$Support.sendOfflineMsg()},getComposer:function(){return $Support.composer||$("#msgarea")},sendOfflineMsg:function(){var a={},b=$Support,c=b.EmbedObj,d=b.getComposer(),e=$.trim(d.val());$.extend(a,Browser.getInfo(),{referrer:processInput("trimlength",a.referrer,3e3),currentpage:processInput("trimlength",a.currentpage,950),lsid:c.livelsid,email:processInput("emailid",c.visitoremail),name:c.visitorname,msg:e,deptid:c.department,isengaged:b.engaged||!1}),this.updateDynamicKeys(a),c.visitorphone&&(a.phone=c.visitorphone),c.uvid&&(a.uvid=c.uvid);var f=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");f&&(a.avuid=f);var g=$Support.getParent().$ZSIQUtil.getAPIVisitorID();g&&(a.cvuid=g);var h=c.exid;h&&(a.exid=h);var i=c.cinfo;i&&(typeof i=="object"&&(i=JSON.stringify(i)),a.cinfo=i);var j=this.LSDB.get("ZLDPERSONALIZE"),k,l;if($Support.getParent().$ZSIQChat.getWidgetData().widgettype==$Support.getParent().SIQ_PERSONALIZE&&j){a.attender=j;var m=$Support.getParent().$ZSIQWidgetUI.getUserObj(j);k=m.name,l=m.image_fkey}a.includebots=!0,$Support.LSDB.storeInSession(_SCREENNAME+"_gdpr_chatconsent",!0),$UI.removeOfflineConsentDiv(),b.handleAjax("leavemsg",a,function(a){if(a.objType!="error"&&a.module=="leavemsg"){var f=a.objString;if(a.objType==="object"&&f.ERROR==="EMBEDONLINE"){b.handleLeaveMessageStatusChange(f);return}$EmbedManger.setQuitStatus(!0);var g=$Support.getAggregateStatus(c.deptlist),h=b.engaged?c.engagedrespmsg:g[0]&&c.deptofflinerespmsg?c.deptofflinerespmsg:c.offlinerespmsg;DynamicMsg.updateValue("visit_id",f.visit_id),$Support.Util.removeSendClickAction(),$Support.bannertimeout=setTimeout(function(){$UI.showBanner(DynamicMsg.fillValues(h),!0,$Support.Util.minimizeEmbed,5e3),$("#info_banr").removeClass("relate"),$Support.Util.setTextareaHeight()},700),d.val("");var i={name:c.visitorname,email:c.visitoremail,question:e,visitid:f.visit_id};i.phone=c.visitorphone?c.visitorphone:"",i.customfields=c.cinfo?c.cinfo:"",$Support.Util.handleCallbacks("visitor.offline",i);var j={};j.question=getEscapedText(e),j.endtime=f.servertime,j.name=f.name,j.visitorid=f.encvisitorid,k&&(j.attender=k,j.attender_imgkey=l),$Support.handleOnGoingchatActionsInConversation("leavemsg",j)}})},setInfoCookie:function(a){var b=$Support.EmbedObj,c=$Support.container,d={question:a};CommonUtil.addIfExists(d,"name",c.find('[info = "name"]').val()),CommonUtil.addIfExists(d,"email",c.find('[info = "email"]').val()),CommonUtil.addIfExists(d,"phone",c.find('[info = "phone"]').val()),this.LSDB.set("ZLD"+b.livelsid+"VISITORINFO",d,6e4)},handleTriggerMsg:function(a,b,c){if(b==13&&c.shiftKey)return!0;$Support.toggleSendButton(a),b===13&&this.startTriggerChat(a)},startTriggerChat:function(a){a=a||this.getComposer();if($.trim(a.val())==="")return!1;this.istriggeredchat=!0;var b=$Support.EmbedObj;if(b.department==-1||$Support.Util.IsMandatoryFieldsAvailable()){this.disableTextarea(a),$UI.showUserEditUI(),$Support.container.find('[documentclick="updateuserdetails"]').attr("callback","trigger");return}this.enableTextarea(a),$Support.updateVisitorName(),$Support.Util.removeSendClickAction(),this.getComposer().attr("dockeyup","sendmessage"),$Support.startChat()},disableTextarea:function(a){a=a||$Support.getComposer(),a.attr("disabled","true")},enableTextarea:function(a){a=a||$Support.getComposer(),a.removeAttr("disabled")},missedLeaveMsg:function(a){var b=$Support;b.ismissed=!0,a=a||b.getComposer(),eobj=b.EmbedObj;var c=$.trim(a.val());if(Licence.verify("creditmask")&&Message.checkMaskOccurance(c,!0)){$UI.appendConsentDiv(!0),b.disableTextarea(a);var d=document.getElementById("msgmaindiv");Message.scroll(d)}else this.getMissedUserConsent(0,a)},getMissedUserConsent:function(a,b){var c=a==1?!0:!1,d=$Support;b=b||d.getComposer();var e=d.EmbedObj,f=e.lchid,g=$.trim(b.val());e.setPrevCHID(-1),c&&(g=Message.checkMaskOccurance(g,!1)),Message.send(f,g),$UI.removeConsentDiv(),d.Util.calculateTextareaHeight(),$UI.hideUserEditUI();var h={},h=lsnocachefix("json");h.lsid=e.livelsid,h.visitorid=e.visitorID,h.msg=g,h.dname=e.visitorname,h.email=e.visitoremail,h.vwmsid=e.vwmsid,e.visitorphone&&(h.phone=e.visitorphone),d.updateDynamicKeys(h),d.handleAjax("missedleavemsg",h,function(a){if(a.objType!="error"&&a.module=="unattleavemessage"){d.disableTextarea(b),b.val(""),delete d.ismissed,DynamicMsg.updateValue("visit_id",a.objString.VISITID),d.removeChatCookie(),$Support.bannertimeout=setTimeout(function(){$UI.showBanner(DynamicMsg.fillValues($Support.EmbedObj.missedrespmsg),!0,function(){$Support.Util.closeEmbed()}),$("#info_banr").removeClass("relate"),$Support.Util.setTextareaHeight()},1e3);var c={};c.msg=g,$Support.handleOnGoingchatActionsInConversation("missedleave",c)}})},setCookie:function(){var a=this.EmbedObj,b=a.visitorID;if(this.waitingtime||a.chatID===-1&&b===-1)return;clearTimeout($Support.timer);var c={name:a.visitorname,email:a.visitoremail,phone:a.visitorphone,cid:a.chatID,did:a.department,vid:a.visitorID,vwmsid:a.vwmsid,attender:a.attender,attenderzuid:a.attenderZUID,attenderuseragent:a.attenderuseragent,uvid:a.uvid,ques:a.question,visitid:a.VISITID,imagefkey:a.attenderimagefkey};a.chatintime&&(c.chatintime=a.chatintime);var d=$Support.getCookieValue("ZLD"+a.livelsid),e=d&&d["aboutme_"+b],f=d&&d["attname_"+b];c["aboutme_"+b]=e||a.attenderaboutme,c["attname_"+b]=f||a.attendername,CommonUtil.addIfExists(c,"attenderemail",a.attenderemail),$Support.proactive&&(c.isproactive=!0),$Support.istriggeredchat&&(c.istriggeredchat=!0),$Support.isBotChat&&(c.isbotchat=!0,$Support.botchatprops&&(c.botchatprops=$Support.botchatprops));var g=3e5;this.LSDB.set("ZLD"+a.livelsid,c,g+1e4),$Support.timer=setTimeout(function(){$Support.setCookie()},g)},setWaitingCookie:function(a){var b=this.EmbedObj;if(!b.type||b.type=="embed")return;var c=b.embedwaitingtime,d={vid:b.visitorID,vwmsid:b.vwmsid,waitinghandlerprops:{intime:this.intime,latency:this.latency},name:b.visitorname,email:b.visitoremail,phone:b.visitorphone,did:b.deparment,chid:b.chatID,ques:b.question,visitid:b.VISITID};b.attender&&(d.attender=b.attender),this.LSDB.set("ZLD"+b.livelsid+"WAITING",d,c*1e3)},updateChatCookie:function(){clearTimeout($Support.timer);var a=this.EmbedObj,b={name:a.visitorname,email:a.visitoremail,phone:a.visitorphone};this.LSDB.set("ZLD"+a.livelsid,b,31e4)},removeCacheCookie:function(){this.LSDB.removeSessionStore(this.EmbedObj.chatID+"_transcript")},getCookieValue:function(a){return a?this.LSDB.get(a):""},isSessionTranscriptEmpty:function(){var a=this.LSDB.getFromSession(this.EmbedObj.chatID+"_transcript");return a&&a.length>0?!1:!0},getWaitingCookie:function(){var a=this.getCookieValue("ZLD"+this.EmbedObj.livelsid+"WAITING");try{if(PersonalSupport.type=="window")return""}catch(b){}return a},getWaitingHandlerCookie:function(){var a=this.EmbedObj,b="ZLD"+a.livelsid+"WTIME",c=this.LSDB.get(b);$Support.latency||($Support.latency=0);if(!c)c={remwaitingtime:a.embedwaitingtime*1e3,previouscalltime:(new Date).getTime()};else{var d=(new Date).getTime()-c.previouscalltime;c.remwaitingtime=c.remwaitingtime+parseInt($Support.latency)-d,c.previouscalltime=(new Date).getTime()}return this.LSDB.set(b,c,12e4),c},removeChatCookie:function(){clearTimeout($Support.timer),this.removeCookie("ZLD"+this.EmbedObj.livelsid)},getTriggerCookie:function(){if(this.isFloat())return this.getCookieValue("ZLDTRIGGER"+this.EmbedObj.livelsid)},setTriggerCookie:function(a){var b=this,c=b.EmbedObj;clearTimeout(b.triggercookietimer);var d=c.visitorname,e=c.visitoremail,f={sendername:a.sendername,message:a.message,uvid:c.uvid,name:d,email:e,cinfo:c.cinfo};a.attenderdetails&&(f.attenderdetails=a.attenderdetails);var g=3e5;this.LSDB.set("ZLDTRIGGER"+c.livelsid,f,g+1e4),b.triggercookietimer=setTimeout(function(){b.setTriggerCookie(a)},g)},deleteTriggerCookie:function(){clearTimeout(this.triggercookietimer),this.removeCookie("ZLDTRIGGER"+this.EmbedObj.livelsid)},removeCookie:function(a){this.LSDB.remove(a)},handleWaitingCookie:function(a){if(!this.isFloat())return!1;this.updateCommonKeys(a),LSMessanger.register($Support.Util.productCode,a.vwmsid),LSMessanger.setNickName(a.name);var b=a.chid,c=$Support.EmbedObj;c.question=a.ques,this.intime=a.intime,c.setChatID(b),$UI.setHeader(),$UI.setBody(!0),$UI.setFooter(),DynamicMsg.setValues($Support.getValuesForDynamicMsg()),$Support.handleWaitingDisplay("");var d=a.waitinghandlerprops;$Support.intime=d.intime,$Support.latency=d.latency},updateCommonKeys:function(a){var b=this.EmbedObj;b.setVisitorName(a.name),b.setVisitorEmail(a.email),b.setChatID(a.cid),b.setSelectedDept(a.did),b.setVisitorID(a.vid),b.setvwmsID(a.vwmsid),b.setVisitID(a.visitid),b.setVisitorPhone(a.phone),a.attender&&b.setAttender(a.attender),a.chatintime&&(b.chatintime=a.chatintime)},quitChat:function(){var a=$("#info_banr");a.find(".siq-share-url")[0]&&a.remove();var b=this.EmbedObj,c=b.visitorID;if(c===-1)return;var d={};d=lsnocachefix("json"),d={chid:b.chatID,lsid:b.livelsid,uname:LSMessanger.getUserId(),visitorid:encodeURIComponent(c),deptid:b.department,tzoffset:CommonUtil.TZOFFSET},CallImpl.isCallWithChat||avimpl.stopOngoingCallOnChatEnding(),this.handleAjax("leavesupport",d,function(a){var b=a.objString;$Support.handleChatEnded(b),$Support.convongoingchatobj&&($Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype")})},getAnnonID:function(a){var b={};b=lsnocachefix("json",!1),b.name=a,this.handleAjax("getannonid",b,function(a){if(a.module=="getannonid"){var b=a.objString,c=b.ANNONID;$Support.EmbedObj.vwmsid=c;var d=$Support.getParent().$ZSIQChat.getWidgetData();d.embedobj.annonid=c,$Support.getParent().$ZSIQUtil.storeDetails(d),LSMessanger.register($Support.Util.productCode,c)}})},handleChatEnded:function(a){if($EmbedManger.getQuitStatus())return;$Support.cacheCurrentChat(),$Support.clearEndTimer(),$("#msgarea").off("paste"),$UI.updateChatEndMsg(),$Support.Util.handleResize();var b=this.EmbedObj,c=b.thanksmsg;if(c)c=DynamicMsg.fillValues(c);else{var d;$Support.israting&&$Support.isfeedback?d="embed.thanksmsg.ratingandfeedback":$Support.israting?d="embed.thanksmsg.rating":$Support.isfeedback?d="embed.thanksmsg.feedback":d="embed.thanksmsg.noratingandfeedback",c=LSResource.getRealValue(d)}$UI.showBanner(c,!0,null,2500),this.LSDB.remove(b.chatID+"_sound"),this.LSDB.remove(b.chatID+"_translate"),$Support.hidetranslatebanner(),$UI.removeSmileyIcon(),$UI.showFeedback(),Message.scroll($Support.chatdiv[0]),Message.stopBlinking(),b.setPrevCHID(b.chatID),b.setChatID(-1),$Support.removeCacheCookie(),$Support.updateChatCookie(),$EmbedManger.setQuitStatus(!0),$Support.isBotChat&&($Support.botchatprops&&$Support.botchatprops.status&&$Support.botchatprops.status=="waiting"&&($Support.removeCookie("ZLD"+b.livelsid+"WAITING"),$UI.removeCWaitHandler(),clearTimeout($Support.waitTimer),delete $Support.waitingtime),$UI.removeTransferDiv()),delete $Support.ischatdisabled,delete $Support.botchatprops;var e={visitid:a.visitid,chatduration:a.chatduration};$Support.Util.handleCallbacks("visitor.chatcomplete",e),$Support.isipblocked&&this.removeWidget()},restartchat:function(){if($Support.Util.isPreview())return;var a=this.EmbedObj;$Support.callquitstatus=!1,a.setVisitorID(-1),a.setChatID(-1),a.setVisitID(-1),_JOINED=!1,Message.presender="",$Support.isfeedbacksent=!1,this.initiateChat(!0),$UI.setFooter()},sendMail:function(a,b,c){var d=$("#smailbx"),e=d.find("input"),b=e.val();if(e.attr("disabled")||b=="")return;var f=$Support.contentdiv.find('[documentclick="sendmail"]');c=f.attr("chid"),a=f.attr("visitorid");if(!this.Util.validateFields(d))return!1;$UI.hideUtilityDiv(d),$UI.populateSendMailConfirm(b,c)},sendMailConfirm:function(a){var b=$Support.EmbedObj,c=$("#consentbannerdiv"),d=$Support.contentdiv,e=!1,f=d.find(".infomsg.chtend");f.length&&(e=!0);if(a.hasClass("gltr-no")){$UI.hideUtilityDiv(c,!0,e);return}var g=a.attr("cattr");$UI.hideUtilityDiv(c,!0,e);var h=a.attr("chid")||b.chatID,i=b.visitorID,j={chid:h,fformat:"mail",toemail:$.trim(g),cmode:"live",visitorid:encodeURIComponent(i),oprname:"chat",user:b.vwmsid,tzoffset:_TZCOFFSET};this.handleAjax("visdataexport",j,function(){$UI.showBanner(LSResource.getRealValue("infomsg.mailsended"),!0),$Support.Util.handleCallbacks("chat.mail",{})},function(){$UI.showBanner(LSResource.getRealValue("ne.sendmail.failed"),!0)},LSResource.getRealValue("ne.mail.progress"))},updateTranslateCookie:function(){var a=$Support.contentdiv.find("#consentbannerdiv"),b=$Support.EmbedObj,c=b.chatID,d=c+"_translate";this.LSDB.set(d,!0),$UI.hideUtilityDiv(a,!0)},hidetranslatebanner:function(){var a=$Support.contentdiv.find("#consentbannerdiv");$UI.hideUtilityDiv(a,!0)},printPreview:function(){var a=$Support.EmbedObj,b=a.chatID,c=a.visitorID,d=_TZCOFFSET;if(b!=-1){if(b==null||b==undefined)return;var e=parseInt(80*screen.width/100),f=parseInt(77*screen.height/100),g=(screen.width-e)/2,h=(screen.height-f)/2,i=$Support.getAjaxURL("embedprintchat",".ls");i+="?chid="+encodeURIComponent(b)+"&visitorid="+encodeURIComponent(c)+"&tzoffset="+d+"&cross_domain=true",i+=lsnocachefix(),window.open(i,(new Date).getTime(),"height="+f+", width="+e+",status=yes,toolbar=no,top="+h+", left="+g+", menubar=no,location=no,scrollbars=yes,resizable=yes"),$Support.Util.handleCallbacks("chat.print",{})}$Support.Util.hideMoreActionDiv()},setRating:function(a){var b=this.rating=5-a.index(),c={};c=lsnocachefix("json"),c.rate=b,eobj=$Support.EmbedObj,c.visitorid=encodeURIComponent(eobj.visitorID),c.isbotchat=$Support.isBotChat,this.handleAjax("setsuppreprate",c,function(){if(CallImpl.isCallWithChat){CallImpl.updateUI(AV_FDBCK,b);var a={visitid:eobj.VISITID,rating:b,agent:eobj.attenderemail};$Support.Util.handleCallbacks("visitor.rating",a),$("#fdbkarea").slideDown(250,function(){$(this).focus()});return}var c=eobj["feedbackcomplete"+b]||LSResource.getRealValue("ne.rating."+b);$UI.showBanner(c,!0,null,2500);var a={visitid:eobj.VISITID,rating:b,agent:eobj.attenderemail};$Support.Util.handleCallbacks("visitor.rating",a),$("#fdbkarea").slideDown(250,function(){$(this).focus()}),$("#sqico-send").show();var d=$Support.contentdiv.find("#feedback_res").length>0&&$Support.contentdiv.find("#feedback_res").hasClass("lstmsg_strs");if(d||!$Support.isfeedbacksent)return;$UI.showFdbkResponse()})},handleAjax:function(a,b,c,d,e){if($Support["requestRunning_"+a])return;$Support["requestRunning_"+a]=!0;var f=!0,g=setTimeout(function(){e&&$UI.showBanner(e)},500);$.ajax({url:$Support.getAjaxURL(a,dext),type:"POST",data:b,dataType:"json",async:f,success:function(b){clearTimeout(g),c&&(c(b&&b[0]),delete $Support["requestRunning_"+a])},error:function(b,c,e){clearTimeout(g),d&&(d(b),delete $Support["requestRunning_"+a])}})},sendFeedback:function(a){a=a||$("#fdbkarea");if($Support.isfeedbacksent||a.val().length<1)return;var b={},c=this,d=$Support.EmbedObj,e=a.val();b=lsnocachefix("json"),b.visitorid=encodeURIComponent(d.visitorID),b.msg=e,CallImpl.updateUI(AV_FDBCKSUCCESS),this.handleAjax("visitorfeedback",b,function(b){if(b.objType!="error"&&b.module=="addfeedback"){if(CallImpl.isCallWithChat){var f={visitid:d.VISITID,rating:rating,agent:d.attenderemail};$Support.Util.handleCallbacks("visitor.rating",f);return}c.disableTextarea(a),$Support.isfeedbacksent=!0,$UI.showFdbkResponse();var f={visitid:d.VISITID,feedback:e,agent:d.attenderemail};$Support.Util.handleCallbacks("visitor.feedback",f)}},"",LSResource.getRealValue("ne.feedback.progress"))},handleEndSession:function(a,b){var c=this;clearTimeout(c.timervar),c.endtimer=!0,c.callquitstatus&&c.clearTimer(),a--;var d={};d.timer=a,d.isstart=b,$Support.handleOnGoingchatActionsInConversation("endtimerupdate",d);if(a>0){var e=$("#endtimer");if(!e.length)Message.displayInfo(LSResource.getRealValue("ne.chatend.timer",""+a));else{e.html(a+" sec");var d={};d.timer=a,$Support.handleOnGoingchatActionsInConversation("endtimerupdate",d)}c.timervar=setTimeout(function(){$Support.handleEndSession(a,!1)},1e3)}else c.clearEndTimer()},clearEndTimer:function(){clearTimeout($Support.timervar),this.endtimer&&($("#endtimer").parents(".infomsg").fadeOut(function(){$(this).remove()}),EmbedSound.stop(),$Support.handleOnGoingchatActionsInConversation("endtimerclear"))},updateVisitorInfo:function(a,b,c,d){if(!a&&!b&&!c)return;var e=$Support.EmbedObj,f=lsnocachefix("json");f.visitorid=e.visitorID,a&&(f.lastname=a),b&&(f.email=b),c&&(f.phone=c),f.isnamefromemail=e.isnamefromemail?e.isnamefromemail:!1,this.handleAjax("updatevistdata",f,function(f){$Support.Util.handleUpdateBTN(),f.objType!="error"&&(e.setVisitorEmail(b),e.setVisitorName(a),e.setVisitorPhone(c),$UI.updateVisitorName({name:a}),typeof d=="function"&&d(),$UI.hideUserEditUI(),$Support.setCookie())})},checkAndUpdateInfo:function(a){var b={"missed-leave":$Support.missedLeaveMsg,trigger:$Support.startChat,proactive:$Support.joinProactiveChat};$Support.checkCustomFields();var c=$Support.contentdiv.find("div.editfields");if(!this.Util.validateFields(c))return e.preventDefault(),!1;$Support.Util.handleUpdateBTN(!0);var d=c.find('input[purpose="visitorname"]'),f=c.find('input[purpose="visitoremail"]'),g=c.find('input[purpose="visitorphone"]'),h=$.trim(d.val()),i=$.trim(f.val()),j=$.trim(g.val()),k=a.attr("callback");!h&&i&&(h=i?i.split("@")[0]:h,$Support.EmbedObj.isnamefromemail=!0);var l=$Support.EmbedObj;i&&l.setVisitorEmail(i),h&&l.setVisitorName(h),j&&l.setVisitorPhone(j);if(k==="proactive"){b[k](),$UI.hideUserEditUI(),$Support.setCookie();return}k!=="trigger"?this.updateVisitorInfo(h,i,j,b[k]):(this.updateInputValues(),a.removeAttr("documentclick"),$Support.startChat())},joinProactiveChat:function(a){if($Support.Util.IsMandatoryFieldsAvailable()){this.disableTextarea(),$UI.showUserEditUI(),$('[documentclick="updateuserdetails"]').attr("callback","proactive");return}var b=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj,c=$Support.EmbedObj,d=c.pprops,e=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent"),f=b.isgdprenabled==1?!0:!1,g=f&&JSON.parse(d.isgdprenabled)&&JSON.parse(d.chatprivacyconfig)==1&&!e?!0:!1,h=d.chatcookiepolicyurl,i=Browser.getInfo(),j=$Support.getComposer();$Support.enableTextarea(j),a=a||$.trim(j.val()),LSMessanger.setNickName(c.visitorname),$.extend(i,{chid:c.chatID,uvid:c.uvid,vwmsid:c.vwmsid,msg:a,sid:LSMessanger.getSid(),name:c.visitorname}),c.visitorphone&&(i.phone=c.visitorphone),c.visitoremail&&(i.email=processInput("emailid",c.visitoremail));var k=lsnocachefix("json");for(var l in k)i[l]=k[l];c.cinfo&&(typeof c.cinfo=="object"&&(c.cinfo=JSON.stringify(c.cinfo)),i.cinfo=c.cinfo);var m=$Support.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");m&&(i.avuid=m);var n=$Support.getParent().$ZSIQUtil.getAPIVisitorID();n&&(i.cvuid=n),c.question=a;if(g){$Support.proactivedata=i,$UI.appendChatConsentDiv(!1,!0,h);return}j.val(""),$("#msgarea").val(""),Message.displaySendMessage(c.chatID,a),$UI.populateUserAction(),$UI.populateSmileyIcon(),handlePaste(),avimpl.checkAudioCallButton(),$Support.handleAjax("joinproactive",i,function(a){$Support.Util.handleUpdateBTN();var b=a.objType;b!="error"&&($Support.handleJoinProActive(a.objString),$Support.Util.handleCallbacks("visitor.triggerresponded",{}))})},handleJoinProActive:function(a){var b=$Support.EmbedObj;b.setVisitorID(a.CUID),b.VISITID=a.VISITID;var c=a.ATTENDER;c&&b.attender!==c&&b.setAttender(c),delete this.proactive,this.setCookie()},handleApiData:function(a,b){var c=$Support.EmbedObj;if(a){c.setAddinfo(a),c.uvid=a.uvid||c.uvid,c.visitorname=a.name||c.visitorname,c.visitoremail=a.email||c.visitoremail,c.visitorphone=a.phone||c.visitorphone,c.question=a.question||c.question,c.attenderemail=a.agent||c.attenderemail,c.messagehint=a.messagehint||"";if(a.department!=null){var d=a.department;a.department!="online.department"&&(a.department=[],a.defaultdepartment&&a.defaultdepartment!=-1&&d.indexOf(a.defaultdepartment)==-1&&d.push(a.defaultdepartment));var e=c.deptlist.length;for(var f=0;f<e;f++)d.indexOf(c.deptlist[f].DNAME)==-1?c.deptlist[f].isClient=!1:a.department!="online.department"&&a.department.push(c.deptlist[f].DNAME);if(a.department.length!=0){var g=d;d=a.department,$Support.type=="personal"&&$Support.status?PersonalSupport.handleDeptChange(d):this.Util.handleDeptApiChange(d,g)}}a.agent&&$.validateField("email",a.agent)&&(c.attenderemail=a.agent),a.info&&(c.cinfo=a.info);var h=a.requestid;h!=null&&!isNaN(h)&&(c.exid=h),!a.defaultdepartment&&a.department&&a.department.length==1&&(a.defaultdepartment=a.department[0]);var i=a.defaultdepartment;if(i&&i!=-1){if(!$Support.status||$Support.type!="personal"){var j=$("#sqico-drpdwn").find('li[uniname="'+i+'"]');j.length&&(j.trigger("click",[!0]),$Support.isFloat()||$Support.Util.showOfflineBanner())}else PersonalSupport.defaultdept=i;i&&a.department&&a.department.length==1&&a.department[0]==i&&$Support.container.find("#sqico-drpdwn").hide()}a.forward!==undefined&&($Support.nochatforward=a.forward),a["chat.waitinghandler"]&&!b&&($Support.isapiwaitinghandler=a["chat.waitinghandler"]);if(a.callback){var k=a.callback;if("chat.waitinghandler"in k){var l=k["chat.waitinghandler"];l=="-1"&&(l=null),$Support.cwaitmsg=l,$Support.waitingtime&&$UI.populateCWaitHandler();if(b)return}}a.chatstart&&c.chatID==-1&&b&&(CallImpl.isCallWithChat&&($Support.contentdiv=null,$Support.EmbedObj.lchid=-1,$Support.checkAndShowUI(-1),CallImpl.isCallWithChat=!1,$EmbedManger.setQuitStatus(!1)),$Support.getParent().$ZSIQWidgetUI.removeCallClass(),c.addinfo.autochat=!0,$Support.getComposer().trigger("keyup"));if(c.visitorID!=-1&&c.chatID!=-1&&a.chatstart){if(avimpl.curr_status=="outgoing")return;$EmbedManger.setQuitStatus(!1),CallImpl.isCallWithChat=null,$Support.contentdiv=null,$Support.getParent().$ZSIQWidgetUI.removeCallClass(),$Support.checkAndShowUI(-1);var m=$Support.getAjaxURL("makeav",dext),n={};n.chid=$Support.EmbedObj.chatID,n.wmsid=$Support.EmbedObj.vwmsid,n.mode=AUDIOCALL,n.lsuid=$Support.EmbedObj.attender,n.action="startchat",$.ajax({url:m,data:n,type:"POST"})}a.chatend&&c.chatID!==-1&&b&&$Support.quitChat();var o=a.chatmessages;if(o&&typeof o=="object"){c.waitmsg=o.waiting||c.waitmsg,c.offlinemessage=o.offline||c.offlinemessage,c.missedmessage=o.busy||c.missedmessage,c.offlinerespmsg=o.offlinecomplete||c.offlinerespmsg,c.thanksmsg=o.complete||c.thanksmsg,c.missedrespmsg=o.busycomplete||c.missedrespmsg,c.engagedmessage=o.engaged||c.engagedmessage,c.engagedrespmsg=o.engagedcomplete||c.engagedrespmsg,c.feedbackcomplete=o.feedbackcomplete;for(var f=1;f<=5;f++)o["feedbackcomplete"+f]&&(c["feedbackcomplete"+f]=o["feedbackcomplete"+f])}var p=a.customfield;if(p||a.clearcustomfield)p?(this.customobj=p,this.Util.handleCustomHTML()):this.Util.checkAndRemoveCustomField(a.clearcustomfield);a.title&&(document.title=a.title);var q=a["rating.visible"],r=a["feedback.visible"];if(q||r)q&&($Support.israting=q!="hide"),r&&($Support.isfeedback=r!="hide");if(a.clogo){var s=$("#complogo"),t=$("#compurl"),u=a.cwebsite;s.length&&s.attr("src",a.clogo),u&&(u=u.indexOf("http")==-1?"http://"+u:u,t.length?t.attr("href",u):s.wrapAll("<a id='compurl' target='_blank' href='"+u+"'>"))}$Support.EmbedObj.status&&a.floatwindowonlinetitle&&!$Support.EmbedObj.attender&&!$Support.getTriggerCookie()&&$("#attname").text(a.floatwindowonlinetitle),!$Support.EmbedObj.status&&a.floatwindowofflinetitle&&!$Support.EmbedObj.attender&&$("#attname").text(a.floatwindowofflinetitle),$Support.isConversationAllowed()&&a.defaultview&&a.defaultview=="Classic"&&this.openClassicUI();if(a.callstart&&c.chatID==-1&&b&&!$Support.proactive&&!$Support.istriggeredchat){if(avimpl.curr_status)return;avimpl.curr_status="outgoing";var v=LSResource.getRealValue("av.info.callquesmsg",c.visitorname);$Support.container.find('[info = "question"]').val(v),c.isaudiocall=!0,$Support.updateInputValues(),$Support.startChat(),$Support.container.remove(),$UI.setContainer();var w=$Support.getParent().$ZSIQUtil.getAPIValues();$Support.container.append($Support.contentdiv=CallUIHandler.getTempForThemes(AV_OUTGOINGCALL)),$Support.getParent().$ZSIQWidgetUI.handleMinimizeCall(),$Support.getParent().$ZSIQChatWindow.openChatWindow()}a.waitime&&$Support.EmbedObj.status&&($Support.EmbedObj.embedwaitingtime=a.waitime),this.updateValuesFromVisitorInfoCookie(),this.Util.fillApiValues()}},handleAPIFunctionalities:function(a,b){var c=$Support.EmbedObj;a=="chatstart"?(c.addinfo.autochat=!0,$Support.getComposer().trigger("keyup")):a=="chatend"&&c.chatID!==-1&&$Support.quitChat()},updateValuesFromVisitorInfoCookie:function(){var a=$Support.EmbedObj,b=this.getCookieValue("ZLD"+a.livelsid+"VISITORINFO");b&&(a.setVisitorName(b.name),a.setVisitorEmail(b.email),a.setAddinfo(b),b.phone&&a.setVisitorPhone(b.phone),this.removeCookie("ZLD"+a.livelsid+"VISITORINFO"))},getOfflineMessage:function(){var a=$Support.EmbedObj;if(a.bushrstatus)return $UI.getBusinessHrInfo();var b=a.deptlist,c=$Support.getAggregateStatus(b),d=c[1],e=c[0];return d?(this.engaged=!0,a.engagedmessage?DynamicMsg.fillValues(a.engagedmessage):LSResource.getRealValue(b.length>1&&e?"ne.engagedmsg_multidept":"ne.engagedmsg")):b.length>1&&e?a.deptofflinemsg?DynamicMsg.fillValues(a.deptofflinemsg):LSResource.getRealValue("ne.offlinemsg_multidept"):a.offlinemessage?DynamicMsg.fillValues(a.offlinemessage):LSResource.getRealValue("ne.offlinemsg")},getAggregateStatus:function(a){var b=!1,c=!1,d=$Support.EmbedObj.department;for(var e=0;e<a.length;e++){var f=a[e];""+f.STATUS=="true"&&(c=!0),(d==="-1"||f.ID===d)&&""+f.ENGAGED=="true"&&(b=!0)}return[c,b]},updateDynamicKeys:function(a){a.phone&&DynamicMsg.updateValue("phone",a.phone);var b=a.name||a.dname;DynamicMsg.updateValue("name",b),DynamicMsg.updateValue("email",a.email),a.msg&&DynamicMsg.updateValue("question",a.msg),a.deptid&&DynamicMsg.updateValue("department",a.deptid)},updateChatCache:function(a,b){b?($.isEmptyObject(a[a.length-1])&&a.splice(a.length-1,1),$Support.cachearr=a):$Support.cachearr.push(a),this.LSDB.storeInSession($Support.EmbedObj.chatID+"_transcript",$Support.cachearr)},isParentIframe:function(){return window.location!=window.parent.location},broadcastVisitor:function(a){var b=$Support.EmbedObj,c={};c.visitorid=b.visitorID,c.module=a?a:"addvisitor",$Support.LSDB.get("ZLD_ApiAVCall")&&(c.isaudiocall=$Support.LSDB.get("ZLD_ApiAVCall")),this.handleAjax("broadcastvisitor",c,function(a){if(a.module=="broadcastvisitordata"){var c=a.objString;if(c.isagentsavailable){var d=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.userdetails.find(function(a){return a.lsuid==b.attender}).name,e=LSResource.getRealValue("chatwindow.personalchat.transfer",d),f=e?e:getUnescapedText(Support.waitmsg);f=DynamicMsg.fillValues(f),$("#info_banr span").first().text(f).show()}}})},handleStatusCallback:function(){var a="chat.offline";$Support.EmbedObj.status&&(a="chat.online"),$Support.Util.handleCallbacks(a,{})},handleAudioCallback:function(){window.location.protocol.indexOf("https")>-1&&(navigator.userAgent.indexOf("Chrome")>-1||navigator.userAgent.indexOf("Firefox")>-1)&&$Support.Util.handleCallbacks("call.isavsupported",{})},checkCustomFields:function(){var a=$Support,b=a.EmbedObj,c=$Support.contentdiv.find('[purpose="custom"]');if(!c.length)return!0;var d=$Support.EmbedObj.cinfo||{};$.each(c,function(a,c){var e=$(c),f=e.attr("type"),g=e.attr("mandatory")=="true",h=e.attr("custom"),i=e.attr("visibility");if(b.status&&i=="offline")return!0;if(!b.status&&i=="online")return!0;if(f=="radio"||f=="checkbox"){var j=e.find("input:checked");h=e.attr("name");var k=[];return $.each(j,function(a,b){k.push($(b).attr("id"))}),k.length?(e.removeClass("errfield").removeAttr("data-validate"),d[h]=k.join(","),!0):(g&&e.addClass("errfield"),!0)}var l=e.val();f=="selectbox"&&(l=e.find("#dropheader").attr("val"));if(!l)return!0;d[h]=l}),b.cinfo=d},rejoinVisitorInUTS:function(){var a=lsnocachefix("json");a.visitorid=$Support.EmbedObj.visitorID,this.handleAjax("utsrejoin",a,function(a){})},isSignature:function(a){return a.eparams&&a.eparams.signature},handleDesktopSharing:function(a){if(a.msg){var b=a.msg.opruser.dname,c=decodeURIComponent(a.link),d=a.msg.opr,e="",f="";"request"==d?(e="chatwindow.requestdesktop",f="common.share"):(e="chatwindow.sharedesktop",f="common.join");var g=LSResource.getRealValue(e,b)+'&nbsp;&nbsp;<a href="'+c+'" target="_blank" documentclick=openmeeting>'+LSResource.getRealValue(f)+"</a>";this.Util.displayInfo(g)}$("#mraction").find("#sharedesktop").addClass("cmn_disable")},handleMeetingJoinCB:function(){this.Util.hideInfo(),$("#mraction").find("#sharedesktop").removeClass("cmn_disable")},shareDesktop:function(a){if($(a).hasClass("cmn_disable"))return;var b={};b.chid=$EmbedManger.getChatID(),b.attender=$Support.EmbedObj.attender,this.handleAjax("authenticatesharedesktop",b,function(a){$Support.Util.hideMoreActionDiv()})},isHandHeldDevice:function(){return $Support.Util.isSIQMobilePreview()?!0:/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1},isMobileWidth:function(){return window.outerWidth<555||this.isHandHeldDevice()},setUVID:function(a){$Support.EmbedObj.uvid=a},setTabOwner:function(){var a=$Support.EmbedObj,b="ZLD"+a.livelsid+"tabowner";this.LSDB.set(b,LSMessanger.getSid())},getTabOwner:function(){var a=$Support.EmbedObj,b="ZLD"+a.livelsid+"tabowner";return this.LSDB.get(b)},incrementUnreadCount:function(){var a=$Support.EmbedObj,b="ZLD"+a.livelsid+"unreadcount",c=$Support.getUnreadCount();c?c+=1:c=1,this.LSDB.set(b,c),$Support.getParent().$ZSIQWidgetUI.updateCount(c)},getUnreadCount:function(){var a=$Support.EmbedObj,b="ZLD"+a.livelsid+"unreadcount";return this.LSDB.get(b)},removeUnreadCookie:function(){var a=$Support.EmbedObj,b="ZLD"+a.livelsid+"unreadcount";this.LSDB.remove(b)},isAllowFreeLogo:function(){return!CommonUtil.isIntegratedPortal()&&(Licence.isFreePlan()||$Support.EmbedObj.isBetaPortal)},handleAddVisitStatusChange:function(a){var b=$Support.EmbedObj;clearTimeout($Support.waitTimer),delete $Support.waitingtime,$UI.hideBanner(),$Support.removeCookie("ZLD"+b.livelsid+"WAITING"),b.setDepartmentList(a.DEPTLIST),b.setEmbedStatus(a.STATUS),$Support.container.find(".msgbox textarea").stop(),$Support.container.empty(),$Support.contentdiv=undefined,$Support.composer=undefined,$UI.updateOfflineUI(!0),$Support.container.addClass("outerwin"),$Support.Util.showOfflineBanner(),$UI.setDepartment(b.department),b.question&&$("#sqico-send").attr("documentclick","leavemessage"),LSMessanger.sid=undefined;var c=$Support.getParent().$ZSIQWidget.getWidgetObject();c.status=a.STATUS,c.onlysticker=!0,$Support.getParent().$ZSIQWidgetUI.drawWidget(c),c.hideoffline&&c.hideoffline[0]==1&&($Support.disableTextarea($Support.getComposer()),setTimeout(function(){$Support.getParent().$ZSIQChatWindow.handleChatWindowVisible("hide"),$Support.getParent().$ZSIQWidgetUI.handleWidgetVisible("hide")},3e3)),$Support.isConversationAllowed()&&$Support.Util.handleShowConversation(!1,!0)},handleLeaveMessageStatusChange:function(a){var b=$Support.EmbedObj;b.setDepartmentList(a.DEPTLIST),b.setEmbedStatus(a.STATUS),$Support.container.find(".msgbox textarea").stop(),$Support.container.empty(),$Support.contentdiv=undefined,$Support.composer=undefined,$UI.updateOnlineUI(!0),$Support.container.addClass("outerwin"),$Support.Util.showOnlineBanner(),$UI.setDepartment(b.department),b.question&&$("#sqico-send").attr("documentclick","textarea"),LSMessanger.sid=undefined},getAjaxURL:function(a,b){return url=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/"+a+b},appendMetaTag:function(){$("head").append('<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">')},getValuesForDynamicMsg:function(){var a=$Support.EmbedObj,b={};CommonUtil.addIfExists(b,"name",a.visitorname),CommonUtil.addIfExists(b,"email",a.visitoremail),CommonUtil.addIfExists(b,"phone",a.visitorphone),CommonUtil.addIfExists(b,"department",a.department);var c=a.question?a.question:$Support.composer?$.trim($Support.composer.val()):"";return CommonUtil.addIfExists(b,"question",c),CommonUtil.addIfExists(b,"visit_id",a.VISITID),CommonUtil.addIfExists(b,"attendername",a.attendername),CommonUtil.addIfExists(b,"attenderemail",a.attenderemail),b},getValuesForDynamicMsg:function(){var a=$Support.EmbedObj,b={};CommonUtil.addIfExists(b,"name",a.visitorname),CommonUtil.addIfExists(b,"email",a.visitoremail),CommonUtil.addIfExists(b,"phone",a.visitorphone),CommonUtil.addIfExists(b,"department",a.department);var c=a.question?a.question:$Support.composer?$.trim($Support.composer.val()):"";return CommonUtil.addIfExists(b,"question",c),CommonUtil.addIfExists(b,"visit_id",a.VISITID),CommonUtil.addIfExists(b,"attendername",a.attendername),CommonUtil.addIfExists(b,"attenderemail",a.attenderemail),b},transferChat:function(){var a=lsnocachefix("json");a.visitorid=$Support.EmbedObj.visitorID,$Support.setWaitingCookie(),$UI.showTransferWaiting(),$Support.handleWaitingDisplay(!0,!0),this.handleAjax("transferchat",a,function(a){})},handleTransferMissed:function(a){$UI.removeTransferDiv();var b=lsnocachefix("json"),c=$Support.EmbedObj;b={lsid:c.livelsid,visitorid:encodeURIComponent(c.visitorID),vwmsid:c.vwmsid,mode:"visitor",actiontype:"2",isbottransfer:!0};var d=!1;a.attr("purpose")=="offline"&&(d=!0),this.handleAjax("missedvisitor",b,function(a){$Support.handleMissedVisitor(a.objType!="error",null,!0,d)})},hideTransferOption:function(){$UI.removeTransferDiv(),$Support.botchatprops.hidetransfer=!0,this.setCookie()},areUsersAvailable:function(){var a=$Support.EmbedObj,b=a.department;for(var c in a.deptlist)if(a.deptlist[c].ID==b)return!a.deptlist[c].ONLYBOTSAVAILABLE;return!1},getBotUser:function(){try{var a=$Support.EmbedObj,b=a.department,c=a.eprops.isbotenabled[1].mode,d=null;for(var e in a.deptlist)if(a.deptlist[e].ID==b){d=a.deptlist[e].BOTUSER;if(c=="1"||c=="2"&&a.deptlist[e].ONLYBOTSAVAILABLE)return d}}catch(f){}return null},isConversationAllowed:function(){if($Support.Util.isPreview())return!1;var a=$Support.EmbedObj;return JSON.parse(a.eprops.isconversation)&&Licence.verify("conversationallowed")},bindScrollForConversationListContainer:function(){$Support.convlistcontainer.scroll(function(a){var b=a.target;$Support.convongoingchatobj&&b.scrollTop==0&&$Support.removeConversationPopupMessage();if(b.scrollHeight-b.scrollTop===b.clientHeight){if($Support.convlistindex<$Support.convlistlimit[$Support.EmbedObj.windowsize])return;$Support.PopulateConversationList(function(a,b){if(!a.length)return;var c="";a.forEach(function(a){c+=$Temp.getConversationHistoryHTML(a)}),b?$Support.convlistcontainer.find("#pastchatconv").prepend($(c)):$Support.convlistcontainer.find("#pastchatconv").append(c),$Support.Util.showConversationListUI()},$Support.convlistindex+1)}})},PopulateConversationList:function(a,b){var c={},d=this,e,f=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");c=lsnocachefix("json");if(!f)return;var g=this.LSDB.getFromSession(f+"_conversation");if(g&&g.length&&!b){a(g);var h=g[0];e=h.endtime,e&&(c.fromtime=e),$Support.convlistindex=g.length}c.avuid=f;var i=$Support.getParent().$ZSIQUtil.getAPIVisitorID();i&&(c.cvuid=i),c.limit=$Support.convlistlimit[$Support.EmbedObj.windowsize];if(b){c.index=b;if(b!=0){if($Support.convlistcontainer.find("#convlistloading").length!=0||$Support.isallconvlistfetched)return;$Support.convlistcontainer.find("#pastchatconv").append($Temp.getConversationListLoadingHTML())}}this.handleAjax("conversation",c,function(b){$Support.convlistcontainer.find("#convlistloading").remove();if(b.objType!="error"){var c=b.objString;if(!c.length){e||($Support.isallconvlistfetched=!0);return}var d=e?!0:!1,g=e?!0:!1;$Support.updateConversationCache(c,f,g),a(c,g),$Support.convlistindex+=c.length}})},updateConversationCache:function(a,b,c){if(!a||!a.length)return;a=$Support.checkDuplicateInConversationList(a,b);var d=this.LSDB.getFromSession(b+"_conversation");d&&d.length&&(c?a=a.concat(d):a=d.concat(a)),this.LSDB.storeInSession(b+"_conversation",a)},checkDuplicateInConversationList:function(a,b){try{var c=this.LSDB.getFromSession(b+"_conversation");if(!c||!c.length)return a;for(var d=a.length-1;d>=0;d--){var e=a[d];for(var f=0;f<c.length;f++){var g=c[f];if(e.visitorid==g.visitorid){a.splice(d,1);break}}}}catch(h){}return a},getConversationChatTranscript:function(a,b){var c=Message.presender;$("#conversioncontainer").hide(),$Support.convtranscontainer.html($Temp.getLoadingHTML()).show();var d=this.LSDB.getFromSession(a+"_transcript");$Support.Util.showConversationTranscriptUI(b);var e=!1,f,g;d&&(f=d[0],g=$("#attname").html(),e=g==f.attendername);if(!a){var h=$Support.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid"),i=$Support.LSDB.getFromSession(h+"_conversation"),j={};for(var k in i){var l=i[k];if(l.visitorid==b){j=l;break}}var m={};m.question=getEscapedText(j.question),m.dname=j.name,m.mode="info",j.attender&&(m.attendername=j.attender,m.userimg=j.attender_imgkey);var n=[];n.push(m),$Support.Util.populateChatUI(n,b,a),avimpl.checkCallIcon();return}if(d&&d.length&&e){$Support.Util.populateChatUI(d,b,a),Message.presender=c,$Support.Util.setMessageClass();return}var o=$Support.getAjaxURL("getvisitortranscript",dext);o+="?tzoffset="+_TZCOFFSET+"&visitorid="+b+lsnocachefix(!0)+"&lang="+_LANG+"&conversation=true",_CCODE&&(o+="&ccode="+_CCODE),$.get(o,"",function(c){if(!$.trim(c))return;if(c.indexOf("transcript.try.after.sometime")!=-1)return;$.isEmptyObject(c[c.length-1])&&c.splice(c.length-1,1);if(!c.length)return;$Support.storeConversationChatTranscriptInSession(a,c),$Support.Util.populateChatUI(c,b,a)},"json")},storeConversationChatTranscriptInSession:function(a,b){this.LSDB.storeInSession(a+"_transcript",b)},isConversationUIFocussed:function(){try{return $Support.convlistcontainer.is(":visible")||$Support.convtranscontainer.is(":visible")}catch(a){}return!1},isConversationTransUIFocussed:function(){try{return $Support.convtranscontainer.is(":visible")}catch(a){}return!1},handleOnGoingchatActionsInConversation:function(a,b){if($Support.isFAQEnabled()){$FAQ.updateMessageCount(a);if((a==="newchat"||a==="triggerchat")&&$Support.isFAQUIFocussed())return}if(!$Support.isConversationAllowed()||CallImpl.isCallWithChat)return;var c={newchat:function(){$Support.handleNewChatInConversation()},pickupchat:function(){$Support.handlePickupChatInConversation()},wtime:function(){$Support.handleWaitingTimeUpdateInConversation(b)},newmsg:function(){$Support.handleNewMessageInConversation(b)},triggerchat:function(){$Support.handleTriggerChatInConversation(b)},typingstatus:function(){$Support.handleAgentTypingStatusInConversation(b)},missedchat:function(){$Support.handleMissedChatInConversation(b)},missedleave:function(){$Support.handleMissedLeaveInConversation(b)},endtimerupdate:function(){$Support.handleChatEndTimerUpdateInConversation(b)},endtimerclear:function(){$Support.handleChatEndTimerClearInConversation()},endchat:function(){$Support.handleChatEndInConversation(b)},leavemsg:function(){$Support.handleOfflineChatInConversation(b)}};c[a]()},handleNewChatInConversation:function(){var a=$Support.EmbedObj,b=LSResource.getRealValue("conversation.pleasewait.toconnect"),c=!1;if(a.chatID!=-1){var d=$Support.getRecentMessageOfOngoingChat();b=d.recentmsg,c=d.isattachment}if($Support.convongoingchatobj){if($Support.convongoingchatobj.attr("id")=="conv"+a.chatID){$Support.convongoingchatobj.trigger("click");return}$Support.istriggeredchat?($Support.convongoingchatobj.attr("id","conv"+a.chatID),$Support.convongoingchatobj.attr("visitorid",a.visitorID),$Support.convongoingchatobj.attr("chid",a.chatID)):($Support.proactive&&(b=a.pmsg),$Support.convongoingchatobj.find(".siqc_eletype").show().html(h)[0].className="siqc_eletype",$Support.convongoingchatobj.attr("documentclick","fetchconvtranscript"),$Support.applyOngoingChatClass("siqc_cntbody"),$Support.convongoingchatobj=undefined,b=$Support.proactive?b:LSResource.getRealValue("conversation.pleasewait.toconnect"))}$Support.isConversationAllowed()&&!$Support.isConversationUIFocussed()&&$Support.getConversationData()&&!$Support.container.find("#showsiqconv").is("visible")&&$Support.container.find("#showsiqconv").show(),!b&&$Support.proactive&&(b=a.pmsg,$Support.container.find("#showsiqchatui").hide()),b=c?b:getEscapedText(b);var e=Message.getDisplayContent(b);e=Markdown.apply(e),e=Message.format(e);var f="";JSON.parse(a.eprops.icphoto)&&a.attenderimagefkey&&(f=$Support.Util.getPhotoURL()),(!$Support.convongoingchatobj||$Support.convongoingchatobj&&!$Support.istriggeredchat)&&$Support.convlistcontainer.find("#currchatconv").html($Support.convongoingchatobj=$($Temp.getchatWaitingUIinConversation())),$Support.convongoingchatobj.find("#convchatattendername").text(a.attendername?a.attendername:LSResource.getRealValue("conversation.awaitingtoconnect")),$Support.convongoingchatobj.find("#convchatattenderimg").attr("src",f),$Support.isBotChat&&$Support.convongoingchatobj.find("#convchatattenderimg").addClass("conv_boticn"),a.attender||$Support.convongoingchatobj.find(".sqico-user").addClass("convrstn-wait"),$Support.convongoingchatobj.find("#convmsg").html(e);var g=$Support.intime||a.chatintime;$Support.convongoingchatobj.find("#convwtime").attr("convmtime",g).html(MyDate.timeDifference(g));var h=$Support.getUnreadCount(),i="siqc_cntbody";h?(i+=" siqc_newchat",$Support.convongoingchatobj.find(".siqc_eletype").show().html(h)[0].className="siqc_eletype"):$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(i),$Support.isConversationUIFocussed()&&$Support.proactive&&($Support.isConversationTransUIFocussed()||$Support.convlistcontainer.scrollTop()>$Support.convongoingchatobj.height())&&($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUpMessageInconversation(a.attendername,b,f)))},handleTriggerChatInConversation:function(a){if($Support.convongoingchatobj)return;var b=$Support.EmbedObj;$Support.convlistcontainer.find("#currchatconv").html($Support.convongoingchatobj=$($Temp.getchatWaitingUIinConversation())),$Support.convongoingchatobj.find("#convchatattendername").text(a.sendername);var c="";a.message=getEscapedText(a.message),a.attenderdetails?JSON.parse(b.eprops.icphoto)&&(c=$Support.Util.getPhotoURL()):$Support.convongoingchatobj.find(".sqico-user").addClass("convrstn-wait"),$Support.convongoingchatobj.find("#convchatattenderimg").attr("src",c),$Support.convongoingchatobj.find("#convmsg").html(a.message);var d=a.time||(new Date).getTime();$Support.convongoingchatobj.find("#convwtime").attr("convmtime",d).html(MyDate.timeDifference(d)),$Support.container.find("#showsiqchatui").hide();var e=$Support.getUnreadCount(),f="siqc_cntbody";e?(f+=" siqc_newchat",$Support.convongoingchatobj.find(".siqc_eletype").show().html(e)[0].className="siqc_eletype"):$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(f),$Support.isConversationUIFocussed()&&($Support.isConversationTransUIFocussed()||$Support.convlistcontainer.scrollTop()>$Support.convongoingchatobj.height())&&($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUpMessageInconversation(a.sendername,a.message,c)))},handleWaitingTimeUpdateInConversation:function(a){if($Support.EmbedObj.chatID==-1||!$Support.convongoingchatobj)return;var b=a.wtime;$Support.applyOngoingChatClass("siqc_cntbody siqc_time"),$Support.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype sqico-timer",$Support.convongoingchatobj.find("#convwtime").html(b)},handleMissedChatInConversation:function(a){if(!$Support.convongoingchatobj)return;$Support.applyOngoingChatClass("siqc_cntbody siqc_chatend");var b=LSResource.getRealValue("conversation.missedmsg"),c=$Support.EmbedObj;$Support.convongoingchatobj.find("#convchatattendername").text(c.attendername?c.attendername:"Missed Chat"),$Support.convongoingchatobj.find("#convmsg").html(b);var d=$Support.intime||$Support.EmbedObj.chatintime;$Support.convongoingchatobj.find("#convwtime").attr("convmtime",d).html(MyDate.timeDifference(d)),$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype",$Support.convongoingchatobj.find(".sqico-user").removeClass("convrstn-wait"),$Support.convongoingchatobj.find(".siqc_usrimg").addClass("sqico-missed"),$Support.isConversationTransUIFocussed()&&($Support.removeConversationPopupMessage(),$Support.container.append($Temp.getPopUPInfoMessageInConversation(DynamicMsg.fillValues(getUnescapedText($Support.EmbedObj.missedmessage)))))},handleMissedLeaveInConversation:function(a){if(!$Support.convongoingchatobj)return;$Support.convongoingchatobj[0].className="siqc_cntbody",$Support.convongoingchatobj.find("#convmsg").html(getEscapedText(a.msg))},handlePickupChatInConversation:function(a){if(!$Support.convongoingchatobj)return;var b=$Support.EmbedObj,c="";JSON.parse(b.eprops.icphoto)&&b.attenderimagefkey&&(c=$Support.Util.getPhotoURL()),$Support.applyOngoingChatClass("siqc_cntbody"),a||$Support.convongoingchatobj.find("#convmsg").html(getEscapedText(b.question)),$Support.convongoingchatobj.find("#convchatattendername").text(b.attendername?b.attendername:"Awaiting agent"),$Support.convongoingchatobj.find("#convchatattenderimg").attr("src",c).removeClass("conv_boticn");var d=$Support.intime||b.chatintime;$Support.convongoingchatobj.find("#convwtime").attr("convmtime",d).html(MyDate.timeDifference(d)),$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.convongoingchatobj.find(".sqico-user").removeClass("convrstn-wait")},handleNewMessageInConversation:function(a){if(!$Support.convongoingchatobj)return;var b=$Support.EmbedObj,c=a.filename,d=a.content;c||(c=a.msg,typeof a.msg=="object"&&(c=a.msg.fName,d=a.msg.content));var e=c;c=a.iscannedarticle?a.cardheader:c;var f=Message.getDisplayContent(c);f=Markdown.apply(f),f=Message.format(f);var g=$Support.Util.getFileClassType(d);f=g?'<em class="'+g+'">'+f+"</em>":f;var h="siqc_cntbody";$Support.convongoingchatobj.find("#convmsg").html(f);var i=$Support.getUnreadCount();if(i){h+=" siqc_newchat",$Support.convongoingchatobj.add("#conv-tab").find(".siqc_eletype").show().html(i)[0].className="siqc_eletype",$("#conv-tab").addClass("count");if($Support.isConversationUIFocussed()&&!Message.isLocalUser(a.sender)){if($Support.isConversationTransUIFocussed()||$Support.convlistcontainer.scrollTop()>$Support.convongoingchatobj.height()){$Support.removeConversationPopupMessage();var j="";a.sender.indexOf($Support.EmbedObj.attender)!=-1&&JSON.parse(b.eprops.icphoto)&&(j=$Support.Util.getPhotoURL()),$Support.container.append($Temp.getPopUpMessageInconversation(a.dname,f,j))}if($Support.isConversationTransUIFocussed()){var k=$Support.container.find("#showsiqconv"),l=k.find("#siqnoticon");l.length==0&&k.prepend("<em id='siqnoticon' class='siqc_prochtcls' documentclick='showchatui'></em>")}}}else $Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2";$Support.applyOngoingChatClass(h)},removeConversationPopupMessage:function(){$Support.container.find("#convpopupmsg").remove(),$Support.container.find("#convpopupmsg").remove();var a=""},handleAgentTypingStatusInConversation:function(a){if(!$Support.convongoingchatobj)return;var b=$Support.EmbedObj,c=a.msg,d=$Support.getUnreadCount(),e="siqc_cntbody";if(c)e+=" siqc_type",$Support.convongoingchatobj.find("#convmsg").html(LSResource.getRealValue("conversation.agent.typing")),$Support.convongoingchatobj.find(".siqc_usrimg").addClass("sqico-typing");else{var f=$Support.getRecentMessageOfOngoingChat().recentmsg,g=Message.getDisplayContent(f);g=Markdown.apply(g),g=Message.format(g),$Support.convongoingchatobj.find("#convmsg").html(g),$Support.convongoingchatobj.find(".siqc_usrimg").removeClass("sqico-typing")}d?(e+=" siqc_newchat",$Support.convongoingchatobj.find(".siqc_eletype").show().html(d)[0].className="siqc_eletype"):$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2",$Support.applyOngoingChatClass(e)},handleChatEndTimerUpdateInConversation:function(a){if(!$Support.convongoingchatobj)return;var b=a.isstart,c=LSResource.getRealValue("conversation.endtimer.secs",""+a.timer);$Support.applyOngoingChatClass("siqc_cntbody siqc_goend"),$Support.convongoingchatobj.find("#convwtime").html(c).show();var d=LSResource.getRealValue("conversation.chat.goingtoend");$Support.convongoingchatobj.find("#convmsg").html(d),$Support.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype sqico-alert";if($Support.isConversationUIFocussed())if($Support.isConversationTransUIFocussed()||$Support.convlistcontainer.scrollTop()>$Support.convongoingchatobj.height()){var e=$Support.Util.getPhotoURL();if(b)$Support.container.append($Temp.getPopUpAlertInconversation($Support.EmbedObj.attendername,LSResource.getRealValue("conversation.chatsess.goingtoend"),c,e));else{var f=$Support.container.find("#convpopupmsg");f.length!=0&&f.find("#alerttimer").html(c)}if($Support.isConversationTransUIFocussed()){var g=$Support.container.find("#showsiqconv");g.find("#siqnoticon").remove(),g.prepend("<em id='siqnoticon' class='sqico-alert' documentclick='showchatui'></em>")}}},handleChatEndTimerClearInConversation:function(){if(!$Support.convongoingchatobj)return;var a=$Support.EmbedObj,b=$Support.getRecentMessageOfOngoingChat().recentmsg,c=Message.getDisplayContent(b);c=Markdown.apply(c),c=Message.format(c);var d="siqc_cntbody";$Support.convongoingchatobj.find("#convwtime").html(MyDate.timeDifference($Support.intime||a.chatintime)),$Support.convongoingchatobj.find("#convmsg").html(c);var e=$Support.getUnreadCount();e?(d+=" siqc_newchat",$Support.convongoingchatobj.find(".siqc_eletype").show().html(e)[0].className="siqc_eletype"):$Support.convongoingchatobj.find(".siqc_eletype")[0].className="siqc_eletype sqico-chat2";var f=$Support.container.find("#showsiqconv");f.find("#siqnoticon").remove(),$Support.applyOngoingChatClass(d),$Support.removeConversationPopupMessage()},handleChatEndInConversation:function(a){if(!$Support.convongoingchatobj)return;var b=$Support.EmbedObj,c=$Support.Util.isAnnonUser(a.sender)?"siqc_cntbody":"siqc_cntbody siqc_chatend";$Support.applyOngoingChatClass(c);var d=LSResource.getRealValue("converation.chat.ended");$Support.convongoingchatobj.find("#convmsg").html(d);var e=$Support.intime||b.chatintime;$Support.convongoingchatobj.find("#convwtime").attr("convmtime",e).html(MyDate.timeDifference(e)),$Support.convongoingchatobj.find(".siqc_eletype").html("").show()[0].className="siqc_eletype",$Support.removeConversationPopupMessage();if($Support.isConversationTransUIFocussed()){var f=a.msg&&a.msg.opruser&&a.msg.opruser.dname?LSResource.getRealValue("converation.agent.chat.ended","<b>"+a.msg.opruser.dname+"</b>"):LSResource.getRealValue("converation.chat.ended");$Support.container.append($Temp.getPopUPInfoMessageInConversation(f))}},handleOfflineChatInConversation:function(a){if(!$Support.isConversationAllowed())return;var b=[];b.push(a);var c=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");$Support.updateConversationCache(b,c,!0);var d=$Temp.getConversationHistoryHTML(a);$Support.convlistcontainer.find("#pastchatconv").prepend(d),$Support.isConversationAllowed()&&!$Support.isConversationUIFocussed()&&!$Support.container.find("#showsiqconv").is("visible")&&$Support.container.find("#showsiqconv").show()},handleChatTransferInConversationListView:function(){if(!$Support.convongoingchatobj)return;var a=$Support.EmbedObj,b="";JSON.parse(a.eprops.icphoto)&&a.attenderimagefkey&&(b=$Support.Util.getPhotoURL()),$Support.convongoingchatobj.find("#convchatattenderimg").attr("src",b),$Support.convongoingchatobj.find("#convchatattendername").text(a.attendername)},getRecentMessageOfOngoingChat:function(){var a=$Support.EmbedObj,b=a.question,c=!1;if($Support.cachearr.length){var d=$Support.cachearr[$Support.cachearr.length-1];if(d.msg)if(typeof d.msg!="object")b=d.iscannedarticle?d.cardheader:d.msg;else if(typeof d.msg=="object")if(d.msg.fName){b=d.msg.fName;var e=$Support.Util.getFileClassType(d.msg.content);b=e?'<em class="'+e+'">'+b+"</em>":b,c=!0}else d.msg.mode==="cannedarticle"&&(b=$FAQ.getHeaderMessage(d.msg.msg))}return{recentmsg:b,isattachment:c}},applyOngoingChatClass:function(a){if(!$Support.convongoingchatobj)return;$Support.convongoingchatobj[0].className=a},cacheCurrentChat:function(){if(!$Support.isConversationAllowed())return;var a=$Support.EmbedObj,b=[],c={};c.attender=a.attendername,c.attender_imgkey=a.attenderimagefkey,c.question=a.question,c.chid=a.chatID,c.visitorid=a.visitorID,c.endtime=(new Date).getTime(),c.isbotattender=$Support.isBotChat;var d=$Support.cachearr[$Support.cachearr.length-1];d&&(d.iscannedarticle&&(d.msg=d.cardheader),c.lastmsg=JSON.stringify(d)),b.push(c);var e=this.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");$Support.updateConversationCache(b,e,!0)},handleNewsLetter:function(){$Support.Util.isPreview()&&$CWPreview.handleNewsLetter()},getEmbedSize:function(){return $Support.getParent().$ZSIQWidget.getEmbedSize()},getEmbedSizeClass:function(){return $Support.isMobileWidth()?"":" zsiq_size"+$Support.getEmbedSize()},removeWidget:function(){var a=$Support.getParent().$ZSIQChatWindow.getChatWindowDiv(),b=$Support.getParent().$ZSIQWidgetUI.getWidgetDiv();a&&a.remove(),b&&b.remove()},handleBotTransferAccept:function(){$Support.removeCookie("ZLD"+$Support.EmbedObj.livelsid+"WAITING"),$UI.removeCWaitHandler(),clearTimeout($Support.waitTimer),$UI.removeTransferDiv(),delete $Support.waitingtime,delete $Support.isBotChat,delete $Support.botchatprops,$Support.handlePickupChatInConversation(!0);var a=$TH.getHeader();JSON.parse($Support.EmbedObj.eprops.icphoto)?a.find(".cmplogo").attr("data-chttype","agent"):a.find(".cmplogo").removeAttr("data-chttype"),$UI.populateUserAction()},isChatExist:function(){return $Support.EmbedObj.chatID!=-1},isOnlineChat:function(){return $Support.EmbedObj.status},isMacOS:function(){return navigator.platform.match(/Mac/i)?!0:!1},openClassicUI:function(){var a=$Support.convlistcontainer.find("#pastchatconv").find(".siqc_cntbody").length;a>0&&$Support.container.find("#showsiqchatui").click()},isFAQEnabled:function(){var a=$Support.EmbedObj.faqaccess;return Licence.verify("faqallowed")?a.length?$Support.EmbedObj.faqaccess[0]==1:!1:!1},getConversationData:function(){var a=$Support.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid");return $Support.LSDB.getFromSession(a+"_conversation")},isFAQUIFocussed:function(){try{return $Support.container.attr("cwview")==="faqview"}catch(a){}return!1},handleBotBroadcast:function(a){var b=a.msg;this.LSDB.set("ZSIQ"+$Support.EmbedObj.chatID+"BROATCAST",b.text),this.waitingtime=this.EmbedObj.embedwaitingtime,this.handleWaitingDisplay(),$UI.populateVisitorQuestion()},handleBotMessage:function(a){var b=a.msg;b.reply&&(b.msg=b.reply,Message.display($Temp.getMsgHTML(b),!0)),b.followup&&(b.msg=b.followup,Message.display($Temp.getMsgHTML(b),!0)),b.question&&(b.msg=b.question,Message.display($Temp.getMsgHTML(b),!0));var c=b.options;c&&(b.options=c.list,Message.display($Support.Util.getConversationSelect(b),!0))},handleMessageOptions:function(a){var b=a.msg;if(!b.options)return;var c=$Support.Util.getConversationSelect({options:b.options.list});Message.display(c,!0)},handleContextQuestion:function(a){var b=a.msg.data,c={msg:b.question};Message.display($Temp.getMsgHTML(c),!0);var d=b.options;if(d){var e={options:d.list},f=$Support.Util.getConversationSelect(e);Message.display(f,!0)}},getBroadcastText:function(){return this.LSDB.get("ZSIQ"+$Support.EmbedObj.chatID+"BROATCAST")},removeBroadCast:function(){return this.LSDB.remove("ZSIQ"+$Support.EmbedObj.chatID+"BROATCAST")}}})();(function(){$UI={init:function(a){this.populateUI(a)},populateUI:function(a){this.setHeader(),this.setBody(null,a),this.setFooter()},setContainer:function(){$TH=$ThemeHandler[$Support.theme],$TH.updateContainer(),$Support.Util.updateParentFontFamily()},setHeader:function(){$TH.updateHeader()},setInnerHeader:function(a){$TH.updateInnerHeader(a)},setBody:function(a,b){$TH.updateBody(a,b),(b||!a&&$Support.EmbedObj.department==-1)&&this.populateDropDown()},setInnerBody:function(a){$TH.updateInnerBody()},setFooter:function(){$TH.updateFooter()},populateDropDown:function(){$TH.updateDeptDropdown()},showBanner:function(a,b,c,d,e,f){$TH.showBanner(a,b,c,d,e,f)},hideBanner:function(a){$TH.hideBanner(a)},showTimerBanner:function(a){$TH.showTimerBanner()},populateSendMail:function(a){if($Support.Util.isPreview())return;$TH.populateSendMail(a)},populateSendMailConfirm:function(a,b){$TH.populateSendMailConfirm(a,b)},populateSmiley:function(a){$TH.populateSmiley(a)},showUserEditUI:function(a,b){$TH.showUserEditUI(a,b)},hideUserEditUI:function(){$TH.hideUserEditUI()},showCaptcha:function(a){$TH.showCaptcha(a)},hideCaptcha:function(){$TH.hideCaptcha()},showWaitingUI:function(a){$TH.showWaitingUI(a)},updateWaitingTime:function(){var a=this.wait_div,b=MyDate.formatMS($Support.waitingtime*1e3);a&&a.html(b);var c={};c.wtime=b,$Support.handleOnGoingchatActionsInConversation("wtime",c)},showMissedVisitorBanner:function(a){$TH.handleMissedStatus(a)},populateVisitorQuestion:function(a){$TH.populateVisitorQuestion(a)},getMsgHTML:function(a){return $TH.getMsgHTML(a)},getInfoMsgHTML:function(a,b){return $TH.getInfoMsgHTML(a,b)},populateUserAction:function(){$TH.populateUserAction()},setChatStatus:function(a){a=$.trim(a),JSON.parse($Support.EmbedObj.pprops.showtyping)&&$("#typgstatus").html(a)},updateOfflineUI:function(a,b){$TH.handleOfflineStatus(a,b)},updateOnlineUI:function(a,b){$Support.Util.handleOnlineStatus(a,b)},showFeedback:function(){$TH.populateFeedbackHTML()},showFdbkResponse:function(){$TH.showFdbkResponse()},hideUtilityDiv:function(a,b,c){$TH.hideUtilityDiv(a,b,c)},getInfoMsgContent:function(a,b,c){return $TH.getInfoMsgContent(a,b,c)},notifyUrlShare:function(a){$TH.notifyShareURL(a)},showDragDropUI:function(){$TH.showDragDropUI()},hideDragDrop:function(){$TH.hideDragDrop()},getPreviewHTML:function(){return $TH.getPreviewHTML()},getCustomHTML:function(a){return $TH.getCustomHTML(a)},showUploadProgress:function(a){return $TH.showUploadProgress(a)},hideUploadProgress:function(a){return $TH.hideUploadProgress(a)},updateCloseIcon:function(){$TH.updateCloseIcon()},updateParentFontFamily:function(){return $TH.updateParentFontFamily()},populateSmileyIcon:function(){$TH.populateSmileyIcon()},removeSmileyIcon:function(){$TH.removeSmileyIcon()},updateQuesArea:function(){$TH.updateQuesArea()},updateChatEndMsg:function(){$TH.updateChatEndMsg()},updateVisitorName:function(a){$TH.updateVisitorName(a)},getBusinessHrInfo:function(){return $TH.getBusinessHrInfo()},getSoundHTML:function(a){return $TH.getSoundHTML(a)},setSoundConfig:function(){$TH.setSoundConfig()},addGroupIcon:function(){return},removeGroupIcon:function(){return},populateCWaitHandler:function(){$TH.populateCWaitHandler()},removeCWaitHandler:function(){$TH.removeCWaitHandler()},showWaitingDialog:function(){$TH.showWaitingDialog()},hideMaskDiv:function(){$TH.hideMaskDiv()},displayInfo:function(a){$TH.displayInfo(a)},setDepartment:function(a){var b=$("#dropcontent").find("[val='"+a+"']");b.trigger("click")},showCloseAlert:function(){if($Support.EmbedObj.chatID==-1)return;var a=confirm(LSResource.getRealValue("ne.reload.alert"));a==1&&retrun},focusComposer:function(){if(window.outerWidth<555)return;$("#msgarea").focus()},appendTransferDiv:function(){if($(".zsiq_transferdiv").length>0)return;var a=$Support.chatdiv||$("#msgdiv"),b=parseInt(a.find(".siq-agntmsg").length)<1?'style="display:none"':"",c="";$Support.areUsersAvailable()?c='<div class="zsiq_transferdiv fnt13" '+b+' id="agenttransfer">'+LSResource.getRealValue("ne.agent.transfer")+'<span documentclick="transferchat" class="bot_opt">'+LSResource.getRealValue("common.yes")+"</span>"+'<span documentclick="hidetransferoption" class="bot_opt">'+LSResource.getRealValue("common.no")+"</span>"+"</div>":c='<div class="zsiq_transferdiv fnt13" ><span documentclick="transfermissed" purpose="offline" class="bot_opt">'+LSResource.getRealValue("ne.chatwindow.dropmessage")+"</span>"+"</div>",a.append(c)},appendConsentDiv:function(a){var b=a?"$Support.getMissedUserConsent":"$Support.getUserConsent",c=$Support.chatdiv||$("#msgdiv"),d="";d='<div class="zsiq_transferdiv fnt13" id="creditcardconsent">'+LSResource.getRealValue("ne.agent.cardmask")+'<span onclick="'+b+'(1)" class="bot_opt">'+LSResource.getRealValue("common.yes")+"</span>"+'<span onclick="'+b+'(0)" class="bot_opt">'+LSResource.getRealValue("common.no")+"</span>"+"</div>",$(" #creditcardconsent ").length==0&&c.append(d)},appendChatConsentDiv:function(a,b,c){var d=$Support.chatdiv||$("msgdiv"),e=LSResource.getRealValue("common.gdpr.agent.chatconsent2");c&&(c=c.indexOf("http")==-1?"http://"+c:c,e="<a class='siq-lnmor' target='_blank' href='"+c+"'>"+e+"</a>");var f=LSResource.getRealValue("common.gdpr.agent.chatconsent1")+" "+e+" "+LSResource.getRealValue("common.gdpr.agent.chatconsent3"),g=LSResource.getRealValue("common.gdpr.agent.accept"),h=LSResource.getRealValue("common.gdpr.agent.decline"),i=$Support.getParent().$ZSIQUtil.getAPIValues();if(i.textbannerobj&&i.textbannerobj.online){var j=i.textbannerobj.online;f=j.description&&j.description.trim().length!=0?j.description:f,g=j.acceptbutton&&j.acceptbutton.trim().length!=0?j.acceptbutton:g,h=j.declinebutton&&j.declinebutton.trim().length!=0?j.declinebutton:h;if(j.policytextandlink){var k=j.policytextandlink,l=k.text&&k.text.trim().length!=0?k.text:"",m=k.link&&k.link.trim().length!=0&&$Support.getParent().$ZSIQUtil.isValidURL(k.link)?k.link:"";f=$Support.getParent().$ZSIQUtil.hyperLinksSubString(f,l,m)}}chatconsenthtml='<div class="zsiq_transferdiv fnt13 chatconsent" id="chatconsentdiv">'+f+'<div class="mT10">'+'<span onclick="$Support.getChatUserConsent(1, '+a+", "+b+')" class="bot_opt gltr-srno">'+g+"</span>"+'<span onclick="$Support.getChatUserConsent(0, '+null+", "+b+')" class="bot_opt gltr-srno gltr-no">'+h+"</span>"+"</div>"+"</div>",$(" #chatconsentdiv ").length==0&&d.append(chatconsenthtml)},removeTransferDiv:function(){var a=$(".zsiq_transferdiv");a.fadeOut("slow",function(){a.remove()})},removeConsentDiv:function(){var a=$("#creditcardconsent");a.fadeOut("slow",function(){a.remove()})},removeChatConsentDiv:function(){var a=$("#chatconsentdiv");a.fadeOut("slow",function(){a.remove()})},removeOfflineConsentDiv:function(){var a=$("#offlineconsent");a.fadeOut("slow",function(){a.remove(),$Support.Util.setTextareaHeight()})},showTransferWaiting:function(){$(".zsiq_transferdiv").remove();var a=$Support.waitingtime||$Support.EmbedObj.embedwaitingtime,b='<div class="zsiq_transferdiv fnt13" id="transferwaiting" botstatus="timer">'+LSResource.getRealValue("ne.agent.transferwaiting")+'<span id="wait_div">'+MyDate.formatMS(a*1e3)+"</span>"+"</div>",c=$Support.chatdiv||$("#msgdiv");c.append(b),$UI.wait_div=$("#wait_div"),$Support.botchatprops.status="waiting",$Support.setCookie()},showTransferMissed:function(){$(".zsiq_transferdiv").remove();var a='<div class="zsiq_transferdiv zsiq_transmissed fnt13" id="transfermissed">'+LSResource.getRealValue("ne.agent.transfermissed")+'<div><span documentclick="removetransfer" class="bot_opt"> '+LSResource.getRealValue("ne.chatwindow.continuewithbot")+"</span>"+'<span documentclick="transfermissed" class="bot_opt">'+LSResource.getRealValue("settings.embed.offline")+"</span></div>"+"</div>",b=$Support.chatdiv||$("#msgdiv");b.append(a);var c=document.getElementById("msgmaindiv");c.scrollHeight-c.scrollTop==c.clientHeight||c.scrollHeight<c.clientHeight||Message.scroll(c)},getBotImageHTML:function(a){var b='<em id="boticondiv" class="sqico-boticn"'+(a?"style=display:none":"")+">"+'<em class="sqico-botwel1"></em>'+'<em class="sqico-botwel2"></em>'+'<em class="sqico-botwel3"></em>'+"</em>";return b},getTranslateBannerHTML:function(a){return $TH.getTranslateBannerHTML(a)}}})();var $NE=!1;$EmbedManger={isNewEmbed:$NE=typeof $Support!="undefined",setChatID:function(a){return $NE?$Support.EmbedObj.chatID=a:Support.setChatID(a)},getChatID:function(){return $NE?$Support.EmbedObj.chatID:Support.getChatID()},setPrevCHID:function(a){return $NE?$Support.EmbedObj.lchid=a:Support.setPrevCHID(a)},getPrevCHID:function(){return $NE?$Support.EmbedObj.lchid:Support.getPrevCHID()},getWaitingCookie:function(){return $NE?$Support.getWaitingCookie():SupportUI.getCookieValue("ZLD"+Support.getLiveSupportID()+"WAITING")},getVisitorID:function(){return $NE?$Support.EmbedObj.visitorID:Support.getVisitorID()},getLiveSupportID:function(){return $NE?$Support.EmbedObj.livelsid:Support.getLiveSupportID()},getAttenderID:function(){return $NE?$Support.EmbedObj.attender:Support.getAttender()},showChatUI:function(a,b){if($NE&&a){var c=$Support.LSDB.getFromSession($Support.EmbedObj.chatID+"_transcript");$.isEmptyObject(a[a.length-1])&&a.splice(a.length-1,1);if(b){$Support.Util.showChatUI(a);return}if($Support.LSDB.isSessionStorageAvail()&&c&&c.length==a.length){var d=c.length;if(c[d-1].msg==a[d-1].msg)return}$Support.Util.showChatUI(a)}else Support.showChatUI()},isautotrigger:function(){return $NE?$Support.istrigmsg:Support.isautotrigger},getAddinfo:function(){return $NE?$Support.EmbedObj.addinfo:Support.addinfo},getDeptlist:function(){return $NE?$Support.EmbedObj.deptlist:Support.deptlist},updateChatCookie:function(){$NE?$Support.updateChatCookie():Support.updateChatCookie()},handleChatEnded:function(a){if($NE){$Support.handleChatEnded(a);return}return Support.handleChatEnded(a)},setVisitorName:function(a){$NE?$Support.EmbedObj.setVisitorName(a):Support.setVisitorName(a)},getVisitorName:function(){return $NE?$Support.EmbedObj.visitorname:Support.getVisitorName()},setVisitorEmail:function(a){$NE?$Support.EmbedObj.setVisitorEmail(a):Support.setVisitorEmail(a)},setVisitorPhone:function(a){$NE?$Support.EmbedObj.setVisitorPhone(a):Support.setVisitorPhone(a)},handleCallbacks:function(a,b){if($NE){$Support.Util.handleCallbacks(a,b);return}return Support.handleCallbacks(a,b)},handlePickUp:function(a){$NE?$Support.handlePickUp(a):Support.handlePickUp(a)},handleDesktopSharing:function(a){return $NE?$Support.handleDesktopSharing(a):Support.handleDesktopSharing(a)},handleEndSession:function(a){if($NE){EmbedSound.play("endtimer",a.timer),$Support.handleEndSession(a.timer,!0);return}return Support.handleEndSession(a)},handleJoinProActive:function(a){if($NE){$Support.handleJoinProActive(a);return}Support.handleJoinProActive(a)},reJoin:function(){$NE?$Support.reJoin():Support.reJoin()},addVisitor:function(){$NE?$Support.addVisitor():Support.addVisitor()},quit:function(){if($NE)return $Support.quitChat();Support.quit()},setCookie:function(){$NE?$Support.setCookie():Support.setCookie()},removeChatCookie:function(){$NE?$Support.removeChatCookie():Support.removeChatCookie()},getType:function(){return $NE?$Support.type:Support.type},getuvid:function(){return $NE?$Support.EmbedObj.uvid:Support.uvid},getvwmsid:function(){return $NE?$Support.EmbedObj.vwmsid:Support.vwmsid},getWaitTimer:function(){return $NE?$Support.waitTimer:Support.waitTimer},setCallbackargs:function(a){if($NE){$Support.callbackargs=a;return}Support.callbackargs=a},setQuitStatus:function(a){if($NE){$Support.callquitstatus=a;return}Support.callquitstatus=a},getQuitStatus:function(){return $NE?$Support.callquitstatus:Support.callquitstatus},setIPBlockStatus:function(a){if($NE){$Support.isipblocked=a;return}Support.isipblocked=a},getVisitID:function(){return $NE?$Support.EmbedObj.VISITID:Support.visitorinfo.VISITID},isComposerFocused:function(){return $NE?$Support.iscomposerfocus:Support.iscomposerfocus},iswindowfocused:function(){return $NE?$Support.iswindowfocused:Support.iswindowfocused},isSoundOff:function(){return $NE?$Support.EmbedObj.soundval=="-1":!SupportUI.sound},updateChatCache:function(a,b){return $NE?$Support.updateChatCache(a,b):""},getChatStatus:function(){return $NE?$Support.ischatdisabled:SupportUI.ischatdisabled},getMessageLength:function(){return $NE?$.trim(" "+$("#msgarea").val()).length:$.trim(" "+$("#lstxteditor").val()).length},handleApiData:function(){return $NE?$Support.handleApiData():SupportUI.handleApiData()},isCrossDomainReq:function(){return!0}},$EmbedManger.UI={isNewEmbed:$EmbedManger.isNewEmbed,displayInfo:function(a,b){if($NE){$UI.showBanner(a);return}SupportUI.displayInfo(a,b)},hideInfo:function(){if($NE){$UI.hideBanner();return}SupportUI.hideInfo()},showProcess:function(a){if($NE)return;SupportUI.showProcess(a)},showAgentStatus:function(){if($NE)return;SupportUI.showAgentStatus()},resizequestion:function(){if($NE)return;return SupportUI.resizequestion},postMessage:function(a,b){if($NE){$Support.postMessage(a,b);return}SupportUI.postMessage(a,b)},embeddiv:function(){return $NE?$Support.container:SupportUI.embeddiv},showVisitorInfo:function(){if($NE)return;SupportUI.showVisitorInfo()},resizeWindow:function(){if($NE)return;SupportUI.resizeWindow()},getCaptchaValue:function(){return $NE?$Support.Util.getCaptchaValue():SupportUI.getCaptchaValue()},showCaptcha:function(a){if($NE){$UI.showCaptcha(a);return}SupportUI.showCaptcha(a)},hideCaptcha:function(){if($NE){$UI.hideCaptcha();return}SupportUI.hideCaptcha()},showFeedback:function(a,b){if($NE){$UI.showFeedback(a,b);return}SupportUI.showFeedback(a,b)},handleEndSupport:function(a){if($NE)return;SupportUI.handleEndSupport(a)},hideVisitorInfo:function(){if($NE)return;SupportUI.hideVisitorInfo()},clearProgress:function(){if($NE)return;SupportUI.clearProgress()},handlePushMessage:function(a){if($NE){$Support.Util.handlePushMessage(a);return}SupportUI.handlePushMessage(a.msg)},getDragDropHtml:function(){if($NE)return;return SupportUI.getDragDropHtml()},setChatStatus:function(a){if($NE){$UI.setChatStatus(a);return}SupportUI.setChatStatus(a)},formatAndDisplayInfo:function(a,b,c){if($NE){var d=$UI.getInfoMsgContent(b);Message.display(d,!0);return}Message.formatAndDisplayInfo(a,b,c)},getPrevHTML:function(){return $NE?$UI.getPreviewHTML():PasteImage.getEmbPrevHTML()},showPasteUI:function(){if($NE)return $Support.Util.showPasteUI();PasteImage.showEmbedUI()},hidePasteUI:function(){if($NE)return $Support.Util.hidePasteUI();PasteImage.hideUI()},updateVisitorName:function(a){$NE&&$UI.updateVisitorName(a)},showGroupIcon:function(){if($NE)return},hideGroupIcon:function(){if($NE)return},getResendIcon:function(){return $NE?'<em id="resendicon" class="sqico-resend" documentclick="resendmsg" title="'+LSResource.getRealValue("embed.msg.resend")+'" ></em>':'<em id="resendicon" class="sqico-resend spritebg" onclick="LSMessanger.resendMessages('+RESEND_MANUAL+')" title="'+LSResource.getRealValue("embed.msg.resend")+'" ></em>'}};$Support.Util={jsdownloadtimer:-1,ispostloaddone:!1,handleTextClear:function(a,b){a.parent().find('input[type="text"]').val("")},minimizeEmbed:function(){$Support.getParent().$ZSIQChatWindow.minimizeChatWindow()},maximizeEmbed:function(){this.postMessage("newEmaximize",{width:"371",height:"460"})},closeEmbed:function(){$Support.getParent().$ZSIQChatWindow.closeChatWindow(),$Support.enableTextarea(),$Support.contentdiv=null;var a=$Support.EmbedObj;$Support.callquitstatus=!1,a.setVisitorID(-1),a.setChatID(-1),a.setVisitID(-1),_JOINED=!1,Message.presender="",$Support.init($Support.getParent().$ZSIQWidget.getEmbedObject()),$Support.getParent().$ZSIQChatWindow.constructIframe(!0)},setThemeInFloat:function(a){this.postMessage("settheme",a)},triggerAdditionalFileDownload:function(){var a=$Support.Util;a.ispostloaddone||(clearTimeout(a.jsdownloadtimer),a.downloadAdditionalFiles())},downloadAdditionalFiles:function(){if($Support.Util.ispostloaddone)return;var a=$Support.getParent().$ZSIQWidget.getEmbedObject(),b=$Support.getParent().$ZSIQChat.getWidgetData().commondata,c="",d=b.schema+"://"+a.embedserverurl,e=document.querySelectorAll("head");e.length==0&&(e=[],e[0]=document.createElement("head"),document.insertBefore(document.body,e[0]));if(a.ucomp){var f=document.createElement("script");f.src=b.jsstaticserver+"/js/embedpostload.js",e[0].appendChild(f);var g=document.createElement("link");g.type="text/css",g.rel="stylesheet",g.href=$Support.getParent().$ZSIQWidget.getWidgetObject().cssstaticserver+"/styles/embedpostload.css",e[0].appendChild(g)}else{var h=["/js/embed/new/chatwindow/jquery.ztooltip.js","/js/cw/lsdragdrop.js","/js/cw/pasteimage.js","/js/cw/validator.js","/js/cw/clickoutside.js"];for(var i=0;i<h.length;i++){var j=document.createElement("script");j.src=d+h[i],e[0].appendChild(j)}var k=["/styles/cw/smiley.css","/styles/cw/ui.ztooltip.css"];for(var i=0;i<k.length;i++){var g=document.createElement("link");g.type="text/css",g.rel="stylesheet",g.href=d+k[i],e[0].appendChild(g)}}$Support.Util.ispostloaddone=!0},showMoreAction:function(a,b){$Clickoutside.bindclick($Support.Util.hideMoreActionDiv,"mraction","moreaction");var c=a.parents(".usractions"),d=c.find(".mraction");d.addClass("shwact"),d.find('li[purpose="sound"]').replaceWith($UI.getSoundHTML()),c.removeClass("showmore")},hideMoreActionDiv:function(){$("ul.mraction").removeClass("shwact").parents(".usractions").addClass("showmore")},getKeyCode:function(a){return a=a==undefined?window.event:a,a.keyCode||a.which},handleBannerSlide:function(a){var b=$Support.contentdiv.find("#info_banr"),c=this;b.removeClass("timer");var d=b.outerHeight();b.html(a);if(b.is(":animated")){b.css("height","auto");return}var e=b.outerHeight();b.css({height:d+"px"}).animate({height:e},"5000",function(){b.height("auto")})},showInfoBanner:function(a,b,c,d,e){var f=this;clearTimeout(f.bnrtimer);var g=$Support.contentdiv.find("#info_banr");$Support.container.hasClass("outerwin")?g.addClass("relate"):g.removeClass("relate"),$Support.EmbedObj.bushrstatus?g.addClass("bsnshrs"):g.removeClass("bsnshrs"),a?f.handleBannerSlide(a):c&&g.hide().slideDown(500,function(){}),b&&(e=e||1500,f.bnrtimer=setTimeout(function(){$UI.hideBanner(d)},e))},sendMail:function(a){if(a&&this.getKeyCode(a)==13)return $Support.sendMail()},validateFields:function(a){if($Support.Util.isPreview())return;var b=!0,c=0,d;return a.find("[data-validate]").each(function(){$(this).validateInput()||(b=!1,d=$(this),c++)}),this.showErrorInfo(c,d),b},showErrorInfo:function(a,b){if(a<1||CallImpl.isCallWithChat)return;var c=LSResource.getRealValue("ne.errorinfo.all");if(a===1){var d=b.attr("info");c=/^number|email|url|percentage|decimal|name|email|phone$/.exec(d)?LSResource.getRealValue("ne.errorinfo."+d):c}$UI.showBanner(c,!0),$("#info_banr").removeClass("relate"),this.setTextareaHeight()},showChatUI:function(a){$Support.contentdiv||($UI.setInnerBody(),$UI.setFooter(),$Support.Util.handleResize());try{this.populateChatUI(a)}catch(b){}},populateChatUI:function(a,b,c){if(!a||CallImpl.isCallWithChat)return;delete $Support.waitTimer,a=CommonUtil.parseToJSON(a);var d=a.length,e=0,f="",g="",h="";for(e;e<d;e++){var i=a[e];if(e==d-1&&!getObjectSize(i))break;var j=i.sender,k={},l=i.dname,m=i.msg,n=i.time||i.intime||"",o=i.mode;i.formattedmsg&&(m=i.formattedmsg),o=o||(typeof m=="object"?m.mode:o),o=="ACCEPT_TRANSFER"&&(m.opruser.dname=a[0].attendername,m.opruser.attendername=a[0].attendername);if(e===0){j=Message.presender=j||$Support.EmbedObj.vwmsid,l=i.visitorname||i.dname,!b&&!$Support.isConversationUIFocussed()&&$UI.setInnerHeader(i),m=i.question||i.ques,b||(!$Support.waitingtime&&$Support.EmbedObj.visitorID!==-1&&!$Support.istriggeredchat&&$UI.populateUserAction(),$UI.populateSmileyIcon());if(isUndefined(m)||m=="")continue}g=$UI.getInfoMsgContent(m,b,c);if(o)if(o=="TRIGGER")l=m.dname,m=m.msg;else if(o==="att")k.file=m;else if(o==="cannedarticle")m=$FAQ.getCustomCard(m.msg),k.iscannedarticle=!0;else if(m.mode&&!g)continue;n=n?n.indexOf(":")!=-1?n:MyDate.getHoursandMin(n,!0,"bclient"):"",f+=g?g:$UI.getMsgHTML($.extend(k,{dname:l,msg:m,time:n,sender:j,previoussender:h==j,convvisitorid:b,convchid:c,iscannedarticle:i.iscannedarticle})),h=Message.presender=j}var p=b?$Support.convtranscontainer:$Support.chatdiv||$("#msgmaindiv");if(!$Support.isBotChat||$("#msgmaindiv [data-dname]").length==0)f=Message.format(f),p.html(Message.getDisplayContent(f));$UI.showWaitingDialog();if($Support.isBotChat){var q=$Support.botchatprops.status;q=="connected"&&!$Support.botchatprops.hidetransfer?$UI.appendTransferDiv():q=="waiting"&&$Support.getWaitingCookie()?$UI.showTransferWaiting():q=="missed"&&$UI.showTransferMissed()}p&&p.length&&!c&&$(p).scrollTop(p[0].scrollHeight-p[0].offsetHeight);var r=$("#msgmaindiv");r[0]&&r.scrollTop(r[0].scrollHeight);var s=Object.keys(SUPPORT_REPS).length;r.length&&$Support.isChatExist()&&s&&!$Support.proactive&&!avimpl.hideCallIcon&&!c?$("#audiocall").show():$("#audiocall").hide(),b||($UI.showWaitingDialog(),$Support.setCookie(),delete $Support.waitTimer),this.setMessageClass()},getPhotoURL:function(){var a=$Support.EmbedObj;return _SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+a.attenderimagefkey+"/photo.ls?nocache=1"},handleKeyDown:function(a,b,c){try{if(b==13&&c.shiftKey)return!0}catch(c){}var d=a.parent().find(".smileli").length;if(d!=0&&[39,37,38,40,13].indexOf(b)!=-1){c.preventDefault?c.preventDefault():c.returnValue=!1;return}b==13&&(c.preventDefault?c.preventDefault():c.returnValue=!1)},handlePredictMsg:function(a){if($Support.EmbedObj.visitorID==-1||a.attr("dockeyup")!=="sendmessage")return;var b=$.trim(a.val()),c=this;Licence.verify("creditmask")&&(b=Message.checkMaskOccurance(b,!1)),b!=""&&!c.enablepmsg&&(c.enablepmsg=!0,c.prdcttimer=setTimeout(function(){LSMessanger.sendPredictMessage(b),c.enablepmsg=!1},3e3))},handleRating:function(a){if($Support.Util.isPreview())return;$(".sqico-star").removeClass("sel"),a.addClass("sel"),$("#msgarea").focus(),this.feedbacksent||$Support.setRating(a)},handleFeedback:function(a,b,c){$Support.toggleSendButton(a);if(b===13){if(!this.validateFields(a.parent()))return c.preventDefault(),!1;$Support.sendFeedback(a)}},submitFile:function(a,b){try{var c=$(a)[0];if(c.files.length===0)return}catch(d){}this.hideMoreActionDiv();try{this.handleDropEvent($Support.EmbedObj.chatID,b,c.files)}catch(e){}return!1},handleSendMail:function(a,b,c){var d=a.parent();a.val().length>=1?d.addClass("icoclr"):d.removeClass("icoclr"),b===13&&d.find('[documentclick="triggermail"]').trigger("click")},postMessage:function(a,b){if(b==undefined)return;var c={type:$Support.type,operation:a,value:b};sendPostMessage(c)},loadPostMessage:function(){window.addEventListener?addEventListener("message",$Support.Util.handlePostMessage):attachEvent("onmessage",$Support.Util.handlePostMessage)},handlePostMessage:function(a){var b;try{b=JSON.parse(a.data)}catch(c){return}var d=b.operation,e=b.value,f=$Support.Util;d=="apivalues"?$Support.handleApiData(e):d=="broadcast"?$Support.handleApiData(e,!0):d=="sound"&&$UI.setSoundConfig()},handleTriggers:function(a,b){var c=$Support.Util;if(a===TRIGGER_SEND_MESSAGE&&!$Support.waitTimer){if($Support.EmbedObj.chatID!==-1)return;EmbedSound.play("smessage"),c.handleChatTrigger(b),c.handleCallbacks("visitor.chattrigger",b)}else a===TRIGGER_PLAY_TUNE&&EmbedSound.play(b.tune)},handleTrackChat:function(a){if($Support.EmbedObj.chatID!==-1)return;$Support.Util.handleCallbacks("visitor.chattrigger",{}),$Support.Util.proactiveChat(a)},handleUTSConnect:function(a){var b=$Support.EmbedObj.chatID,c=$Support.EmbedObj.visitorID;if(b!==-1&&!a.isnewconnection)return;b!==-1&&c!==-1&&a.isnewconnection&&$Support.rejoinVisitorInUTS()},proactiveChat:function(a){var b=$Support.EmbedObj;if($Support.istrigmsg||b.chatID!==-1)return;delete $Support.istrigmsg,b.setVisitorID(-1),b.uvid=a.uvid,b.setAttender(a.attender),b.attenderemail=a.attenderemail,b.setChatID(a.chid),b.setVisitorEmail(a.email),b.setVisitorName(a.name),b.setVisitorPhone(a.phone),b.setSelectedDept(a.department),b.attenderimagefkey=a.image_fkey,b.attenderuseragent=a.attender_useragent,b.setvwmsID(a.vwmsid),b.pmsg=a.msg,b.attenderaboutme=a.aboutme,b.attendername=b.triggername=getUnescapedText(a.attendername),b.chatintime=(new Date).getTime()-1e3,$Support.proactive=!0,LSMessanger.setNickName(a.name),$EmbedManger.setQuitStatus(!1),LSMessanger.register($Support.Util.productCode,b.vwmsid),$Support.setCookie(),$Support.handleOnGoingchatActionsInConversation("newchat")},handleChatTrigger:function(a){var b=$Support.EmbedObj,c=$Support.getParent().$ZSIQUtil.getAPIValues();if(b.chatID!==-1||b.visitorID!==-1||!c.triggermsg&&$Support.istrigmsg)return;$Support.istrigmsg=!0;var d=a.attenderdetails;b.pmsg=a.message,b.triggername=a.sendername,d&&(b.attenderimagefkey=d.imagefkey,b.setAttender(d.attender)),delete b.question,delete $Support.waitingtime,$Support.setTriggerCookie(a),this.populateTriggerUI(a),$Support.handleOnGoingchatActionsInConversation("triggerchat",a)},populateTriggerUI:function(a){var b=a.attenderdetails||{},c={attendername:a.sendername||a.attendername,image_fkey:b.imagefkey||a.attenderimagefkey,aboutme:b.attenderaboutme},d=$Support.isFAQUIFocussed();!$Support.isConversationUIFocussed()&&!d&&$UI.setInnerHeader(c),$Support.contentdiv||$UI.setInnerBody(),$UI.showWaitingUI(),$UI.setFooter(),d&&($Support.incrementUnreadCount(),$("#conv-tab").removeClass("sel"),$("#faqtab").addClass("sel"))},toggleAudio:function(a){var b=a.hasClass("sqico-mute")?-1:1;$Support.LSDB.set($Support.EmbedObj.chatID+"_sound",b),$UI.setSoundConfig(),this.handleUnmute(),a.parent()[0]&&a.parent()[0].nodeName!=="UL"?shtml=$UI.getSoundHTML(!0):shtml=$UI.getSoundHTML(),a.replaceWith(shtml);if(b==-1)EmbedSound.stop();else if($Support.endtimer){var c=0;try{var d=$("#endtimer").text();c=parseInt(d.split(" ")[0])}catch(e){}c>0&&EmbedSound.play("endtimer",c)}},handleUnmute:function(){var a=$Support.EmbedObj.soundval;if(!isUndefined(a)&&a==-1){var b=$UI.getSoundHTML(!0);$(".sqico-more").before(b)}else $(".sqico-more").prev("span.sqico-unmute").remove()},hideMaskAnim:function(){$Support.maskdiv.addClass("hidemaskanim")},setTextareaHeight:function(){if(window.parent.$ZSIQWidget.getWidgetObject().isshowcallbubble)return;var a=$Support.contentdiv;if(!a||!$Support.container.hasClass("outerwin"))return;var b=0,c=$Support.getComposer();c.removeAttr("style"),a.children('div:visible:not("#info_banr")').each(function(){b+=$(this).outerHeight(!0)});var d=a.height();if(d<b){a.find(".msgbox").addClass("posrel");return}b=d-b,$("#msgarea").height(function(a,c){return c+b})},removeDiv:function(a){setTimeout(function(){a.remove()},2e3)},handleCaptcha:function(){var a=$Support;this.LSDB.remove("ZLD"+a.EmbedObj.livelsid+"WTIME"),delete a.latency,clearTimeout(a.waitTimer),a.getCaptcha=this.getCaptchaValue(),a.handleWaitingDisplay(),a.addVisitor()},getCaptchaValue:function(){var a=$Support.contentdiv.find(".captcha");if(a.hasClass("hidemaskanim"))return{};var b=a.find('input[type="text"]'),c={};return c[b.attr("purpose")]=b.val(),c},handleDropEvent:function(a,b,c){if(a==-1)return;try{b.preventDefault(),LSDragDrop.onDropEvent($Support.EmbedObj.chatID,b,c)}catch(d){}},showPasteUI:function(){var a=PasteImage.getHTML();$("#pstimg-main").remove(),$Support.container.addClass("imgcmt").find("header").after(a),PasteImage.updateDetailes($Support.container)},handlePushMessage:function(a){var b=a.msg;b.indexOf("http")==-1&&(a.msg=b="http://"+b);try{if($Support.pushwinobj.window!=null){$Support.pushwinobj.location.href=b;return}$UI.notifyUrlShare(a)}catch(c){$UI.notifyUrlShare(a)}},openPushPage:function(a){$UI.hideBanner(),$Support.pushwinobj=window.open(a)},handleTextareaEnter:function(a,b,c,d,e){var f=$("#chatconsent");if($Support.Util.getChatConsentStatus()&&f.length==1&&f.is(":checked")==0){$Support.Util.removeSendClickAction();return}$Support.toggleSendButton(a);if(b==13&&c.shiftKey)return!0;if(e)return!0;(b===13||isUndefined(b))&&this.handleStartChat(d,c)},handleCallFdbEnter:function(a,b,c,d,e){if(b==13&&c.shiftKey)return!0;if($.trim(a.val())==="")return;(b===13||isUndefined(b))&&$Support.sendFeedback()},handleStartChat:function(a,b){if($Support.Util.isPreview())return;var c=$Support.container;$Support.checkCustomFields(),$UI.hideBanner(),c.find(".hidemaskanim").remove();if(c.hasClass("outerwin")&&!this.validateFields(c))return b&&b.preventDefault(),!1;$Support.updateInputValues(),typeof a=="function"&&a()},hidePasteUI:function(){$("#pstimg-main").addClass("hidemaskanim"),$("section.imgcmt").removeClass("imgcmt")},bindUtilEvents:function(){bindDragDropEvents(),handlePaste()},handleDrpdwnEvent:function(a,b,c){if($Support.Util.isPreview())return;var d=a.find("ul"),e=a.find("li.atsel"),f=d.find("li:first-child");if(b==13){if(e.length){e.trigger("click"),c.preventDefault();return}a.find("a").trigger("click"),c.preventDefault()}e=d.find("li.atsel").removeClass("atsel");var g=!1;if(b==40){if(d.is(":hidden")){a.find("a").trigger("click"),c.preventDefault();return}var h=e.next();e=h.length?h:f,c.preventDefault()}else if(b==38){var i=e.prev();e=i.length?i:d.find("li:last-child"),c.preventDefault()}e.addClass("atsel"),e.length&&d.stop(!0,!0).animate({scrollTop:e[0].offsetTop}),c.stopImmediatePropagation()},fillApiValues:function(){var a=$Support.EmbedObj,b=a.addinfo,c=getUnescapedText(b.question),d=getUnescapedText(a.visitorname),e=a.visitorphone,f=a.visitoremail;DynamicMsg.updateValues(b),$Support.container.find("[info]").each(function(){var a=$(this),c=b[a.attr("info")];isUndefined(c)||a.val(c)}),$Support.toggleSendButton();var g=b?b.forcefloatingwindow:null;if($Support.Util.isSIQMobilePreview()||(g||$Support.Util.isHandHeldDevice())&&$Support.isFloat()&&window.outerWidth<555)$("body").removeClass("siq_mprv").addClass("siq_mprv"),$Support.contentdiv.parent().removeClass("siq_mscreen").addClass("siq_mscreen"),this.setTextareaHeight()},handleCustomHTML:function(a){var b=$Support.customobj;if(!b)return;this.checkAndRemoveCustomField([]);try{$.each(b,function(b,c){c.index=b;var d=c.name;if(/^_default./.test(d)){var e=d.replace("_default.",""),f=$Support.container.find("[purpose=visitor"+e+"]"),g=c.required=="true"||c.required==1;/^department$/.test(e)&&(f=$Support.container.find("[purpose=department]"),f.text(getEscapedText(c.hint)));if(/^question$/.test(e))f=$Support.container.find("[purpose=question]"),f.attr("placeholder",getEscapedText(c.hint));else if(c.hint){if(f.length<1)return"";if(g)var h=f.attr("data-validate").replace("optional","required");else var h=f.attr("data-validate").replace("required","optional");f.attr("data-validate",h),f.attr("placeholder",getEscapedText(c.hint))}return""}var i=$($UI.getCustomHTML(c));if(!i.length)return!0;var j=c.before||c.after||"";j?(insertelem=$Support.container.find('[custom = "'+j+'"]'),insertelem[c.before?"before":"after"](i)):a?i.insertBefore($("#usereditactionbtn")):i.insertBefore("div.msgbox"),c.type=="selectbox"&&$("#sqico-cdrpdwn"+b).dropdown({options:c.options,purpose:"customdrpdwn",defaultval:c.hint||c.name||"Custom"});if(c.errorinfo){var k=$Support.EmbedObj,d=c.name;k.errorinfo[d]=c.errorinfo}}),this.handleCustomVisibility(),this.setTextareaHeight()}catch(c){}},handleCustomVisibility:function(){var a=$Support.EmbedObj,b=$Support.contentdiv.find('[purpose="custom"]'),c=this;$.each(b,function(b,c){var d=$(c),e=d.attr("visibility")!="undefined"?d.attr("visibility"):"both";d.hide();var f=d.prev(".subtitle").hide();e=="both"||a.status&&e=="online"||!a.status&&e=="offline"?(d.show(),f.show()):(d.remove(),f.remove())}),b.find("input[type=radio],input[type=checkbox]").off().on("change",function(){var a=$(this).attr("name");c.handleInputChange(a,b.find("input[name='"+a+"']:checked").map(function(){return this.id}).get())})},removeSendClickAction:function(){$("#sqico-send").removeAttr("documentclick")},getFileURL:function(a,b){var c=new FileReader;c.onload=function(a){b(a.target.result)},c.readAsDataURL(a)},handleDeptChange:function(a,b){var c=b?!1:!0,d=a.find("span").attr("status"),e=this,f=$Support.EmbedObj;f.department=a.attr("val");if(d!="1")$UI.updateOfflineUI(null,c);else{if(!this.prevstatus||this.prevstatus=="1")return;$Support.isFAQEnabled()&&$("#msgarea").parent().find("#sqico-send").remove(),$UI.updateOnlineUI(null,c),f.question&&($Support.composer=$("#msgarea"),$Support.composer.text(f.question),$Support.toggleSendButton()),e.setTextareaHeight()}this.prevstatus=d},handleResize:function(){$Support.Util.calculateContentHeight(),$Support.Util.setTextareaHeight(),$Support.Util.calculateTextareaHeight();if($Support.isParentIframe()&&$Support.type!=="embed")return;var a=$Support.container,b=$("body").children('#cmpylogo:not(".nologo")'),c=b.length!=0?b.outerHeight():0,d=$Support.container.find("header").outerHeight()+c;a.css("height",$(window).height()-c);var e=$Support.contentdiv;e.css("height",a.find("footer").offset().top-d-8),$Support.chatdiv&&$Support.chatdiv.css("height",e.outerHeight()-(e.find(".usrinpt").outerHeight()+e.find(".chtend").outerHeight(!0))),$Support.Util.setTextareaHeight()},isInValidVisitorName:function(a){return a=a||$Support.EmbedObj.visitorname,a?a&&(a.lastIndexOf("Visitor ",0)===0||a.lastIndexOf("Guest",0)===0):!0},handleInputChange:function(a,b){var c={val:b,name:a};this.handleCallbacks("custom.field",c)},handleCallbacks:function(a,b){if(a&&b){var c={};c[a]=b,$Support.getParent().$ZSIQWidget.handleCallBacks(c)}},handleGroupIcon:function(a){var b=a.participants;b&&getObjectSize(b)>1&&$UI.addGroupIcon()},IsMandatoryFieldsAvailable:function(){var a=$Support.EmbedObj,b=a.eprops,c=$Support.customobj,d=$Support.Util.isInValidVisitorName()&&JSON.parse(b.isname[0])&&JSON.parse(b.isname[1].ismandatory)||!a.visitoremail&&JSON.parse(b.isemail[0])&&JSON.parse(b.isemail[1].ismandatory)||!a.visitorphone&&JSON.parse(b.isphoneno[0])&&JSON.parse(b.isphoneno[1].ismandatory),e=!1;try{for(var f=0;f<c.length;f++){var g=c[f];if(""+g.required=="true"&&(!g.visibility||g.visibility!="offline"))if(/^_default./.test(g.name)){var h=g.name.replace("_default.","");if(/^department$/.test(h))continue;if(h=="name"&&JSON.parse(b.isname[0])&&$Support.Util.isInValidVisitorName()){e=!0;break}if(h=="email"&&JSON.parse(b.isemail[0])&&!a.visitoremail){e=!0;break}if(h=="phone"&&JSON.parse(b.isphoneno[0])&&!a.visitorphone){e=!0;break}}else if(!a.cinfo||!a.cinfo[g.name]){e=!0;break}}}catch(i){}return d||e},checkAndRemoveCustomField:function(a){var b=$Support.contentdiv;if($.isEmptyObject(a))b.find("div[custombx]").remove();else for(var c=0;c<a.length;c++)b.find("[customid='"+a[c]+"']").remove()},isApiWaitHandler:function(a){return isPostMessageSupported()&&$Support.isscript&&$Support.isapiwaitinghandler},setBrowserValues:function(){var a=$Support.EmbedObj.eparams,b=a.cpage||a.referrer;Browser.setReferer(a.referrer),Browser.setCurrentPage(b),Browser.setPageTitle(a.pagetitle)},handleDeptApiChange:function(a,b){if(a!=null&&a!=-1)if($.isArray(a)){$("#sqico-drpdwn").find("li").each(function(){var b=$(this);$.inArray(b.attr("uniname"),a)==-1&&$(this).hide()});var c=$("#sqico-drpdwn").find("li");c.sort(function(a,c){return b.indexOf($(c).attr("uniname"))<b.indexOf($(a).attr("uniname"))?1:-1}),$("#sqico-drpdwn").find("ul").empty().append(c)}else a==="online.department"&&$Support.EmbedObj.status&&$("#sqico-drpdwn").find("li").each(function(){var a=$(this);$(a).children("span").attr("status")===$Support.DEPT_OFFLINESTATUES&&$(this).hide()})},isCampaignEnabled:function(){try{var a=$Support.EmbedObj.integprops.integinfo;if(Licence.isFreePlan()||!a)return!1;var b;for(var c in a){$Support.enabledCampaignID=c,b=c;break}if(b&&a[b].status=="0")return!1;var d=a[b].listname;return d&&d!==""}catch(e){return!1}},hideFeedback:function(a){if($Support.Util.isPreview())return;$UI.hideMaskDiv(),$Support.isfeedbacksent=!0,$Support.isratingsent=!0,$Support.Util.handleFeedbackSubmit(),$("#sqico-send").parent().remove()},displayInfo:function(a){$UI.displayInfo(a)},hideInfo:function(){$UI.hideBanner()},showOfflineBanner:function(){var a=$Support.EmbedObj;if($Support.proactive||a.chatID!==-1)return;if(!a.status||!this.isOnline(a.department)){var b=$Support.getCookieValue("ZLD"+a.livelsid+"OFFLINEBANNER");if(!b){$UI.showBanner($Support.getOfflineMessage(),!0,null,3e3);var c=3e5;setTimeout(function(){$Support.LSDB.set("ZLD"+a.livelsid+"OFFLINEBANNER",!0,c+1e4),c})}}},showOnlineBanner:function(){var a=$Support.EmbedObj;if($Support.proactive||a.chatID!==-1)return;if(a.status||this.isOnline(a.department)){var b=$Support.getCookieValue("ZLD"+a.livelsid+"ONLINEBANNER");if(!b){$UI.showBanner(LSResource.getRealValue("ne.onlinemsg"),!0,null,3e3);var c=3e5;setTimeout(function(){$Support.LSDB.set("ZLD"+a.livelsid+"ONLINEBANNER",!0,c+1e4),c})}}},isOnline:function(a){if(""+a=="-1")return!0;var b=$Support.EmbedObj.deptlist;for(var c=0;c<b.length;c++){var d=b[c];if(d.ID!=a)continue;return""+d.STATUS=="true"}},updateParentFontFamily:function(){var a=$Support.getParent().$ZSIQUtil.getWebFontFamily();$Support.font=a,$("html, body").css("font-family",a)},isSIQMobilePreview:function(){return $Support.Util.isPreview()&&parent._WIDGETPREV_MODE=="mobile"},isPreview:function(){return $Support.getParent().$ZSIQChat.isPreview()},isHandHeldDevice:function(){return $Support.Util.isSIQMobilePreview()?!0:/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB10|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:!1},handleShowConversation:function(a,b){var c="";$Support.Util.updateViewAttribute("msgarea");if($Support.convlistcontainer.find("#pastchatconv").find(".siqc_cntbody").length>0){$Support.Util.showConversationListUI();return}$Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody").length==1&&(c=$($Support.convlistcontainer.find("#currchatconv").find(".siqc_cntbody")[0]).attr("chid"),$Support.Util.showConversationListUI()),$Support.PopulateConversationList(function(d,e){if(!d.length)return;var f="";d.forEach(function(a){if(c==a.chid)return;a.question=getEscapedText(a.question),f+=$Temp.getConversationHistoryHTML(a)}),e?$Support.convlistcontainer.find("#pastchatconv").prepend($(f)):$Support.convlistcontainer.find("#pastchatconv").append(f);if(!b&&(a||$Support.EmbedObj.chatID==-1))$Support.Util.showConversationListUI();else{var g=$Support.container.find("#showsiqconv");g.find("#siqnoticon").hide(),g.show()}$Support.Util.calculateContentHeight()})},showMessageAreaUI:function(a,b){$Support.convlistcontainer.hide(),$Support.convtranscontainer.hide(),$Support.container.find("#showsiqchatui").hide();if(a=="showsiqchatui"&&$Support.contentdiv.find("[custom=question]").length==0){$Support.checkAndShowUI();var c=$Support.EmbedObj;delete c.VISITID,delete c.attender,delete c.attenderemail,delete c.attenderimagefkey,delete c.attendername,delete c.chatintime,delete c.isaudiocall,$Support.callquitstatus=undefined,$Support.Util.showMessageAreaUI()}var c=$Support.EmbedObj,d=c.visitorID,e=$Support.getCookieValue("ZLD"+c.livelsid),f=e&&e["aboutme_"+d]||c.attenderaboutme,g=e&&e["attname_"+d]||c.attendername;!g&&$Support.istrigmsg&&(g=$Support.EmbedObj.triggername),$Support.Util.updateViewAttribute("msgarea");var h=getEscapedText(g)||(c.status?LSResource.getRealValue("ne.chatwithus"):LSResource.getRealValue("ne.offlinemessage")),i=$("body"),j=i.find('[prop="header"]');i.find("#attname").text(h),i.find("#attabtme").text(f?CommonUtil.decodeHTML(f):""),i.find("#siqconvchaticon").remove();var k=$Support.getParent().$ZSIQUtil.getAPIValues(),l=JSON.parse(c.eprops.iclogo)?c.clogo:"";k.clogo&&(l=k.clogo);var m=JSON.parse(c.eprops.icphoto)&&c.attenderimagefkey?$Support.Util.getPhotoURL():"";l=g?m:l,j.find(".cmplogo").removeAttr("style"),i.find("#complogo").attr("src",l),$Support.isBotChat?j.find(".cmplogo").attr("data-chttype","bot"):JSON.parse(c.eprops.icphoto)?j.find(".cmplogo").attr("data-chttype","agent"):j.find(".cmplogo").removeAttr("data-chttype");var n=j.find('[prop="clogo"]'),o=g?"sqico-user":"sqico-chat";n.removeClass("sqico-chat sqico-user wincustom_bg").addClass(o),l?j.removeClass("nologo"):(j.addClass("nologo"),n.addClass("wincustom_bg")),j.removeClass("siq-usr").removeClass("conv_headview"),c.attendername&&j.addClass("conv_headview");var p=$Support.container.find("#showsiqconv");p.find("#siqnoticon").hide(),$Support.getConversationData()&&p.show(),$Support.contentdiv.show(),$Support.container.find("footer").show(),$Support.removeConversationPopupMessage(),$Support.applyOngoingChatClass("siqc_cntbody");var q=$Support.getUnreadCount(),r=$Support.contentdiv.find("#msgmaindiv");if(q){$Support.removeUnreadCookie(),$Support.getParent().$ZSIQWidgetUI.removeUnreadCount();var s=p.find(".siqc_prochtcls");s.length!=0&&s.remove(),r.length&&Message.scroll(r[0]),$Support.getComposer().focus()}var t=Object.keys(SUPPORT_REPS).length;r.length&&$Support.isChatExist()&&t&&!$Support.proactive&&!avimpl.hideCallIcon&&$("#audiocall").show(),$Support.convongoingchatobj&&($Support.convongoingchatobj.find(".siqc_eletype").html("")[0].className=c.chatID!=-1||$Support.istrigmsg?"siqc_eletype sqico-chat2":"siqc_eletype"),b&&$("#msgarea").val(b),$Support.isFAQEnabled()&&($("#conv-tab").addClass("sel"),$("#faqtab").removeClass("sel")),$Support.Util.calculateContentHeight(),$Support.Util.setTextareaHeight()},showConversationListUI:function(){var a=$Support.convlistcontainer.find("#convwtime");a.length!=0&&a.html(MyDate.timeDifference(a.attr("convmtime"))),$Support.convlistcontainer.find("#pastchatconv").find("[convmtime]").each(function(){var a=$(this),b=a.attr("convmtime");b&&a.html(MyDate.timeDifference(b))}),$("#audiocall").hide(),$Support.contentdiv.find("#edituserdetails").length>0&&($Support.contentdiv.find("#edituserdetails").remove(),$Support.enableTextarea($Support.getComposer())),$Support.convtranscontainer.hide(),$Support.isFAQEnabled()||$Support.container.find("footer").hide();var b=$Support.container.find("#showsiqconv");b.find("#siqnoticon").hide(),b.hide(),$Support.Util.updateViewAttribute("convlist");var c=$("body");c.find("#attname").text(LSResource.getRealValue("converation.withus")),c.find("#attabtme").text(""),c.find("#complogo").attr("src","");var d=c.find('[prop="header"]');d.find(".cmplogo").removeAttr("style"),d.addClass("nologo"),d.find(".cmplogo").attr("data-chttype","conv"),d.removeClass("siq-usr").removeClass("conv_headview");var e=d.find('[prop="clogo"]');e.removeClass("sqico-user wincustom_bg").addClass("sqico-chat wincustom_bg "),$Support.convlistcontainer.show(),this.showSiqChatUI()},showConversationTranscriptUI:function(a){$("#audiocall").hide(),$Support.convlistcontainer.hide(),$Support.isFAQEnabled()||$Support.container.find("footer").hide();var b=$Support.LSDB.get("ZLD"+$Support.getParent().$ZSIQChat.getWidgetData().widgetobj.lsid+"avuid"),c=$Support.LSDB.getFromSession(b+"_conversation"),d="",e="",f="",g,h="";for(var i in c)if(c.hasOwnProperty(i)){var j=c[i];if(j.visitorid!=a)continue;!j.chid&&!j.attender?d=LSResource.getRealValue("conversation.offlinechat"):j.attender?(d=j.attender,f=$Support.EmbedObj.eprops.icphoto?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+j.attender_imgkey+"/photo.ls?nocache=1":""):d=LSResource.getRealValue("conversation.missedchat"),j.designation&&(e=j.designation),g=j.isbotattender}$Support.Util.updateViewAttribute("convchat");var k=$("body");k.find("#attname").text(d),k.find("#attabtme").text(e),k.find("#siqconvchaticon").remove(),k.find("#complogo").attr("src",f);var l=k.find('[prop="header"]');l.removeClass("nologo").addClass("conv_headview"),l.find(".cmplogo").removeAttr("style");var m=l.find('[prop="clogo"]'),n=d?"sqico-user":"sqico-chat";m.removeClass("sqico-chat sqico-user wincustom_bg").addClass(n),g?l.find(".cmplogo").attr("data-chttype","bot"):l.find(".cmplogo").attr("data-chttype","agent"),f||(l.addClass("siq-usr").addClass("nologo"),m.addClass("wincustom_bg")),$Support.convtranscontainer.show(),this.showSiqChatUI();var o=$Support.container.find("#showsiqconv"),p=$Support.getUnreadCount(),q=o.find("#siqnoticon");p&&q.length==0&&o.prepend("<em id='siqnoticon' class='siqc_prochtcls' documentclick='showchatui'></em>"),o.find("#siqnoticon").show(),o.show()},showSiqChatUI:function(){var a=$Support.EmbedObj,b=$Support.isfeedback&&$Support.isfeedbacksent,c=$Support.israting&&$Support.isratingsent,d=!$Support.isfeedback&&!$Support.israting;$Support.contentdiv.hide(),$Support.isFAQEnabled()||$Support.container.find("footer").hide(),a.chatID==-1&&(b||c||d||$Support.EmbedObj.lchid==-1)&&!$Support.proactive&&!$Support.istrigmsg&&$Support.container.find("#showsiqchatui").show(),$Support.removeConversationPopupMessage(),$Support.Util.calculateContentHeight()},isAnnonUser:function(a){try{if(a.indexOf("$")!=-1)return!0}catch(b){}return!1},getFileClassType:function(a){var b="";return a?(a.indexOf("image")!=-1?b="sqico-camera":a.indexOf("audio")!=-1?b="sqico-audio":a.indexOf("video")!=-1?b="sqico-video":b="sqico-file-min",b):b},hexToRGBA:function(a,b){a+=a.length==4?a.slice(1,4):"";var c=parseInt(a.slice(1,3),16),d=parseInt(a.slice(3,5),16),e=parseInt(a.slice(5,7),16);return"rgba("+c+", "+d+", "+e+", "+(b||1)+")"},handleCompanyLogo:function(){var a=$("#complogo");a.on("load",function(){a.parent().removeClass("sqico-clogo")}),a.on("error",function(){if(a.attr("src")=="")return;a.attr("src","").parent().addClass("sqico-clogo")})},lastMessageTemplate:function(){if(!$Support.rating)return;var a=$Support.rating,b=a?'<div class="lstmsg_strs" id="feedback_res" documentclick="showChatFeedback"><span class="sqico-star" data-prop="rating">'+a+'</span><div class="rating"><span class="sqico-star siq-rating-icon" documentclick="rating"></span><span class="sqico-star siq-rating-icon" documentclick="rating"></span><span class="sqico-star siq-rating-icon" documentclick="rating"></span><span class="sqico-star siq-rating-icon" documentclick="rating"></span><span class="sqico-star siq-rating-icon" documentclick="rating"></span></div></div>':"";return'<div class="agntmsg siq-agntmsg fd_lastmsg" data-field="message"><div purpose="name" class="siq-user-name"></div><div class="msgbx"><span class="siq-user-message">'+LSResource.getRealValue("ne.rating.message")+"<br>"+LSResource.getRealValue("ne.rating.fbmessage")+"</span>"+b+"</div>"+"</div>"},showChatFeedback:function(a){a.addClass("sel")},handleFeedbackSubmit:function(){var a=$("#feedback_res");if(a.length!=0){a.removeClass("sel").find('[data-prop="rating"]').text($Support.rating);return}var b=$Support.contentdiv.find("#msgdiv");b.append(this.lastMessageTemplate()),this.setMessageClass();var c=b.find(".fd_lastmsg");c.hasClass("single_msg")&&c.find('[purpose="name"]').text($Support.EmbedObj.attendername),Message.scroll($("#msgmaindiv")[0]);var d=$("#feedback_res").find(".rating");d.find(".sel").removeClass("sel"),d.find("span:nth-child("+(6-$Support.rating)+")").addClass("sel")},setMessageClass:function(a){var b=$Support.container.find('[data-field="message"]');b.each(function(){var a=$(this);a.removeClass("single_msg lst_msg");var b=a.prev(),c=a.next(),d=!c.length&&!b.length||!c.length&&a.hasClass("agntmsg")&&b.hasClass("vismsg")||!c.length&&a.hasClass("vismsg")&&b.hasClass("agntmsg")||a.hasClass("agntmsg")&&c.hasClass("vismsg")&&b.hasClass("vismsg")||a.hasClass("vismsg")&&c.hasClass("agntmsg")&&(b.hasClass("agntmsg")||!b.length);if(d){a.addClass("single_msg");return}var e=!c.length||a.hasClass("agntmsg")&&c.hasClass("vismsg")||a.hasClass("vismsg")&&c.hasClass("agntmsg");e&&a.addClass("lst_msg")})},getTextColor:function(a){var b=parseInt(a.slice(1,3),16),c=parseInt(a.slice(3,5),16),d=parseInt(a.slice(5,7),16);return b*.299+c*.587+d*.114>186?"#444":"#fff"},calculateTextareaHeight:function(){if($Support.container.hasClass("outerwin"))return;var a=$Support.container,b=a.find(".msgarea");b.removeAttr("style");var c=a.find(".content"),d=b[0].scrollHeight+2,e=d>140?{height:"140px",overflow:"auto"}:{height:d+"px",overflow:"hidden"};b.css(e);var f=$("#consentbannerdiv").length?$("#consentbannerdiv").height()+10:0,g=c.height()-c.find(".txtarewrap").height();c.find(".chtcont").css({height:g-f+"px"}),a.find(".dragmask").css({height:g+"px"})},calculateContentHeight:function(){var a=$Support.container,b=parseInt(a.css("border-left-width"))*2,c=a.outerHeight()-(a.find("header").outerHeight()+a.find("footer").outerHeight()+b);a.find(".siq_content").css({height:c})},getImagePreviewHTML:function(a){var b=a.user_photo||"https://img.zohostatic.com/salesiq/July_09_2018_1_https/images/user/user_160-160.png",c='<div class="zsiq_prv_main zsiq_imgprv" id="zsiqimagepreview" zsiqclose="true" onclick="$ZSIQChatWindow.closeImagePreview(event)"><img src="'+a.url+'" zprv-prop="image" zsiqclose="true" />'+"<div>"+'<img src="'+b+'" zprv-prop="userimage"/>'+'<div class="zsiq_prv_cmtmain">'+'<p zprv-prop="userneme">'+getEncodedText(a.user)+"</p>"+'<div zprv-prop="comment">'+getEncodedText(a.comment)+"</div>"+"</div>"+'<a href="'+a.durl+'" zprv-prop="download"><em class="sqico-download"></em></a>'+"</div>"+'<em class="sqico-close" zsiqclose="true"></em>'+"</div>";return c},showImagePreview:function(a){var b=a.parents('[data-field="message"]'),c=b.hasClass("vismsg"),d=b.find("img").attr("src");if(!d)return;var e=b.find("code").text(),f=b.find(".fdload").attr("href"),g=c?"":$Support.container.find("header img").attr("src"),h=b.attr("data-dname"),i={url:d,comment:e,durl:f,user:h,user_photo:g},j=this.getImagePreviewHTML(i);$(window.parent.document).find("body").append(j)},handleUpdateBTN:function(a){var b=$("#continue_btn"),c=b.attr("data_isupdate")=="true",d=c?"ne.update":"common.continue";a&&(d=c?"common.updating":"common.continuing"),b.text(LSResource.getRealValue(d))},handleAccordian:function(a){var b=$('[data-type="accordian-item"]').hide();$('[data-type="accordian-header"]').click(function(){var c=$(this),d=b.filter(":visible"),e=c.prev();$('[data-type="accordian-header"]').find(".sqico-uarrow").removeClass("sqico-uarrow"),d.animate({height:"toggle",opacity:"toggle"},"500");if(d[0]==e[0])return;return typeof a=="function"&&a(c),c.find(".sqico-darrow").addClass("sqico-uarrow"),e.animate({height:"toggle",opacity:"toggle"},"500"),!1})},handleOnlineStatus:function(a,b){var c=$Support,d=c.EmbedObj;c.contentdiv||$UI.init(a),b&&!$Support.isOnlineChat()&&$UI.showBanner(LSResource.getRealValue("ne.onlinemsg"),!0,null),c.contentdiv.find("#msgarea").attr("dockeyup","textarea").val(d.question!=null?d.question:$("#msgarea").val()).parents(".msgbox").removeClass("posrel"),c.contentdiv.find("#msgarea").attr("dockeydown","textarea").attr("placeholder",LSResource.getRealValue("ne.message.hitenter")),$Support.isFAQEnabled()||$("footer").find(".floatrg").remove().end().append($Temp.getSendBtnHTML(LSResource.getRealValue("common.startchat"))),c.contentdiv.find("#msgarea").val()!=""&&$("footer").find("em#sqico-send").attr("documentclick","textarea"),c.Util.setTextareaHeight();var e=$Support.getParent().$ZSIQWidget.getWidgetObject();e.status=!0,e.onlysticker=!0,$Support.getParent().$ZSIQWidgetUI.drawWidget(e)},updateViewAttribute:function(a){$Support.container.attr("cwview",a),$Support.container.attr("themeid")==="2"&&$("body").attr("cwview",a)},getFAQLabel:function(){var a="";if($Support.isFAQEnabled()){a=LSResource.getRealValue("faq.header.title");if($Support.EmbedObj.faqaccess){var b=$Support.EmbedObj.faqaccess[1].label;b!==""&&(a=b)}}return a},getChatConsentStatus:function(){var a=$Support.getParent().$ZSIQChat.getWidgetData().widgetobj,b=$Support.EmbedObj,c=b.pprops,d=$Support.LSDB.getFromSession(_SCREENNAME+"_gdpr_chatconsent"),e=a.isgdprenabled==1?!0:!1,f=e&&JSON.parse(c.isgdprenabled)&&JSON.parse(c.chatprivacyconfig)==1&&!d?!0:!1;return f},getConversationSelect:function(a){var b="",c=a.options,d=a.type;for(var e=0;e<c.length;e++){var f=c[e],g=f.text||f.value;b+='<span class="choose mB10" purpose="custom" val="'+g+'" prop="'+d+'">'+g+"</span>"}var h="";return'<div class="vismsg siq-visitmsg single_msg"><div id="sel_msg" isrequired="'+a.required+'" class="sel_msg font14" data-type="type"></div><div class="options textL" id="conversationoption" data-type="'+a.type+'" documentclick="chooseField">'+b+"</div>"+h+"</div>"},chooseField:function(a,b){var c=$(b.target),d=c.attr("val");Message.send($Support.EmbedObj.chatID,d),a.parent().remove()},getOfflineAPIConsent:function(a){var b=$Support.getParent().$ZSIQUtil.getAPIValues();if(b.textbannerobj&&b.textbannerobj.offline){var c=b.textbannerobj.offline;a=c.description&&c.description.trim().length!=0?c.description:a;if(c.policytextandlink){var d=c.policytextandlink,e=d.text&&d.text.trim().length!=0?d.text:"",f=d.link&&d.link.trim().length!=0&&$Support.getParent().$ZSIQUtil.isValidURL(d.link)?d.link:"";a=$Support.getParent().$ZSIQUtil.hyperLinksSubString(a,e,f)}}return a}};function bindDragDropEvents(){if(!CommonUtil.isAllowFileSharing())return;jQuery.event.props.push("dataTransfer");var a=$Support.container;a.on({dragover:function(a){a.preventDefault(),$UI.showDragDropUI()},drop:function(a){a.preventDefault(),$Support.Util.handleDropEvent($Support.EmbedObj.chatID,a),$UI.hideDragDrop()},dragleave:function(a){$UI.hideDragDrop()}})}function handlePaste(){CommonUtil.isAllowPasteImage()&&$("#msgarea").on("paste",function(a){PasteImage.onPaste(a,this),a.stopImmediatePropagation()})}function handleDrag(){function g(b){parent.$ZSIQChatWindow.cacheChatDivPosition(),a.off("mousemove.drag mouseleave.drag"),b.stopImmediatePropagation()}if($Support.isMobileWidth())return;var a=$("header"),b=0,c=0,d=0,e=0,f;a.on("mousedown.drag",function(f){if(f.target.tagName==="INPUT")return;d=f.pageX,e=f.pageY,a.on("mousemove.drag",function(a){b=a.pageX,c=a.pageY,parent.$ZSIQChatWindow.handleDrag(d-b+"#"+(e-c)),a.stopImmediatePropagation()}),f.preventDefault(),a.on("mouseup.drag",function(a){g(a)}).on("mouseleave.drag",function(a){g(a)})})}$(document).on("click","[documentclick]",function(a){try{var b=$(this),c={sendCallRating:function(){if($Support.Util.isPreview())return;$(".sqico-star").removeClass("sel"),b.addClass("sel"),$("#msgarea").focus(),this.feedbacksent||$Support.setRating(b)},sendCallFb:function(){$Support.sendFeedback()},moreaction:function(){$Support.Util.showMoreAction(b,a)},sendmail:function(){$UI.populateSendMail(b,a)},smiley:function(){$UI.populateSmiley(b)},userdetails:function(){$UI.showUserEditUI(!0,!0)},hideuserdetails:function(){$UI.hideUserEditUI()},updateuserdetails:function(){$Support.checkAndUpdateInfo(b)},triggermsg:function(){$Support.startTriggerChat()},min_iframe:function(){$Support.Util.minimizeEmbed()},max_iframe:function(){$Support.Util.maximizeEmbed()},close_iframe:function(){$Support.Util.closeEmbed()},chatend:function(){$Support.quitChat()},triggermail:function(){$Support.sendMail()},triggermailconfirm:function(){$Support.sendMailConfirm(b)},updatetranslatecookie:function(){$Support.updateTranslateCookie()},rating:function(){$Support.Util.handleRating(b)},showChatFeedback:function(){$Support.Util.showChatFeedback(b)},printfile:function(){$Support.printPreview()},toggleaudio:function(){$Support.Util.toggleAudio(b)},captcha:function(){$Support.Util.handleCaptcha()},restartchat:function(){$Support.restartchat()},imgupload:function(){PasteImage.uploadImage($Support.container)},imgcancel:function(){$Support.Util.hidePasteUI()},accepturl:function(){$Support.Util.openPushPage(b.attr("url"))},sendmessage:function(){$Support.triggerSendMessage()},textarea:function(){$Support.Util.handleStartChat(function(){$Support.startChat(b)})},missedleavemsg:function(){$Support.Util.handleStartChat(function(){$Support.missedLeaveMsg()})},leavemessage:function(){$Support.Util.handleStartChat(function(){$Support.handleLeaveMessage()})},feedback:function(){$Support.sendFeedback()},hideprogress:function(){$UI.hideUploadProgress(b.attr("msgid"))},hidefeedback:function(){$Support.Util.hideFeedback(b)},openmeeting:function(){$Support.handleMeetingJoinCB()},sharedesktop:function(){$Support.shareDesktop(b)},sharescreen:function(){avimpl.shareScreen()},resendmsg:function(){LSMessanger.resendMessages(RESEND_MANUAL)},showconvlist:function(){var b=a.target.id;if(b=="siqnoticon")return;var c=a.hasOwnProperty("originalEvent");$Support.Util.handleShowConversation(c)},showchatui:function(){var b=a.target.id;if(a.target.id=="removeconvpopup"||$(a.target).is("a"))return;$Support.Util.showMessageAreaUI(b)},fetchconvtranscript:function(){if(a.target.id=="showsiqchatui")return;$Support.getConversationChatTranscript(b.attr("chid"),b.attr("visitorid"))},removeconvpopupmsg:function(){$Support.removeConversationPopupMessage()},toggleMadatoryField:function(){$CWPreview.toggleMadatoryField(b)},triggerDeleteEMField:function(){$CWPreview.triggerDeleteEMField(b)},newsletter:function(){$Support.handleNewsLetter()},transferchat:function(){$Support.transferChat()},removetransfer:function(){$UI.removeTransferDiv()},transfermissed:function(){$Support.handleTransferMissed(b)},hidetransferoption:function(){$Support.hideTransferOption()},audiocall:function(){avimpl.startCall()},imagepreview:function(){$Support.Util.showImagePreview(b)},showfaq:function(){$FAQ.showFAQUI(b)},faqcategory:function(){$FAQ.showCategory(b),a.stopPropagation()},faqsearch:function(){$FAQ.handleSearch(b)},showconversation:function(){if($Support.Util.isPreview())return;b.addClass("sel").next(".sel").removeClass("sel"),$("#conv-tab").removeClass("count").find(".siqc_eletype").hide(),!$Support.getConversationData()||$Support.EmbedObj.chatID!==-1||$Support.istrigmsg?($Support.Util.showMessageAreaUI(),$Support.Util.calculateTextareaHeight()):$Support.Util.showConversationListUI(b)},faqpreview:function(){$FAQ.showFAQPreview(b)},extendview:function(){$FAQ.showAllArticlesInCategory(b)},chooseField:function(){$Support.Util.chooseField(b,a)}};c[b.attr("documentclick")]()}catch(d){}});var isComposing=!1,hasCompositionJustEnded=!1,brow_lang=$Support.getParent().$ZSIQUtil.getBrowserLanguage();$(document).on("keydown","[dockeydown]",function(a){var b=$(this),c=b.attr("dockeydown"),d=$Support.Util.getKeyCode(a);if(d==229)return!1;hasCompositionJustEnded=!1,d==27&&$Clickoutside.handleEscape(a);var e={textarea:function(){$Support.Util.handleKeyDown(b,d,a)},captcha:function(){d==13&&($Support.addVisitor(),a.preventDefault())},pasteimage:function(){d==27&&($Support.Util.hidePasteUI(),a.preventDefault())},dropdown:function(){$Support.Util.handleDrpdwnEvent(b,d,a)},triggermail:function(){$Support.Util.sendMail(a)},removeError:function(){b.removeClass("errfield")},searchfaq:function(){d==27&&b.parent().find(".sqico-close").trigger("click")}};e[c]()}).on("compositionstart",function(a){isComposing=!0}).on("compositionend",function(a){isComposing=!1,hasCompositionJustEnded=!0}),$(document).on("keyup","[dockeyup]",function(a){if(!(!!brow_lang&&brow_lang=="en"||!isComposing&&!hasCompositionJustEnded)){hasCompositionJustEnded=!1;return}var b=$(this),c=b.attr("dockeyup"),d=$Support.Util.getKeyCode(a),e={textarea:function(){$Support.Util.handleTextareaEnter(b,d,a,function(){$Support.startChat(b)})},sendmessage:function(){$Support.handleSendMessage(b,d,a)},leavemessage:function(){$Support.Util.handleTextareaEnter(b,d,a,function(){$Support.handleLeaveMessage(b)},!0)},triggermsg:function(){$Support.handleTriggerMsg(b,d,a)},missedleavemsg:function(){$Support.Util.handleTextareaEnter(b,d,a,function(){$Support.missedLeaveMsg(b)},!0)},feedback:function(){if(CallImpl.isCallWithChat){$Support.Util.handleCallFdbEnter(b,d,a);return}$Support.Util.handleFeedback(b,d,a)},triggermail:function(){$Support.Util.handleSendMail(b,d,a)},handlepasteimage:function(){PasteImage.handlepasteimage(b)},searchfaq:function(){$FAQ.searchFAQ(b,a)}};e[c]()}),$(document).mousedown($Support.Util.triggerAdditionalFileDownload),$(document).on("blur","[docblur]",function(a){var b=$(this),c=b.attr("docblur"),d={email:function(){$Support.Util.validateFields(b.parent())},custominput:function(){$Support.Util.handleInputChange(b.attr("id"),b.val())},required:function(){$Support.Util.validateFields(b.parent())}};d[c]()}),$(document).on("keydown",function(a){var b=$Support.Util.getKeyCode(a);b==27&&($Clickoutside.handleEscape(a),CommonUtil.handleEscape(a))}),$(document).on("keyup",function(a){var b=$(a.target);if(!b.filter("[data-validate*='required']").length)return;$.trim(b.val())===""?b.next().addClass("req"):b.next().removeClass("req")}),$(document).on("focusin",function(a){KeyHandler.winfocus=!0,$Support.iswindowfocused=!0,Message.stopBlinking()}),$(document).on("focusout",function(a){KeyHandler.winfocus=!1,$Support.iswindowfocused=!1}),$(window).resize(function(){$Support.Util.handleResize()}),$(document).on("keypress","[onenter]",function(a){var b=a.keyCode?a.keyCode:a.which;if(b=="13"){var c=$(this),d=c.attr("onenter"),e={updateuserdetails:function(){$Support.checkAndUpdateInfo(c.parents(".editfields").find('[documentclick="updateuserdetails"]'))}};e[d]()}}),KeyHandler={isWindowFocused:function(){KeyHandler.winfocus}};$ThemeHandler={},$ThemeHandler.theme1={updateContainer:function(){$(".siqembed").remove(),$("body").append($Support.container=$($Temp.getContainerHTML()))},updateHeader:function(a){$Support.container.prepend($Temp.getHeaderHTML(a)),handleDrag(),$("#zsiq_customcss").remove(),$("body").append(this.getCustomColor()),$Support.Util.handleCompanyLogo()},updateInnerHeader:function(a){var b=$Support.container.find("header");$Support.container.removeClass("outerwin");if(b.length){if(!$Support.proactive&&$Support.EmbedObj.attendername===a.attendername)return;this.animateHeader(a);return}this.updateHeader(a)},updateBody:function(a,b){$Support.container.append($Support.contentdiv=$($Temp.getBodyHTML(a,b))).append($Support.convlistcontainer=$($Temp.getConversationContainerHTML())).append($Support.convtranscontainer=$($Temp.getConversationTranscriptContainerHTML())),$Support.bindScrollForConversationListContainer()},updateInnerBody:function(){$Support.container.append($Support.contentdiv=$($Temp.getChatAreaHTML())).append($Support.convlistcontainer=$($Temp.getConversationContainerHTML())).append($Support.convtranscontainer=$($Temp.getConversationTranscriptContainerHTML())),$Support.chatdiv=$("#msgdiv"),$Support.chatmaindiv=$("#msgmaindiv"),$Support.composer=$("#msgarea"),handlePaste(),$Support.bindScrollForConversationListContainer()},updateFooter:function(){$Support.container.find("footer").remove().end().append($Temp.getFooterHTML()),$Support.isConversationUIFocussed()&&!$Support.isFAQEnabled()&&$Support.container.find("footer").hide(),$Support.container.append($Temp.getConversationCreateChatIConHTML()),this.populateSendBtn(),$Support.Util.handleResize(),$Support.Util.isCampaignEnabled()&&($Support.subscribe=!1,$("#newsletter").on("change",function(){$Support.subscribe=$(this).is(":checked")}));var a=$("#chatconsent");$Support.Util.getChatConsentStatus()&&a.length==1&&$("#chatconsent").on("change",function(){$(this).is(":checked")==1?$Support.toggleSendButton($Support.getComposer()):$Support.Util.removeSendClickAction()})},updateDeptDropdown:function(){$("#sqico-drpdwn").dropdown({options:$Support.EmbedObj.deptlist,purpose:"department",defaultval:LSResource.getRealValue("ne.chosedepartment")})},animateHeader:function(a){var b=$Support.container.find("header");a.attendername&&(b.find("#attname").html(getEscapedText(a.attendername)),b.find(".cmpylogo").removeClass("sqico-chat").addClass("sqico-user"));var c=a.aboutme||"",d=c?"":"noaboutme";b.find("#attabtme").html(getEscapedText(c)),b.removeClass("noaboutme").addClass(d),a.image_fkey&&JSON.parse($Support.EmbedObj.eprops.icphoto)?(b.removeClass("nologo"),b.find(".cmplogo").removeAttr("style").find("#complogo").attr("src",$Support.Util.getPhotoURL())):a.chid&&(b.removeClass("nologo").addClass("nologo"),b.find(".cmplogo").removeAttr("style").find("#complogo").removeAttr("src")),$Support.isBotChat?b.find(".cmplogo").attr("data-chttype","bot"):JSON.parse($Support.EmbedObj.eprops.icphoto)&&a.attendername?b.find(".cmplogo").attr("data-chttype","agent"):b.find(".cmplogo").removeAttr("data-chttype")},showBanner:function(a,b,c,d,e,f){if(a.length==0)return;var g=$Support.contentdiv,h=!1;g.find("#info_banr").length||(h=!0,g.prepend($Temp.getBannerHTML(a,b,e,f)),a=""),$Support.Util.showInfoBanner(a,b,h,c,d)},hideBanner:function(a){$Support.contentdiv.find("#info_banr").slideUp(500,function(){$(this).remove(),typeof a=="function"&&a()})},showTimerBanner:function(a){clearTimeout($Support.Util.bnrtimer),$Support.contentdiv.append($Temp.getTimerBannerHTML(a))},populateSendMail:function(a){var b=this,c=$Support.contentdiv,d=c.find(".txtarewrap");d=d.length?d:c.find(".chtlnks");var e=c.find("#smailbx");e.length||d.before(e=$($Temp.getSendMailHTML()));var f=$Support.EmbedObj.visitoremail||"";e.find("input").val(f),$Clickoutside.bindclick(function(){b.hideUtilityDiv(e)},"smailbx",a.attr("id"))},populateSendMailConfirm:function(a,b){var c=this,d=$Support.contentdiv,e=!1,f=d.find(".usrinpt"),g=d.find(".infomsg.chtend");f=f.length?f:g,f.hasClass("chtend")&&(f.hide(),e=!0);var h=d.find("#consentbannerdiv");h.attr("cattr")=="gtranslateconsent"&&(h.remove(),$Support.Util.calculateTextareaHeight(),h=d.find("#consentbannerdiv")),h.length||f.before(h=$($Temp.getSendMailConfimHTML(a,b))),$Support.Util.calculateTextareaHeight(),$Clickoutside.bindclick(function(){c.hideUtilityDiv(h,!0,e)},"consentbannerdiv","smailbx")},populateSmiley:function(a){Smiley.showSmileyList()},hideUtilityDiv:function(a,b,c){a.animate({bottom:"-60px",opacity:"0"},400,function(){a.remove(),b&&!c&&$Support.Util.calculateTextareaHeight();if(c){var d=$Support.contentdiv,e=d.find(".infomsg.chtend");e.show()}})},animateUtilityDiv:function(a){a.animate({bottom:"82%",opacity:"1"},400,function(){a.find("input").focus()})},showUserEditUI:function(a,b){var c=$Support.contentdiv.find(".editfields");if(c.length&&!c.hasClass("hidemaskanim"))return;$Support.contentdiv.find(".maskdiv").remove().end().prepend($Temp.getUserEditHTML(a)),$Support.EmbedObj.department==-1&&$UI.populateDropDown(),b||$Support.Util.handleCustomHTML(!0),$Support.Util.calculateTextareaHeight()},hideUserEditUI:function(){$Support.enableTextarea(),$UI.hideMaskDiv()},showWaitingUI:function(a){$Support.Util.removeSendClickAction(),this.showChatArea(a)},hideMaskDiv:function(){var a=$Support.contentdiv.find(".maskdiv").addClass("hidemaskanim");$Support.Util.removeDiv(a),$Support.contentdiv.removeClass("siq_popup")},showCaptcha:function(a){var b=CommonUtil.getCaptcha(a);if(b!=null){var c=$Support.contentdiv,d=$Temp.getCaptchaHTML(a),e=c.find(".maskdiv");e.length?e.html(d):c.prepend('<div class="maskdiv captcha">'+d+"</div>")}},hideCaptcha:function(){var a=$Support.contentdiv.find(".captcha").addClass("hidemaskanim");$Support.Util.removeDiv(a)},showChatArea:function(a){var b=$Support,c=b.container,d=b.EmbedObj,e=c.find("#msgdiv").find(".siq-user-message");if(e.length!=0&&d.chatID===-1&&b.istrigmsg){var f=e.html();f&&(d.pmsg=f+"<br>"+d.pmsg)}b.contentdiv.replaceWith(b.contentdiv=$($Temp.getChatAreaHTML())),b.chatdiv=$("#msgdiv"),b.chatmaindiv=$("#msgmaindiv"),b.composer=b.contentdiv.find("#msgarea"),b.chatWindowUICallBk(),b.Util.handleResize(),b.contentdiv=b.container.find(".content");var g=$Support.getBroadcastText();g?$UI.showBanner(DynamicMsg.fillValues(g)):a||($UI.showWaitingDialog(),b.container.find(".content").hide().fadeIn(1e3))},showWaitingDialog:function(){if(!$Support.waitingtime||$("#wait_div").length>0||$Support.isBotChat||$Support.proactive&&$Support.EmbedObj.chatID!=-1)return;clearTimeout($Support.Util.bnrtimer);var a={text:function(){$Support.contentdiv.prepend($Temp.getWaitingTextHTML()),$UI.wait_div=$("#wait_div")},video:function(){$(".content").prepend($Temp.getWaitingTextHTML()).animate({top:"auto"},400)}};return a[$Support.EmbedObj.waitaction]()},populateCWaitHandler:function(){var a=$Support.contentdiv;if($Support.cwaitmsg){var b=a.find("#cwaitmsg");if(b.length){b.html($Support.cwaitmsg);return}a.find("#info_banr").after($Temp.getWaitHandlerHTML())}},removeCWaitHandler:function(){$("#cwaitmsg").remove()},populateVisitorQuestion:function(){!$Support.proactive;var a=$Support.EmbedObj,b=a.visitorname,c=a.question,d=a.vwmsid;if($Support.istrigmsg||$Support.proactive)b=a.triggername,c=a.pmsg,d=-1;var e={sender:d,dname:b,msg:getEscapedText(c),isques:a.question};$("#msgdiv").append(this.getMsgHTML(e)),Message.presender=d,$Support.Util.setMessageClass()},getMsgHTML:function(a){return $Temp.getMsgHTML(a)},getInfoMsgHTML:function(a,b){return $Temp.getInfoHTML(a,b)},populateUserAction:function(){var a=$Support.contentdiv,b=$Support.EmbedObj;$UI.setSoundConfig(),a.find(".usractions").remove().end().find(".usrinpt").prepend($Temp.getUserActionsHTML());var c=a.find("#mraction li");c.length?c.length===1&&a.find("#moreaction").removeAttr("title").attr({documentclick:c.attr("documentclick"),"class":c.attr("class")}).html(c.children()):a.find("#moreaction").hide(),this.populateSendBtn(LSResource.getRealValue("ne.send")),$Support.Util.handleUnmute()},removeUserActions:function(){$Support.contentdiv.find(".usractions").remove().end()},getSoundHTML:function(a){var b=$Temp.getSoundHTML();return a&&(b=b.replace(/<li /g,"<span ").replace(/<\/li>/g,"</span>"),b=$(b).empty()),b},populateSmileyIcon:function(){$UI.removeSmileyIcon(),$Support.contentdiv.find("#smilelist").after($Temp.getSmileyIconHTML())},removeSmileyIcon:function(){$Support.contentdiv.find("#smiley").remove()},populateSendBtn:function(a){if($Support.isFAQEnabled())return;$("footer").find(".floatrg").remove().end().append($Temp.getSendBtnHTML(a))},handleOfflineStatus:function(a,b){var c=$Support,d=c.EmbedObj;c.contentdiv||$UI.init(a),b&&$Support.isOnlineChat()&&($UI.showBanner(c.getOfflineMessage(),!0,null),$("#msgarea").attr("placeholder",$Support.isFAQEnabled()?LSResource.getRealValue("ne.message.clicksubmit.icon"):LSResource.getRealValue("ne.message.clicksubmit")),$Support.isFAQEnabled()&&$("#msgarea").after($Temp.getSendIcon(!0))),c.contentdiv.find("#msgarea").attr("dockeyup","leavemessage").val(d.question!=null?d.question:$("#msgarea").val()).parents(".msgbox").addClass("posrel"),c.contentdiv.find("#msgarea").removeAttr("dockeydown"),this.populateSendBtn(LSResource.getRealValue("ne.submit")),c.contentdiv.find("#msgarea").val()!=""&&$("footer").find("em#sqico-send").attr("documentclick","leavemessage"),c.Util.setTextareaHeight()},handleMissedStatus:function(a){var b=$Support,c=b.composer||$("#msgdiv");c.removeAttr("disabled").attr("placeholder",$Support.isFAQEnabled()?LSResource.getRealValue("ne.missed.placeholder.icon"):LSResource.getRealValue("ne.missed.placeholder")),c.removeAttr("dockeydown"),a?$UI.showBanner(LSResource.getRealValue("ne.offlinemsg")):$UI.showBanner(DynamicMsg.fillValues(getUnescapedText(b.EmbedObj.missedmessage))),this.removeUserActions(),b.contentdiv.addClass("missed").find("#msgarea").attr("dockeyup","missedleavemsg"),this.populateSendBtn(LSResource.getRealValue("ne.submit")),$UI.updateCloseIcon()},populateFeedbackHTML:function(a){var b=$Support.contentdiv;b.find(".sqico-edit").remove();var c=JSON.parse($Support.EmbedObj.eprops.feedback[0]),d=$Support.israting,e=$Support.isfeedback;if(!c&&!d&&!e||d==0&&e==0){this.emptyFeedback();return}e==0&&($Support.isfeedbacksent=!0),$Support.contentdiv.removeClass("siq_popup").addClass("siq_popup");var f=$Support.israting===!1?$Temp.getFeedbackOnlyHTML():$Temp.getFeedbackHTML(!e);b.find(".maskdiv").remove().end().prepend(f),this.emptyFeedback();if(!e)return;this.handleFeedbackBtn()},handleFeedbackBtn:function(){this.populateSendBtn(LSResource.getRealValue("ne.submit")),$("footer #sqico-send").before('<em documentclick="hidefeedback" class="hidemask">'+LSResource.getRealValue("common.cancel")+"</em>")},emptyFeedback:function(){var a=$Support.contentdiv;a.find("div.usrinpt").remove(),$("footer #sqico-send").remove(),a.addClass("nofdbk"),$("#fdbkarea + .sqico-send").hide()},updateCloseIcon:function(){$Support.container.find(".sqico-min").replaceWith($Temp.getCloseHTML())},showFdbkResponse:function(){var a=document.getElementById("msgmaindiv");Message.scroll(a);if($Support.isfeedback){var b=$Support.EmbedObj.feedbackcomplete||LSResource.getRealValue("visitorchat.feedback.submit");$UI.showBanner(b,"psabs",!0)}this.feedbackAck()},feedbackAck:function(){$Support.Util.hideFeedback(),$Support.chatmaindiv.addClass("fdbalone"),$("#msgmaindiv").find('.vismsg [purpose="name"]').removeAttr("documentclick")},getInfoMsgContent:function(a,b,c){var d=Message.getInfoHTML(a,b,c);return d?this.getInfoMsgHTML(d):""},showDragDropUI:function(){var a=$("#dragmask");if(a.length){a.show();return}$Support.contentdiv.prepend($Temp.getDragDropHTML())},hideDragDrop:function(){$Support.contentdiv.find("#dragmask").hide()},getPreviewHTML:function(){return $Temp.getPreviewHTML()},notifyShareURL:function(a){var b={documentclick:"accepturl",attr:"url",value:a.msg};$UI.showBanner($Temp.getShareURLHTML(a),!1,null,null,!0,b)},displayInfo:function(a){$UI.showBanner(a)},getCustomHTML:function(a){var b=a.type||"text";if(/^(number|text|email|url|percentage|decimal)$/.exec(b))return $Temp.getCInputHTML(a);var c={checkbox:function(){return $Temp.getCCheckBxHTML(a)},radio:function(){return $Temp.getCRadioHTML(a)},selectbox:function(){return $Temp.getCDropDwnHTML(a)},textarea:function(){return $Temp.getCTextareaHTML(a)},label:function(){return $Temp.getCLabelHTML(a)}};return c[b]()||""},showUploadProgress:function(a){var b=$Support.EmbedObj,c=this,d=a.fileobj,e=a.msgid,f=d.name||a.filename,g=$('span[msgid="'+e+'"]'),h=b.vwmsid;if(!c["fileprg"+e]&&!g.length)c["fileprg"+e]=!0,$Support.Util.getFileURL(d,function(g){Message.display(c.getMsgHTML({sender:h,dname:b.visitorname,msg:{content:d.type},file:{size:d.size,purl:g,fName:f,progress:!0,msgid:e,comment:a.comment},previoussender:Message.presender&&Message.presender===h}),!0),$Support.Util.setMessageClass()});else{var i=a.prgval,j=parseInt(i.loaded/i.total*100),k=g.find(".file_prgs"),l=j/100*360;l>180&&k.addClass("gt50"),g.find(".size").html(getMemSize(i.loaded)+" of "+getMemSize(i.total)+" ("+j+"%)"),k.find(".pie:first-child").css({transform:"rotate("+l+"deg)","-webkit-transform":"rotate("+l+"deg)","-moz-transform":"rotate("+l+"deg)"})}},hideUploadProgress:function(a){var b=$('span[msgid="'+a+'"]'),c=b.find(".file_prgs");c.removeClass("gt50"),b.removeClass("fprgs");var d=b.find(".size");d.html(d.attr("size")),delete this["fileprg"+a]},updateParentFontFamily:function(){$Support.Util.updateParentFontFamily()},updateQuesArea:function(){this.populateSendBtn(),$Support.contentdiv.find(".msgbox").html($Temp.getQuesAreaHTML()),$Support.composer=$("#msgarea")},updateChatEndMsg:function(){$Support.chatmaindiv.addClass("chtcomp").after($Temp.getChatEndHTML())},updateVisitorName:function(a){var b=getEscapedText(a.name);b&&$Support.contentdiv.find('.vismsg div[purpose="name"]').html(b+'<em class="sqico-edit" documentclick="userdetails" title="'+LSResource.getRealValue("ne.title.edit")+'"></em>')},getBusinessHrInfo:function(){var a=$Support.EmbedObj;if(!a.bushrstatus)return"";var b=LSResource.getRealValue("ne.offlinemsg"),c=a.bushrtiming;if(!c)return b;var d={0:"Sunday",1:"Monday",2:"Tuesday",3:"Wednesday",4:"Thursday",5:"Friday",6:"Saturday"},e,f=!0;for(var g in c){var h=c[g];if(!h.length)continue;isUndefined(e)&&(e=g),c[e][0]!==h[0]&&(f=!1)}return $Temp.getBusnsInfoHTML(c[e][0])},setSoundConfig:function(){var a=$Support.EmbedObj,b=$Support.getCookieValue(a.chatID+"_sound");a.setSoundConfig(b)},addGroupIcon:function(){$Support.container.find("#complogo").after($Temp.getGroupIconHTML())},removeGroupIcon:function(){$Support.container.find("#complogo").next(".sqico-grpico").remove()},getCustomColor:function(){var a=$Support.EmbedObj.eprops,b=a.color[1].code,c=$Support.Util.getTextColor(b),d='<style id="zsiq_customcss"> header:before {border-color: '+b+" transparent transparent transparent; }"+"#conv-tab .siqc_eletype{ background-color: "+b+"; }"+".wincustom_bg:not(.cmplogo), .siqc_prochtcls:before, .vismsg .msgbx, .smile_list .siqsmile_li:hover, .smile_list .siqsmile_li.sel,#conv-tab.count .siqc_eletype , .gltr-srno:not(.gltr-no),.siqchat-detl.sqico-call, .gltr-done div {background-color: "+b+" !important;}"+".wincustom_clr, .sqico-chat2:before, .lstmsg_strs .sqico-star,.infomsg span:before,.infomsg span, .cmplogo span,.artcle-viewal, textarea + .sqico-send[documentclick]::before, header .sqico-clogo:before{ color:"+b+" !important; }"+".vismsg .msgbx span:FIRST-CHILD, .content .vismsg .time, .siqc_hstrycht .vismsg .time, .vismsg .msgbx *, .vismsg .sqico-close:BEFORE, .smile_list .siqsmile_li:hover, .smile_list .siqsmile_li.sel, .gltr-srno:not(.gltr-no), .zsiq_transferdiv .bot_opt.gltr-srno:not(.gltr-no){ color: "+c+" !important;}"+".msgbx a{ border-bottom-color: "+c+"}"+".file_prgs > .pie { border-color: "+b+"}"+"</style>";return d},getHeader:function(){return $Support.container.find("header")},getTranslateBannerHTML:function(a){return $Temp.getTranslateBannerHTML(a)}};(function(a){a.$Template=a.$Template||{},$Temp=$Template.theme1={getContainerHTML:function(){var a=($Support.isParentIframe()?"":" emfullwindow")+" emwin";return a+=$Support.isFAQEnabled()?" faq":"",['<section id="window-ribbon" themeid="1" class="siqembed siqc-convert outerwin'+a+$Support.getEmbedSizeClass()+'"></section>'].join("")},getHeaderHTML:function(a){var b=$Support.EmbedObj,c=JSON.parse(b.eprops.iclogo)?b.clogo+"?nps=404":"",d=a&&JSON.parse(b.eprops.icphoto)&&(a.attenderimagefkey||a.imagefkey||a.image_fkey)?$Support.Util.getPhotoURL():"",e=a&&a.attendername;c=e?d:c;var f=c?"":"nologo";e=getEscapedText(e||(b.status?LSResource.getRealValue("ne.chatwithus"):LSResource.getRealValue("ne.offlinemessage")));var g=$Support.isParentIframe(),h=getEscapedText(a&&a.aboutme||""),i=h?"":" noaboutme",j=!1;if(b.companywebsite){var k=b.companywebsite;j=!0}var l="",m=$Support.isSignature(b)?"":'<em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em>',n=$Support.isBotChat?'data-chttype="bot"':"";return['<header class="'+f+i+'" prop="header"><div class="posrel headercont">',g?'<div class="actbtn">'+l+m+"</div>":"",'<div class="cmplogo siq-company-logo" prop="clogo"'+n+'" >',j?'<a id="compurl" href="'+k+'" target="_blank">':"",$UI.getBotImageHTML(!$Support.isBotChat),'<span class="sqico-user"><img src="'+c+'" height="49" width="49" id="complogo" class="cmn_mdl siq-company-logo"/></span>',"</div>",j?"</a>":"",'<div class="siq-convback sqico-larrow" id="showsiqconv" documentclick="showconvlist" style="display:none;"></div>',"<div>",'<div class="txtelips siq-chat-attender-name" id="attname">'+e+"</div>",'<div class="txtelips fnt13 siq-about-me" id="attabtme" title="'+h+'">'+h+'</div><div id="attabtme"></div>',"</div></div>",CommonUtil.isAudioCallAllowed()?'<span class="siqchat-detl sqico-call" documentclick="audiocall" id="audiocall" style="display:none;" title="'+LSResource.getRealValue("audiovideo.audiocall")+'"></span>':"","</header>"].join("")},getBodyHTML:function(a,b){if(a)return'<section class="content siq_content"></section>';var c=$Support.EmbedObj,d=$Support.isSignature(c),e="content posrel siq_content";d&&(e+="algn_hgt ");var f=$Support.EmbedObj.status,g=c.eprops,h=c.pprops.chatcookiepolicyurl;return['<section class="'+e+'" purpose="outer">',JSON.parse(g.isname[0])?this.getNameHTML(g.isname[1].ismandatory):"",JSON.parse(g.isemail[0])?this.getEmailHTML(g.isemail[1].ismandatory):"",JSON.parse(g.isphoneno[0])?this.getPhoneHTML(g.isphoneno[1].ismandatory):"",c.department==-1||b?'<div id="sqico-drpdwn" class="sqico-drpdwn siq-dropdown" custom="department" info="department" data-validate="required"></div>':"",'<div class="msgbox" custom="question">',this.getQuesAreaHTML(f),f==0?this.getChatConsentHTML(h):"",this.getCampaignHTML(),"</div>","</section>"].join("")},getQuesAreaHTML:function(a){var b=a==0?$Support.isFAQEnabled()?LSResource.getRealValue("ne.message.clicksubmit.icon"):LSResource.getRealValue("ne.message.clicksubmit"):LSResource.getRealValue("ne.message.hitenter");return['<div class="posrel siq-message-area">','<textarea placeholder="'+b+'" class="msgarea siq-message-textarea" purpose="question" info="question" type="text" id="msgarea" dockeydown="textarea" dockeyup="textarea" data-validate="required charlimit 2048"></textarea>',this.getSendIcon(a==0)+"</div>"].join("")},getNameHTML:function(a,b){b=b||"";var c="optional",d="",e="";a==="true"&&(c="required",d=" ("+LSResource.getRealValue("ne.required")+")",e=' docblur="required"');var f=$Support.Util.isInValidVisitorName($Support.EmbedObj.visitorname)?"":$Support.EmbedObj.visitorname;return'<div custom="name"><input type="text" value="'+getEncodedText(f)+'" id="visname" placeholder="'+LSResource.getRealValue("ne.entername")+d+'" class="siq-input-text-box" '+e+b+' info="name" purpose="visitorname" data-validate="'+c+' charlimit 100"/>'+this.getRequiredHTML()+"</div>"},getEmailHTML:function(a){var b=a==="true"?"required":"optional",c=a=="true"?" ("+LSResource.getRealValue("ne.required")+")":"",d=$Support.EmbedObj.visitoremail||"";return['<div custom="email">','<input type="text" id="visemail" value="'+d+'" class="siq-input-text-box" placeholder="'+LSResource.getRealValue("ne.enteremail")+c+'" info="email" purpose="visitoremail" data-validate="'+b+' email charlimit 100" docblur="email" />'+this.getRequiredHTML(),this.getFetchMailHTML(),"</div>"].join("")},getFetchMailHTML:function(a){return $Support.EmbedObj.fetchid?'<div class="fetchmail" id="fetchmail"><span class="sqico-fb"></span><span class="sqico-gplus"></span></div>':""},getPhoneHTML:function(a){var b="optional",c="",d="";a==="true"&&(b="required",c=" ("+LSResource.getRealValue("ne.required")+")",d=' docblur="required"');var e=$Support.EmbedObj.visitorphone||"";return'<div custom="phone"><input type="text" value="'+e+'" class="siq-input-text-box" id="visphone" placeholder="'+LSResource.getRealValue("ne.enterphone")+c+'" class="" '+d+' info="phone" purpose="visitorphone"  data-validate="'+b+' phone"/>'+this.getRequiredHTML()+"</div>"},getCampaignHTML:function(){if(!$Support.Util.isCampaignEnabled())return"";var a=$Support.EmbedObj.integprops.integinfo[$Support.enabledCampaignID].subscribelabel||LSResource.getRealValue("embed.campaign.label");return['<div class="newsletter siq-newsletter txtelips" documentclick="newsletter">','<input type="checkbox" id="newsletter" name="Checkbox" />','<label for="newsletter" class="siq-checkbox-label txtelips" title="'+a+'"><span class="sqico-chkbx siq-checkbox"></span><em>'+a+"</em></label>","</div>"].join("")},getChatConsentHTML:function(a){if(!$Support.Util.getChatConsentStatus())return;var b=LSResource.getRealValue("common.gdpr.agent.offlineaccept2");a&&(a=a.indexOf("http")==-1?"http://"+a:a,b="<a class='siq-lnmor' target='_blank' href='"+a+"'>"+b+"</a>");var c=LSResource.getRealValue("common.gdpr.agent.offlineaccept1")+b;return c=$Support.Util.getOfflineAPIConsent(c),['<div id="offlineconsent" class="newsletter siq-newsletter">','<input type="checkbox" id="chatconsent" name="Checkbox" />','<label for="chatconsent" class="siq-checkbox-label txtelips" title=""><span class="sqico-chkbx siq-checkbox"></span>'+c+"</label>","</div>"].join("")},getChatAreaHTML:function(){var a=$Support.EmbedObj.messagehint,b=$Support.EmbedObj,c=$Support.isSignature(b),d=a?'placeholder="'+a+'"':'placeholder="'+LSResource.getRealValue("ne.message.hitenter")+'"';return['<section class="content chtanim siq_content'+(c?" algn_hgt":"")+'">','<div class="chtcont" id="msgmaindiv"><div class="disply_tbl"><div class="disply_cel" id="msgdiv">',"</div></div></div>",'<div class="usrinpt">','<div class="txtarewrap"><textarea '+d+' class="msgarea siq-message-textarea" id="msgarea" dockeydown="textarea" dockeyup="sendmessage"  data-validate="required"></textarea>'+this.getSendIcon()+'<div class="smile_list siq-smileys-section" id="smilelist" style="display: none;"></div></div>',"</div>","</section>"].join("")},getSendIcon:function(a){return!$Support.isFAQEnabled()||!$Support.Util.isHandHeldDevice()&&!a?"":'<span class="sqico-send siq-send-button" id="sqico-send" title="'+LSResource.getRealValue("embed.submit")+'"></span>'},getSmileyIconHTML:function(){var a=$Support.EmbedObj.eprops;return JSON.parse(a.showsmiley)?'<span class="sqico-smile" documentclick="smiley" id="smiley" title="'+LSResource.getRealValue("ne.title.emoji")+'"></span>':""},getUserActionsHTML:function(){var a=$Support.EmbedObj.eprops,b=$Support.EmbedObj.isBetaPortal;return['<div class="usractions clearfix">','<div class="txtelips siq-typing-message" id="typgstatus"></div>','<div class="floatrg usractico">','<span class="sqico-more siq-menu" documentclick="moreaction" id="moreaction" title="'+LSResource.getRealValue("ne.title.action")+'"></span>','<span class="sqico-end siq-end-chat-button" documentclick="chatend"  title="'+LSResource.getRealValue("ne.title.chatend")+'"></span>',"</div>",'<ul class="mraction" id="mraction">',CommonUtil.isAllowFileSharing()?'<li class="sqico-attach" documentclick="attachfile">'+this.getSendFileHtml()+LSResource.getRealValue("ne.action.attachfile")+"</li>":"",JSON.parse(a.icsound)&&EmbedSound.isPlayerEnable()?this.getSoundHTML():"",JSON.parse(a.icmail)?'<li class="sqico-smailico" documentclick="sendmail" id="sendmail">'+LSResource.getRealValue("ne.action.sendmail")+"</li>":"",JSON.parse(a.icprint)?'<li class="sqico-print" documentclick="printfile">'+LSResource.getRealValue("common.print")+"</li>":"",CommonUtil.isAllowAssist()&&!$Support.isBotChat?'<li class="sqico-share_screen" documentclick="sharedesktop" id="sharedesktop">'+LSResource.getRealValue("embed.desktop.sharing")+"</li>":"",CommonUtil.isScreenSharingAllowed()?'<li class="sqico-share_screen" documentclick="sharescreen" id="sharescreen">'+LSResource.getRealValue("embed.desktop.siqsharing")+"</li>":"","</ul>","</div>"].join("")},getSoundHTML:function(){var a=$Support.EmbedObj.soundval;return!isUndefined(a)&&a==-1?'<li class="sqico-unmute" documentclick="toggleaudio" title="'+LSResource.getRealValue("common.unmute.title")+'" purpose="sound">'+LSResource.getRealValue("ne.action.unmute")+"</li>":'<li class="sqico-mute" documentclick="toggleaudio" purpose="sound">'+LSResource.getRealValue("ne.action.mute")+"</li>"},getFooterHTML:function(){var a=$Support.Util.getFAQLabel();return['<footer class="clearfix">',$Support.EmbedObj.sm?'<div class="floatlf"><span class="sqico-fb"></span><span class="sqico-tweet"></span><span class="sqico-gplus"></span></div>':"",$Support.isAllowFreeLogo()?'<div class="flogo">'+LSResource.getRealValue("ne.freelogo",_FREELOGOLINK)+"  </div>":"",$Support.isFAQEnabled()?'<div class="faqdiv dsp_table"><div class="sel sqico-chat" id="conv-tab" documentclick="showconversation"><span clas="txtelips">'+LSResource.getRealValue("ne.conversation")+'</span><span class="disIB"><span class="siqc_eletype"></span></span></div><div class="sqico-faqico" id="faqtab" documentclick="showfaq">'+a+"</div></div>":"","</footer>"].join("")},getSendBtnHTML:function(a){return a=a||LSResource.getRealValue("ne.startchat"),'<div class="floatrg"><em class="sqico-send siq-send-button" id="sqico-send">'+a+"</em> </div>"},getBannerHTML:function(a,b,c,d){var e=b?"":" relate",f='<div class="info_banr'+e+' siq-info-banner" id="info_banr"';return c&&(f+='style="cursor:pointer;" documentclick="'+d.documentclick+'"'+d.attr+'="'+d.value+'"'),f+=">"+a+"</div>",f},getSendMailHTML:function(){return['<div class="semail sqico-smailico siq-send-email-section" id="smailbx">','<input type="text" class="siq-input-text-box siq-send-email-input" placeholder="'+LSResource.getRealValue("ne.action.enteremail")+'" info="email" data-validate="optional email" dockeyup="triggermail"/><em class="sqico-smail" documentclick="triggermail" title="'+LSResource.getRealValue("ne.action.sendmail")+'"></em>',"</div>"].join("")},getSendMailConfimHTML:function(a,b){var c=b||"";return['<div class="gltr-cont" id="consentbannerdiv" cattr="sendmailconfirm">','<span class="gltr-desc">'+LSResource.getRealValue("common.gdpr.emaildoubleoptin")+" "+"<em>"+a+"</em></span>",'<div class="gltr-done"><span class="gltr-srno" documentclick="triggermailconfirm" cattr='+a+" chid="+c+" >"+LSResource.getRealValue("common.yes")+'</span><span class="gltr-srno gltr-no" documentclick="triggermailconfirm" >'+LSResource.getRealValue("common.no")+"</span></div>","</div>"].join("")},getSmileyHTML:function(){var a='<div class="smileydiv" id="smileydiv">',b=Smiley.defaultsmileyobj;for(var c in b)a+='<div class="smlynone"><div title="'+b[c]+'" code="'+c+'" class="siqsly-'+b[c]+'"></div></div>';return a+="</div>",a},getUserEditHTML:function(a){var b=$Support,c=b.EmbedObj,d=c.eprops,e="",f=d.isname[1].ismandatory,g=d.isemail[1].ismandatory,h=d.isphoneno[1].ismandatory,i=a?LSResource.getRealValue("ne.update"):LSResource.getRealValue("common.continue");b.ismissed&&(i=LSResource.getRealValue("ne.submit"),g="true");var j=' onenter="updateuserdetails"';return['<div id="edituserdetails" class="chtcont maskdiv editfields">',JSON.parse(d.isname[0])?this.getNameHTML(f,j):"",JSON.parse(d.isemail[0])?this.getEmailHTML(g,j):"",JSON.parse(d.isphoneno[0])?this.getPhoneHTML(h,j):"",b.EmbedObj.department==-1?'<div id="sqico-drpdwn" tabindex="3" class="sqico-drpdwn siq-dropdown" info="department" data-validate="required"></div>':"",'<div id="usereditactionbtn" class="actionbtn">','<p id="continue_btn" data_isupdate="'+a+'" class="siq-update-button" documentclick="updateuserdetails" tabindex="-1" onenter="updateuserdetails">'+i+"</p>",'<p class="cancel siq-cancel-button" documentclick="hideuserdetails" >'+LSResource.getRealValue("common.cancel")+"</p>","</div>","</div>"].join("")},getCaptchaHTML:function(a){return["<div>","<div>"+LSResource.getRealValue("ne.captcha.title1")+"</div>","<p>"+LSResource.getRealValue("ne.captcha.title2")+"</p>","<div>"+CommonUtil.getCaptcha(a)+'<span class="sqico-captcha"  documentclick="captcha"></span></div>','<input type="text" class="siq-input-text-box" value="" purpose="'+a+'" dockeydown="captcha">','<div class="actionbtn">','<p documentclick="captcha">'+LSResource.getRealValue("ne.submit")+"</p>","</div>","</div>"].join("")},getWaitingTextHTML:function(){return['<div class="info_banr timer siq-info-banner" id="info_banr">','<span class="">'+DynamicMsg.fillValues($Support.EmbedObj.waitmsg)+"</span>",'<span class="sqico-timer siq-info-timer" id="wait_div">'+MyDate.formatMS($Support.waitingtime*1e3)+"</span>","</div>"].join("")},getMsgHTML:function(a){function p(a){var b=$Support.EmbedObj.eprops;if(!JSON.parse(b.showsmiley))return"";var c=document.createElement("DIV");c.innerHTML=Smiley.replace(a);var d=c.textContent||c.innerText;return d.trim()?"":" smily_msg"}var b=a.convvisitorid,c=Message.isLocalUser(a.sender)||b&&(a.sender=="null"||$Support.Util.isAnnonUser(a.sender)),d="agntmsg siq-agntmsg",e="siq-user-name",f="siq-user-message",g="";if(c||a.isques)d="vismsg siq-visitmsg",e="siq-visitor-name",f="siq-visitor-message";var h=$Support.EmbedObj.eprops,i=c&&!b?$Support.EmbedObj.visitorname||a.name:a.dname;i=getEscapedText(i);var j=a.msg;if(!a.file&&typeof j=="object")return"";a.iscannedarticle&&(d+=" msg-card");var k="",l='purpose="name"';if($Support.Util.isInValidVisitorName(i)||!i)i=LSResource.getRealValue("common.you");d.indexOf("vismsg")>-1&&(JSON.parse(h.isname[0])||JSON.parse(h.isemail[0])||JSON.parse(h.isphoneno[0]))&&!b&&($Support.waitTimer||(k='<em class="sqico-edit" title="'+LSResource.getRealValue("ne.title.edit")+'"></em>',g='documentclick="userdetails"'));var m='data-dname="'+getEncodedText(i)+'"';a.previoussender&&(d+=" mrgT2",i=k=l="");var n=a.time||"",o=a.uniqueid?a.uniqueid:a.msgid?a.msgid:"";o=a.file?a.file.msgid:o;var q=p(j),r=!c&&CommonUtil.isBot(a.sender)&&!a.previoussender?"<img class='vis_botimg' src='"+CommonUtil.getBotImageURL()+"' />":"",s="",t="";return a.file&&(s=" file_msg",t='isimage="'+(a.msg.content.indexOf("image")!=-1)+'"'),["<div "+(o?'id="'+o+'" msgid="'+a.sender+"_"+o+'"':"")+'" '+t+' class="'+d+q+s+'" data-field="message" '+m+">","<div "+l+' class="'+e+'" '+g+">"+r+i+""+k+"</div>",'<div class="msgbx">',a.file?this.getFileAttachHTML(a):'<span class="'+f+'">'+j+'</span><span class="time siq-message-time">'+n+"</span>","</div>","</div>"].join("")},getFileAttachHTML:function(a){var b=a.file,c=a.convvisitorid,d=a.convchid,e=a.msg.content.indexOf("image")!=-1,f=a.time||"",g=$Support.EmbedObj,h=b.fName||b.name;h=getEscapedText(h);var i=$Support.getAjaxURL("download",".ls");i+="?fsize="+b.size+"&url="+escape(b.url)+"&fName="+encodeURIComponent(h),c?i+="&visitorid="+c+"&chid="+d+"&isconversation=true":i+="&chid="+g.chatID+"&wmsid="+g.vwmsid;var j=b.purl||i,k=b.msgid||"",l=getMemSize(b.size),m=b.progress?'href="javascript:;" class="flprg"':'href="'+j+'"',n=b.progress?" fprgs":"",o=$.trim(b.comment)?"<code>"+getEscapedText(b.comment)+"</code>":"",p=o?" imgcmt":"";return['<span class="fileattch siq-file-attach'+n+p+'" msgid="'+k+'" data-ftype="'+a.msg.content+'" data-bubble="true">',e?'<img src="'+j+'" height="75" width="75" class="siq-attach-image">':"",'<span class="filedet" documentclick="imagepreview"><em class="txtelips">'+h+"</em>",'<em class="size" size="'+l+'">( '+l+" )</em></span>",this.getProgressHTML(b,j),e?'<em class="img_msk" data-bubble="true" documentclick="imagepreview"></em>':"","</span>"+Smiley.replace(o)+'<span class="time">'+f+"</span>"].join("")},getProgressHTML:function(a,b){var c=a.msgid||"";return b='<a target="_blank" class="fdload" href="'+b+'"><span class="sqico-dwnld siq-file-progress"></span></a>','<div class="file_alin"><div class="file_pmain"><div class="file_prgs" msgid="'+c+'">'+'<div class="pie"></div>'+'<div class="pie fill"></div>'+"</div>"+"</div>"+b+"</div>"},getInfoHTML:function(a,b){return b=b||"",'<div class="infomsg '+b+' siq-info-message">'+a+"</div>"},getFeedbackHTML:function(a){return['<div class="sqfdbk maskdiv siq-feedback-section" isonlyrating="'+a+'">','<div class="fdbk_cnt">',"<div>",'<div class="clblck">'+LSResource.getRealValue(a?"ne.rating.alone":"ne.rating")+"</div>",'<div class="rating">'+this.getStarHTML()+"</div>",'<div class="clblck fd-byline">'+LSResource.getRealValue("ne.rating.byline")+"</div>","</div>",a?"":'<textarea dockeyup="feedback" dockeydown="textarea" id="fdbkarea" class="siq-feedback-textarea" data-validate="required" placeholder="'+LSResource.getRealValue("ne.feedback.title")+'"></textarea>'+this.getSendIcon(),"</div>","</div>"].join("")},getFeedbackOnlyHTML:function(a){return['<div class="sqfdbk maskdiv fdbk_aln">','<div class="clblck">'+LSResource.getRealValue("ne.feedback")+"</div>",'<div class="fdbk_cnt">','<textarea dockeyup="feedback" dockeydown="textarea" id="fdbkarea" class="feedback-textarea" data-validate="required" placeholder="'+LSResource.getRealValue("ne.feedback.title")+'"></textarea>'+this.getSendIcon(),"</div>","</div>"].join("")},getStarHTML:function(a){var b="",c="",d=a!=undefined?"":'documentclick="rating"';for(var e=0;e<5;e++)c=e===a?" sel":"",b+='<span class="sqico-star'+c+' siq-rating-icon" '+d+"></span>";return b},getSendFileHtml:function(){var a=$Support.EmbedObj;return'<input name="file1" type="file" multiple size="1" class="embdinpfile" onchange="$Support.Util.submitFile(this, event);" id="embdfileupload" title="'+LSResource.getRealValue("chat.actions.filesharing")+'" onclick="this.value=\'\'"/>'},getDragDropHTML:function(){return'<div class="dragmask siq-dragdrop-mask" id="dragmask"><em>'+LSResource.getRealValue("ne.dropfile")+"</em></div>"},getShareURLHTML:function(a){var b=a.msg;return'<span class="shurl siq-share-url"><em class="txtelips">'+LSResource.getRealValue("ne.shareurl.desc",CommonUtil.getformattedtext(a.dname,20))+'</em></br><em class="txtelips" title="'+b+'">'+b+'</em></span><span class="sqico-surlico" title="'+LSResource.getRealValue("ne.shareurl.title")+'"></span>'},getPreviewHTML:function(){return['<div class="imgprev siq-image-preview" id="fileintex-FILEINDEX" purpose="fileupload">','<div class="cmtbx">','<div contenteditable="false"><input type="text" dockeydown="pasteimage" class="file-name" purp="name" data-validate="required"/></div>','<p id="pasteimage"></p>','<textarea id="pasteimgcomment" class="siq-comment-textarea" mcount="200" purp="comment" dockeyup="handlepasteimage" placeholder="'+LSResource.getRealValue("ne.imgcomment")+'"></textarea>','<em class="floatrg clr999 messagecount">200</em>',"</div>",'<div class="actionbtn">','<p class="siq-update-button" class="siq-update-button" documentclick="imgupload">'+LSResource.getRealValue("common.upload")+"</p>",'<p class="cancel siq-cancel-button" documentclick="imgcancel">'+LSResource.getRealValue("common.cancel")+"</p>","</div>","</div>"].join("")},getCCheckBxHTML:function(a){var b=a.options,c=getEscapedText(a.name)||"",d='<div custombx="true" customid="'+c+'">'+this.getCustomWrap(a);for(var e=0;e<b.length;e++){var f=b[e],g=getEscapedText(f.text),h=getEscapedText(f.value);d+="<div>",d+='<input type="checkbox" id="'+h+'" name="'+c+'" value="'+h+'">',d+='<label for="'+h+'" class="siq-checkbox-label"><span class="sqico-chkbx siq-checkbox"></span>'+g+"</label></div>"}return d+="</div></div>",d},getCRadioHTML:function(a){var b=a.options,c=getEscapedText(a.name)||"",d='<div custombx="true" customid="'+c+'">'+this.getCustomWrap(a);for(var e=0;e<b.length;e++){var f=b[e],g=getEscapedText(f.text),h=getEscapedText(f.value);d+="<div>",d+='<input type="radio" id="'+h+'" name="'+c+'">',d+='<label for="'+h+'"><span class="sqico-radio"></span>'+g+"</label></div>"}return d+="</div></div>",d},getCustomWrap:function(a){var b=a.options,c=getEscapedText(a.name)||"",d=JSON.parse(a.required)?this.getRequiredHTML("*"):"",e='<div class="subtitle">'+getEscapedText(a.hint)+d+"</div>";return e+='<div class="custombtn" purpose="custom" type="'+a.type+'"  visibility="'+a.visibility+'" custom="'+c+'" '+this.getCustomAttr(a)+' data-validate="">',e},getRequiredHTML:function(a){return a=a||"",'<em class="req siq-required" title="'+LSResource.getRealValue("ne.required")+'">'+a+"</em>"},getCInputHTML:function(a){var b=getEscapedText(a.name)||"",c=a.required?JSON.parse(a.required)?this.getRequiredHTML():"":"";return['<div custom="'+b+'" type="'+a.type+'" customid="'+b+'" custombx="true" >','<input type="text" class="siq-input-text-box" docblur="custominput" purpose="custom" visibility="'+a.visibility+'" '+this.getCustomAttr(a)+" >"+c,"</div>"].join("")},getCustomAttr:function(a){var b=a.options,c=getEscapedText(a.name)||"",d=getEscapedText(a.hint)||c,e=$.parseJSON(a.required)?"required":"optional",f=a.type?a.type:"text",g=a.maxlength||a.type=="url"||a.type=="textarea"?100:30,h=e+" "+f;return'placeholder="'+d+'" id="'+c+'" mandatory="'+a.required+'" custom="'+c+'" name="'+c+'" data-validate="'+h+'" autocomplete="off" maxlength="'+g+'" info="'+f+'"'},getCDropDwnHTML:function(a){var b=getEscapedText(a.name)||"";return'<div id="sqico-cdrpdwn'+a.index+'" class="sqico-drpdwn siq-dropdown" customid="'+b+'" custombx="true" custom="'+b+'" type="selectbox" visibility="'+a.visibility+'" purpose="custom" '+this.getCustomAttr(a)+"></div>"},getCTextareaHTML:function(a){var b=getEscapedText(a.name)||"",c=JSON.parse(a.required)?this.getRequiredHTML():"";return['<div custom="'+b+'" custombx="true" customid="'+b+'"  type="'+a.type+'"  visibility="'+a.visibility+'">','<textarea type="text" docblur="custominput" visibility="'+a.visibility+'" purpose="custom" '+this.getCustomAttr(a)+" ></textarea>"+c,"</div>"].join("")},getCLabelHTML:function(a){var b=getEscapedText(a.name)||"";return['<div class="subtitle" customid="'+b+'" custombx="true">'+getEscapedText(a.hint)+"</div>"].join("")},getCloseHTML:function(){return'<em class="sqico-close siq-close-icon" documentclick="close_iframe" title="'+LSResource.getRealValue("common.close")+'"></em>'},getChatEndHTML:function(){var a=$Support.EmbedObj;return['<div class="infomsg chtend siq-info-message">'+LSResource.getRealValue("ne.chatend",'documentclick="restartchat"'),'<div class="chtlnks">',JSON.parse(a.eprops.icmail)?'<a href="javascript:;" class="sqico-smailico" documentclick="sendmail" id="chatendmail" chid="'+a.chatID+'" visitorid="'+a.visitorID+'">'+LSResource.getRealValue("ne.email.transcript")+"</a>":"","</div>","</div>"].join("")},getBusnsInfoHTML:function(a){return["<div>"+LSResource.getRealValue("ne.offlinemsg")+"</div>","<div>"+LSResource.getRealValue("ne.busnshr")+' : <em class="fnt13">Monday to Friday '+a+"</em></div></div>"].join("")},getGroupIconHTML:function(){return'<span class="sqico-grpico"></span>'},getWaitHandlerHTML:function(){return['<div class="waitmsg" id="cwaitmsg">'+$Support.cwaitmsg,"</div>"].join("")},getConversationContainerHTML:function(){return['<section class="siqc_body sli_view siq_content" id="conversioncontainer" style="display:none;"><div id="currchatconv"></div><div id="pastchatconv"></div></section>'].join("")},getConversationHistoryHTML:function(a){var b=$Support.EmbedObj,c=a.attender_imgkey?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+a.attender_imgkey+"/photo.ls?nocache=1":"",d=a.attender,e="";!a.chid&&!a.attender?(d=LSResource.getRealValue("conversation.offlinechat"),e=" sqico-offline"):a.attender||(d=LSResource.getRealValue("conversation.missedchat"),e=" sqico-missed");var f=Message.getDisplayContent(a.question),g=!1,h="";if(a.lastmsg){var i=JSON.parse(a.lastmsg);g=$Support.Util.isAnnonUser(i.sender),i=i.msg;if(i){if(typeof i=="object")i.mode==="cannedarticle"?f=$FAQ.getHeaderMessage(i.msg):i.fName&&(f=i.fName,h=$Support.Util.getFileClassType(i.content));else{f=Message.getDisplayContent(i),f=Markdown.apply(f),f=Message.format(f);if(typeof i=="string")try{JSON.parse(JSON.parse(i).mode&&JSON.parse(i).mode==="AVCALL")&&(f=Message.getAVMessageBlock(JSON.parse(i),!0))}catch(j){}}f=h?'<em class="'+h+'">'+f+"</em>":f,f=g?LSResource.getRealValue("common.you")+": "+f:f}}return['<div class="siqc_cntbody" '+(a.chid?'chid="'+a.chid+'"':"")+' visitorid="'+a.visitorid+'" documentclick="fetchconvtranscript">','<div class="siqc_usrimg'+e+'">','<img class="'+(a.isbotattender?"conv_boticn":"")+'" src="'+c+'"><div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+getEncodedText(d)+"</span>",'<p id="desc7" class="siqc_cusmsg">'+f+"</p>","</div>",'<div id="status7" class="siqc_duration" convmtime="'+a.endtime+'">'+MyDate.timeDifference(a.endtime)+'<em class="siqc_eletype"></em></div>',"</div>"].join("")},getCallFAQHtml:function(){return'<div id="showsiqchatui" class="siqc_edt zsiq-faqcal textC" style="display:none;"><div class="siq-fcal sqico-bubchat" documentclick="showchatui"></div> <div class="siq-fcal sqico-call" onclick="CallImpl.startCall()"></div><div class="siq-fcal sqico-plus" ></div></div>'},getConversationCreateChatIConHTML:function(){return'<aside class="siqc_edt sqico-createchat wincustom_bg" id="showsiqchatui" documentclick="showchatui" title="'+LSResource.getRealValue("conversation.newconversation")+'" style="display:none;"></aside>'},getConversationTranscriptContainerHTML:function(){var a=$Support.EmbedObj,b=$Support.isSignature(a);return['<section class="siqc_hstrycht siq_content '+(b?" algn_hgt":"")+'" style="display:none;">',"</section>"].join("")},getLoadingHTML:function(){return'<div class="siqc-progress siqc-float siqc-shadow" id="convloadingui"><div class="siqc-progress-item"></div></div>'},getConversationListLoadingHTML:function(){return'<div class="siqc_cntbody siqc-loader" id="convlistloading"><div class="siqc-progress siqc-float"><div class="siqc-progress-item"></div></div></div>'},getchatWaitingUIinConversation:function(){var a=$Support.EmbedObj;return['<div class="siqc_cntbody" id="conv'+a.chatID+'" chid="'+a.chatID+'" visitorid="'+a.visitorID+'" documentclick="showchatui">','<div class="siqc_usrimg">','<img id="convchatattenderimg" src="">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span id="convchatattendername" class="txtelips"></span>','<p id="convmsg" class="siqc_cusmsg">'+getEscapedText(a.question)+"</p>","</div>",'<div class="siqc_duration"><em id="convwtime"></em><span><em class="siqc_eletype"></em></span></div>',"</div>"].join("")},getPopUpMessageInconversation:function(a,b,c){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui">','<div class="siqc_usrimg">','<img src="'+c+'">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+a+'</span><p id="desc1" class="siqc_cusmsg">'+b+"</p>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getPopUpAlertInconversation:function(a,b,c,d){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui">','<div class="siqc_usrimg">','<img src="'+d+'">','<div class="sqico-user convrstn-usr wincustom_bg"></div>',"</div>",'<div class="siqc_msg">','<span class="txtelips">'+a+'</span><p id="desc1" class="siqc_cusmsg">'+b+"</p>",'<div id="alerttimer" class="siqc_duration">'+c+"</div>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getPopUPInfoMessageInConversation:function(a){return['<div class="proactv_chat" id="convpopupmsg" documentclick="showchatui">','<div class="siqc_msg">','<p id="desc1" class="siqc_cusmsg">'+a+"</p>","</div>",'<em class="sqico-clear" id="removeconvpopup" documentclick="removeconvpopupmsg" title="'+LSResource.getRealValue("common.close")+'"></em>',"</div>"].join("")},getOutgoingcallUI:function(a,b){var c="",d="",e="";return a==null||a==""?e="<em class='sqico-person'></em>":(a=a.split("?")[0],c="<img src="+a+">"),b==null&&(b=""),['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof zsembd_calrng">','<div class="'+d+' sqico-personimg">',c,e,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+b+'<em class="txtelips font14">'+LSResource.getRealValue("av.info.calling")+"</em></span>",'<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)"></div>','<div class="sqico-call reject-cal" onclick="avimpl.terminateAudioCall();"></div></div>',"</div>"].join("")},getReconnectionUI:function(a,b){var c="",d="";return a==null||a==""?c="sqico-person":(a=a.split("?")[0],d="<img src="+a+">"),['<div class="zsembd_audiocl textC reconnect" id="call_reconnection">','<nav class="zsembd_usrprof">','<div class="'+c+' sqico-personimg">',d,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14">'+LSResource.getRealValue(b)+"</em></span>",'<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)"></div>','<div class="sqico-call reject-cal" onclick="avimpl.terminateAudioCall();"></div></div>',"</div>"].join("")},getUserBusyUI:function(a){var b="",c="";return a==null||a==""?b="sqico-person":(a=a.split("?")[0],c="<img src="+a+">"),['<div class="zsembd_audiocl textC" id="call_Busy">','<em class="sqico-close" onclick="avimpl.clear();"></em>','<nav class="zsembd_usrprof">','<div class="'+b+' sqico-personimg">',c,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14">'+LSResource.getRealValue("av.info.userbusy")+"</em></span>",'<div class="cal_actns">','<div class="sqico-record" onclick="avimpl.showAudioRecorder();"></div>','<div class="sqico-call" onclick="avimpl.startCall();"></div></div>',"</div>"].join("")},getAudioCallUI:function(a){var b="",c="";return a==null||a==""?c="<em class='sqico-person'></em>":(a=a.split("?")[0],b="<img src="+a+">"),['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof zsembd_calrng">','<div class="sqico-personimg">',b,c,"</div>","</nav>",'<span class="zsembd_adodesc txtelips"><em class="txtelips font14">'+LSResource.getRealValue("av.info.callfrom")+"</em>"+$Support.EmbedObj.attendername+"</span>",'<div class="cal_actns">','<div class="sqico-call" onclick="avimpl.acceptCallInvite();"></div>','<div class="sqico-call reject-cal" onclick="avimpl.rejectCallInvite();"></div></div>',"</div>"].join("")},getOnCallUI:function(a){var b="",c="";return a==null||a==""?b="sqico-person":(a=a.split("?")[0],c="<img src="+a+">"),['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof\t">','<div class="'+b+' sqico-personimg" >',c,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14" id="sqico-timer"></em></span>','<div class="cal_actns">','<div id="audiocall_mute" class="sqico-microphone" onclick="avimpl.toggleMute(this)"></div>','<div class="sqico-call reject-cal" onclick="avimpl.stopOngoingCall();"></div></div>',"</div>"].join("")},getStartRecordUI:function(a){var b="",c="",d="";return a==null||a==""?b="<img src="+a+">":d="<em class='sqico-person'></em>",['<div class="zsembd_audiocl textC">','<nav class="zsembd_usrprof">','<div class="'+c+' sqico-personimg">',b,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14" id="sqico-timer"></em></span>','<div class="embed-calrec"></div>','<div class="cal_actns">',"</div>"].join("")},getAudioRecordedUI:function(a){var b="",c="",d="";return a==null||a==""?b="<img src="+a+">":d="<em class='sqico-person'></em>",['<div class="zsembd_audiocl textC">','<em class="sqico-close" cntrl="cancelRecord"></em>','<nav class="zsembd_usrprof">','<div class="'+c+' sqico-personimg">',b,"</div>","</nav>",'<span class="zsembd_adodesc txtelips">'+$Support.EmbedObj.attendername+'<em class="txtelips font14" id="sqico-timer"></em></span>','<div class="embd-calrec" id="sqico-canvas"></div>','<div class="cal_actns">','<div class="sqico-record" cntrl="settings"></div>','<div class="sqico-play" cntrl="playRecord"></div>','<div class="sqico-videosend" cntrl="stopRecord"></div></div>',"</div>"].join("")},getTranslateBannerHTML:function(a){var b=a.length>40?'<div class="txtelips">'+a+" </div>":a+" ";return['<div class="gltr-cont" id="consentbannerdiv" cattr="gtranslateconsent" ><span class="gltr-desc">'+b+LSResource.getRealValue("common.gdpr.translatedesc")+"<em>"+" "+LSResource.getRealValue("common.gdpr.gtranslatehead")+'<div class="gltr-bgimg"></div></em></span>'+'<div class="gltr-done"><div documentclick="updatetranslatecookie" >OK</div></div>'+"</div>"].join("")}}})(window);function avimpl(){}function successCreateAnswer(a){avimpl.pc.setLocalDescription(a);var b=$Support.getAjaxURL("makeav",dext),c={};c.wmsid=$Support.EmbedObj.vwmsid,c.chid=$Support.EmbedObj.chatID,c.lsuid=$Support.EmbedObj.attender,c.session=CommonUtil.toJSON(a),c.type=a.type,c.version="v3",c.action="connectwithpeer",$.ajax({url:b,data:c,type:"POST"})}function sdrag(a,b){function g(a){if($(".zsembd_audiocl").css("left")<"0"||$(".zsembd_audiocl").css("top")<"0"){$(".zsembd_audiocl").css("left")<"0"?e.style.left="0px":"",$(".zsembd_audiocl").css("top")<"0"?e.style.top="0px":"",f=!1,window.removeEventListener("mousemove",g);return}if($(".zsembd_audiocl").css("right")<"0"||$(".zsembd_audiocl").css("bottom")<"0"){var b=a.pageX-c,h=a.pageY-d;e.style.left=b-10+"px",e.style.top=h-10+"px",f=!1,window.removeEventListener("mousemove",g);return}e.style.left=a.pageX-c+"px",e.style.top=a.pageY-d+"px"}function h(a){f=!0;var b=e.style.left?parseInt(e.style.left):$(".zsembd_audiocl").css("left").replace("px",""),h=e.style.top?parseInt(e.style.top):$(".zsembd_audiocl").css("top").replace("px","");c=a.pageX-b,d=a.pageY-h,window.addEventListener("mousemove",g)}var c=0,d=0,e=this,f=!1;this.addEventListener("mousedown",h),window.addEventListener("mouseup",function(a){!0===f&&(f=!1,window.removeEventListener("mousemove",g))})}avimpl.setCredentials=function(a){avaction.setCredentials(a),avimpl.avparams=["newcandidate","connection_estb","chid","wmsid","mutestate","reconnecttime","callincoming","mediaStream","curr_status"],avimpl.attenderimgurl=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+$Support.EmbedObj.attenderimagefkey+"/photo.ls?nps=404"},avimpl.showInvitation=function(a){avimpl.audiorecorder&&avimpl.audiorecorder.destroy();if(CallImpl.isCallWithChat){avimpl.curr_status="incomingcall",CallImpl.updateUI(AV_INCOMINGCALL),avimpl.acceptCallInvite("apicall");var b={attenderemail:$Support.EmbedObj.attenderemail};$Support.Util.handleCallbacks("call.attended",b);return}$Support?$Support.getParent().$ZSIQChatWindow.openChatWindow():$ZSIQChatWindow.openChatWindow(),avimpl.attenderimgurl=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+$Support.EmbedObj.attenderimagefkey+"/photo.ls?nps=404",Message.handleBlinkTitle(LSResource.getRealValue("av.info.call.tabinfo")),EmbedSound.play("incomingcall",60);var c=a.msg.sender,d=a.msg.receiver,e=a.msg.entityid;avimpl.agentID=a.msg.sender,$("#audiocall").addClass("cmn_disable"),avimpl.checkAndAppendUI($Temp.getAudioCallUI(avimpl.attenderimgurl)),avimpl.callincoming=!0,avaction.TYPE=a.msg.type,a.msg.type=="null"&&(avaction.TYPE="AUDIO"),a.msg.type==="SCREEN_SHARE"?avaction.TYPE="SCREEN_VIEW":a.msg.type==="SCREEN_VIEW"&&(avaction.TYPE="SCREEN_SHARE")},avimpl.acceptCallInvite=function(a){var b=$Support.EmbedObj.chatID;avimpl.callincoming=!1,$(".zsembd_audiocl").remove(),avimpl.checkAndAppendUI($Temp.getReconnectionUI(avimpl.attenderimgurl,"av.info.connecting")),avimpl.curr_status="connecting",CallImpl.updateUI(AV_CONNECTING);var c=$Support.getAjaxURL("makeav",dext),d={};d.chid=b,d.wmsid=$Support.EmbedObj.vwmsid,d.mode=AUDIOCALL,d.lsuid=$Support.EmbedObj.attender,a=="apicall"&&(d.department=$Support.EmbedObj.department),d.action="accepted",d.version="v3",$.ajax({url:c,data:d,type:"POST"}),EmbedSound.stop(),clearInterval(avimpl.intervaltime)},avimpl.handleCallTermination=function(){LSDebugger.postDebugInfo("Audio Call_v - inside handlecallterminated chatid "+avimpl.chid,null,null,!0),$(".zsembd_audiocl").remove(),$("#audiocall").removeClass("cmn_disable")},avimpl.rejectCallInvite=function(){EmbedSound.stop();var a=$Support.getAjaxURL("makeav",dext);$(".zsembd_audiocl").remove();var b={};b.chid=$Support.EmbedObj.chatID,b.wmsid=$Support.EmbedObj.vwmsid,b.mode=AUDIOCALL,b.lsuid=$Support.EmbedObj.attender,b.action="rejected",b.version="v3",$.ajax({url:a,data:b,type:"POST"}),$("#audiocall").removeClass("cmn_disable"),clearInterval(avimpl.intervaltime),avimpl.chid=avimpl.wmsid=avimpl.mutestate=avimpl.newcandidate=avimpl.connection_estb=null},avimpl.incrementRetryCount=function(){LSDebugger.postDebugInfo("Audio Call_v - inside Retry count | count "+avimpl.reconnect_count+"| chid |"+avimpl.chid,null,null,!0);if(avimpl.reconnect_count>2){avimpl.stopOngoingCall(),avimpl.clear();return}avimpl.reconnect_count++},avimpl.addAudioElemts=function(){avimpl.checkAndAppendUI($Temp.getReconnectionUI(avimpl.attenderimgurl,"av.info.connecting")),avimpl.curr_status="connecting",CallImpl.updateUI(AV_CONNECTING),EmbedSound.stop();if(avaction.TYPE!="VIDEO"){localAudio=document.createElement("audio");var a=document.createElement("div");a.id="zaudiodiv",a.style.position="relative",localAudio.id="localaudio",localAudio.autoplay=!0,a.appendChild(localAudio),$("body").append(a);return}var b=document.createElement("video"),c=document.createElement("div");c.id="zvideodivs",c.className="zvideodiv",c.style.position="relative",b.id="localvideo",b.autoplay=!0,b.src=window.URL.createObjectURL(avimpl.localStream),c.appendChild(b);var d=document.createElement("div");d.id="siqvideo",d.appendChild(c),$(window.parent.document).find("body").append(d),$(window.parent.document).find("#siqvideo").append("<em class='siqhdr_icon' id='siq_videomin'>-</em>"),$("#siq_videomin",parent.document).on("click",function(){$(window.parent.document).find("#siqvideo").toggleClass("siq_minvideo")})},avimpl.callConnected=function(){LSDebugger.postDebugInfo("Audio Call_v - inside call connected| chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime,null,null,!0),EmbedSound.stop(),avimpl.active=!0,avimpl.curr_status="ongoing",CallImpl.updateUI(AV_ONGOING),clearInterval(avimpl.reconnectinterval),clearInterval(avimpl.ApiCalltimer),$(".zsembd_audiocl").remove();if(avimpl.reconnecttime===0||avimpl.reconnecttime===null||avimpl.reconnecttime===undefined)avimpl.starttime=Date.now();avimpl.checkAndAppendUI($Temp.getOnCallUI(avimpl.attenderimgurl));if(avimpl.reconnecttime===undefined||avimpl.reconnecttime===null)avimpl.reconnecttime=0;avimpl.handleTimerUI(),avimpl.reconnecttime=0,avimpl.mutestate==0&&(avimpl.localStream.getAudioTracks()[0].enabled=!avimpl.localStream.getAudioTracks()[0].enabled,$("#audiocall_mute").removeClass("sqico-microphone").addClass("sqico-muteaudio")),clearTimeout(avimpl.timer),$Support.LSDB.remove("ZLD_ApiAVCall")},avimpl.callFailure=function(a){LSDebugger.postDebugInfo("Audio Call_v - inside call failure| chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime+" |type "+a,null,null,!0);var b={mandatory:{OfferToReceiveAudio:!0}};avimpl.handleCallTermination(),$(".zsembd_audiocl").remove(),avimpl.reconnecttime=(Date.now()-avimpl.starttime)/1e3,avimpl.checkAndAppendUI($Temp.getReconnectionUI(avimpl.attenderimgurl,"av.info.reconnecting")),avimpl.curr_status="reconnecting",CallImpl.updateUI(AV_RECONNECTING),a==UPSTREAM?(avimpl.reconnect_count=1,avimpl.pc.createOffer().then(avimpl.successOffer,avaction.sendLog,b),avimpl.reconnectinterval=setInterval(function(){avimpl.pc.createOffer().then(avimpl.successOffer,avaction.sendLog,b),avimpl.incrementRetryCount()},1e4)):setTimeout(function(){avimpl.stopOngoingCall(),avimpl.clear()},3e4)},avimpl.addcandidate=function(a){if(a.candidate){var b={};b.label=a.candidate.sdpMLineIndex,b.id=a.candidate.sdpMid,b.candidate=a.candidate.candidate,candstring=CommonUtil.toJSON(b);var c={};c.action="candidate",c.wmsid=$Support.EmbedObj.vwmsid,c.lsuid=$Support.EmbedObj.attender,c.chid=$Support.EmbedObj.chatID,c.candidate=candstring,c.version="v3",$.ajax({url:$Support.getAjaxURL("makeav",dext),data:c,type:"POST"})}},avimpl.addremotestream=function(a){try{if(avaction.TYPE=="AUDIO"||avaction.TYPE=="SCREEN_SHARE"){remoteAudio=document.createElement("audio");var b=document.getElementById("zaudiodiv");remoteAudio.id="remoteaudio",remoteAudio.autoplay=!0,b.appendChild(remoteAudio),$("body").append(b);var c=a.stream;a.streams&&(c=a.streams[0]),avimpl.hostbrowser==="Chrome"||avimpl.hostbrowser==="Firefox"?remoteAudio.src=window.URL.createObjectURL(c):remoteAudio.srcObject=c,avimpl.remoteStream=c;return}var c=a.stream;a.streams&&(c=a.streams[0]);var d=document.createElement("video"),e=document.createElement("div");e.id="zvideodiv",e.className="zvideodiv",e.style.position="relative",d.id="remotevideo",d.autoplay=!0,d.src=window.URL.createObjectURL(c),avimpl.remoteStream=c,e.appendChild(d);if(!$(window.parent.document).find("#siqvideo").length){var f=document.createElement("div");f.id="siqvideo",$(window.parent.document).find("body").append(f)}$(window.parent.document).find("#siqvideo").append(e)}catch(g){LSDebugger.postDebugInfo("Audio Call - Failed in Addremote session | Exception "+g+" | chid "+avimpl.chid,null,null,!0)}},avimpl.successOffer=function(a){avimpl.pc.setLocalDescription(a);var b=$Support.getAjaxURL("makeav",dext),c={};c.wmsid=$Support.EmbedObj.vwmsid,c.chid=$Support.EmbedObj.chatID,c.lsuid=$Support.EmbedObj.attender,c.session=CommonUtil.toJSON(a),c.type=a.type,c.version="v3",c.action="connectwithpeer",$.ajax({url:b,data:c,type:"POST"})},avimpl.toggleMute=function(a){var b=$(a);avimpl.localStream&&(avimpl.localStream.getAudioTracks()[0].enabled=!avimpl.localStream.getAudioTracks()[0].enabled),b.attr("class").indexOf("sqico-muteaudio")!==-1?(avimpl.mutestate=!0,$("#audiocall_mute").removeClass("sqico-muteaudio").addClass("sqico-microphone")):(avimpl.mutestate=!1,$("#audiocall_mute").removeClass("sqico-microphone").addClass("sqico-muteaudio"))},avimpl.stopOngoingCallOnChatEnding=function(){var a=document.querySelectorAll("#audio_callagain");for(var b=0;b<a.length;b++)a[b].style.display="none";$("#audiocall").css("display","none"),avimpl.hideCallIcon=!1;if(!avimpl.active){$(".zsembd_audiocl").remove(),avimpl.clear();return}avimpl.stopOngoingCall()},avimpl.stopOngoingCall=function(){if(!avimpl.active)return;var a={},b=$Support.getAjaxURL("makeav",dext);a.action="endcall",a.wmsid=$Support.EmbedObj.vwmsid,a.chid=$Support.EmbedObj.chatID,a.cuid=$Support.EmbedObj.visitorID,a.duration=Date.now()-avimpl.starttime,a.lsuid=$Support.EmbedObj.attender,a.version="v3",avimpl.showRejectedBanner(),$.ajax({url:b,data:a,type:"POST"}),LSDebugger.postDebugInfo("Audio Call_v - Stop on going call| chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime,null,null,!0),avimpl.clear()},avimpl.endOnReload=function(){var a={},b=$Support.getAjaxURL("makeav",dext);a.action="endcall",a.wmsid=$Support.EmbedObj.vwmsid,a.chid=$Support.EmbedObj.chatID,a.cuid=$Support.EmbedObj.visitorID,a.duration=Date.now()-avimpl.starttime,a.lsuid=$Support.EmbedObj.attender,a.version="v3",avimpl.showRejectedBanner(),$.ajax({url:b,data:a,type:"POST"}),avimpl.clear()},avimpl.startCall=function(){if($("#audiocall").hasClass("cmn_disable"))return;if(avaction.TYPE==="SCREEN_SHARE"&&window.webkitRTCPeerConnection){window.parent.$ZSIQUtil.getSourceID();return}avaction.checkMediaPermission()},avimpl.StartAfterMediaPermission=function(){var a=$Support.EmbedObj.chatID;avimpl.curr_status="outgoing",CallImpl.updateUI(AV_OUTGOINGCALL),EmbedSound.play("outgoingcall",60),avimpl.attenderimgurl=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+$Support.EmbedObj.attenderimagefkey+"/photo.ls?nps=404";var b={};b.wmsid=$Support.EmbedObj.vwmsid,b.chid=a,b.action="initiate",b.type=avaction.TYPE,b.mode=AUDIOCALL,b.cuid=$Support.EmbedObj.visitorID,b.lsuid=$Support.EmbedObj.attender,b.version="v3",$.ajax({url:$Support.getAjaxURL("makeav",dext),data:b,type:"POST"}),$Support.LSDB.remove("avcallstatus_"+a),$Support.LSDB.set("avcallstatus_"+a,!0,5e4),$("#audiocall").addClass("cmn_disable"),$(".zsembd_audiocl").remove(),avimpl.startTimer(),avimpl.checkAndAppendUI($Temp.getOutgoingcallUI(avimpl.attenderimgurl,$Support.EmbedObj.attendername))},avimpl.terminateAudioCall=function(a){var b={};b.mode=AUDIOCALL,b.lsuid=$Support.EmbedObj.attender,b.department=$Support.EmbedObj.department,b.wmsid=$Support.EmbedObj.vwmsid,b.chid=$Support.EmbedObj.chatID,a&&(b.isapicall=!0),b.action="terminated",b.version="v3",$.ajax({url:$Support.getAjaxURL("makeav",dext),data:b,type:"POST"}),$Support.LSDB.get("ZLD_ApiAVCall")&&($Support.LSDB.remove("ZLD_ApiAVCall"),$Support.requestRunning_missedvisitor=!1,clearTimeout($Support.waitTimer),clearTimeout(avimpl.ApiCalltimer),delete $Support.waitingtime,$Support.removeCookie("ZLD"+$Support.EmbedObj.livelsid+"WAITING"),$Support.handleMissed("CALLENDED","2",!0)),avimpl.curr_status=null,avimpl.clear(),$Support.LSDB.remove("avcallstatus_"+$Support.EmbedObj.chatID);var c={attenderemail:$Support.EmbedObj.attenderemail};$Support.Util.handleCallbacks("call.cancelled",c),CallImpl.updateUI(AV_CALLAGAIN)},avimpl.startTimer=function(){clearTimeout(avimpl.timer),avimpl.timer=setTimeout(function(){LSDebugger.postDebugInfo("Audio Call_v - Call missed | chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime,null,null,!0);var a=$Support.getAjaxURL("makeav",dext),b={};b.wmsid=$Support.EmbedObj.vwmsid,b.chid=$Support.EmbedObj.chatID,b.mode=AUDIOCALL,b.lsuid=$Support.EmbedObj.attender,b.action="missed",b.version="v3",$.ajax({url:a,data:b,type:"POST"}),avimpl.clear(),avimpl.handleUserBusy(),$Support.LSDB.remove("avcallstatus_"+$Support.EmbedObj.chatID)},5e4)},avimpl.handleUserBusy=function(){LSDebugger.postDebugInfo("Audio Call_v - Handle call busy| chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime,null,null,!0),CallImpl.updateUI(AV_USERBUSY),avimpl.curr_status="userbusy",EmbedSound.stop(),avimpl.checkAndAppendUI($Temp.getUserBusyUI(avimpl.attenderimgurl))},avimpl.showAudioRecorder=function(){document.querySelector(".zsembd_audiocl").remove();if(!avimpl.isAudioRecordingSupported()){avimpl.terminateAudioCall();return}avimpl.audiorecorder&&avimpl.audiorecorder.destroy(),avimpl.checkAndAppendUI($Temp.getAudioRecordedUI(avimpl.attenderimgurl)),avimpl.audiorecorder=Recorder("HeadShotAudioRecord"),avimpl.audiorecorder.init()},avimpl.isAudioRecordingSupported=function(){var a=!0;return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.AudioContext&&navigator.getUserMedia&&window.URL&&window.Worker||(support=!1),a},avimpl.showRejectedBanner=avimpl.endCall=avimpl.clear=function(){LSDebugger.postDebugInfo("Audio Call_v - Clear call| chid |"+avimpl.chid+" | reconect time "+avimpl.reconnecttime,null,null,!0);var a=function(a){var b=a.getTracks();for(var c in b)b[c].stop()};avimpl.pc?avimpl.pc.close():"",avimpl.localStream?a(avimpl.localStream):"",avimpl.remoteStream?a(avimpl.remoteStream):"",avimpl.mediaStream?a(avimpl.mediaStream):"",EmbedSound.stop(),$("#zaudiodiv").remove(),$(window.parent.document).find("#siqvideo").remove(),$("#call_reconnection").remove(),$(".zsembd_audiocl").remove(),$("#audiocall").removeClass("cmn_disable"),$Support.LSDB.remove("ZLD_ApiAVCall"),avimpl.active=!1,$Support.getParent().$ZSIQWidgetUI.removeCallUI(),$Support.LSDB.remove("av_call");for(i in avimpl.avparams)avimpl[avimpl.avparams[i]]=null;clearInterval(avimpl.intervaltime),clearInterval(avimpl.reconnectinterval),clearTimeout(avimpl.timer),clearTimeout(avimpl.ApiCalltimer),$Support.requestRunning_visitorfeedback=!1},avimpl.handleTimerUI=function(){avimpl.reconnecttime=isNaN(avimpl.reconnecttime)?0:avimpl.reconnecttime;var a=avimpl.reconnecttime,b=10,c,d;clearInterval(avimpl.intervaltime),avimpl.intervaltime=setInterval(function(){c=parseInt(a/60,10),d=parseInt(a%60,10),c=c<10?"0"+c:c,d=d<10?"0"+d:d;var b=document.querySelectorAll("#sqico-timer");for(var e=0;e<b.length;e++)b[e].textContent=c+":"+d;a++},1e3)},avimpl.checkAttenderBrowser=function(a){var b=$Support.EmbedObj.attenderuseragent;a&&(b=a.attender_useragent);if(!b)return!1;if(b.match(/Android/i)||b.match(/webOS/i)||b.match(/iPhone/i)||b.match(/iPad/i)||b.match(/iPod/i)||b.match(/BlackBerry/i)||b.match(/Windows Phone/i))return!0;if(b&&avaction.isBrowserSupported(b))return!0;$("#audiocall").remove()},avimpl.handleMinimizeState=function(){if(!avimpl.active&&!avimpl.callincoming){$Support.getParent().$ZSIQWidgetUI.removeCallUI();return}$Support.getParent().$ZSIQWidgetUI.updateCallUI(),avimpl.callincoming?$Support.getParent().$ZSIQWidgetUI.updateIncomingCallUI():$Support.getParent().$ZSIQWidgetUI.removeIncomingCallUI()},avimpl.checkMediaPermission=function(a,b){$Support.Util.displayInfo(a),setTimeout(function(){$("#info_banr").remove()},1e4),avimpl.clear(),avimpl.chid=b},Element.prototype.sdrag=sdrag,avimpl.checkAndAppendUI=function(a){CallImpl.isCallWithChat||($("body").append(a),document.getElementsByClassName("zsembd_audiocl")[0].sdrag())},avimpl.handleStartChat=function(a){CallImpl.isCallWithChat=!1;var b=JSON.parse(a.msg.msg);b.action==="startchat"&&!b.isvisitoraccess&&window.parent._ZSIQ.JSAPI.broadcastMessage("chatstart",{})},avimpl.checkOngoingCall=function(){$Support.LSDB.get("av_call")?($Support.LSDB.remove("av_call"),CallImpl.isCallWithChat=!0,$Support.quitChat()):$Support.LSDB.get("avcallstatus_"+$Support.EmbedObj.chatID)&&avimpl.terminateAudioCall(),avimpl.checkCallIcon()},avimpl.checkCallIcon=function(){if(avimpl.hideCallIcon){$("#audiocall").css("display","none");var a=document.querySelectorAll("#audio_callagain");for(var b=0;b<a.length;b++)a[b].style.display="none"}},avimpl.checkAudioCallButton=function(){var a=$Support.contentdiv.find("#msgmaindiv"),b=Object.keys(SUPPORT_REPS).length;a.length&&$Support.isChatExist()?$("#audiocall").show():$("#audiocall").hide()},avimpl.shareScreen=function(){avaction.TYPE="SCREEN_SHARE",this.startCall()};function CallImpl(){}var AV_INCOMINGCALL=1,AV_OUTGOINGCALL=2,AV_CONNECTING=3,AV_ONGOING=4,AV_RECONNECTING=5,AV_USERBUSY=6,AV_BODY=7,AV_CALLAGAIN=8,AV_RATING=9,AV_FDBCK=10,AV_FDBCKSUCCESS=11,AV_RATINGSUCCESS=12,AV_FDBKRATINGSUCCESS=13,AV_STARTRECORD=14,AV_RECORDING=15,AV_PLAY=16,AV_RECORDSENTSUCCESS=17,AV_DEPT=18,AV_MINIMIZE=1,AV_MAXIMIZE=2,AV_FEDBCK=3;CallImpl.updateUI=function(a,b){if(!this.isCallWithChat)return;switch(a){case AV_OUTGOINGCALL:CallUIHandler.getTemplate(AV_OUTGOINGCALL,AV_MINIMIZE);break;case AV_CONNECTING:CallUIHandler.getTemplate(AV_CONNECTING,AV_MINIMIZE);break;case AV_ONGOING:CallUIHandler.getTemplate(AV_ONGOING,AV_MINIMIZE);break;case AV_RECONNECTING:CallUIHandler.getTemplate(AV_RECONNECTING,AV_MINIMIZE);break;case AV_BODY:CallUIHandler.getTemplate(AV_BODY,AV_MAXIMIZE),$(".cal-bodycont").on("scroll",function(a){CallImpl.handlescroll()});break;case AV_USERBUSY:if(!avimpl.isAudioRecordingSupported()){avimpl.terminateAudioCall();break}CallUIHandler.getTemplate(AV_USERBUSY,AV_MINIMIZE),avimpl.audiorecorder?avimpl.audiorecorder.destroy():"",avimpl.audiorecorder=Recorder(),avimpl.audiorecorder.init();break;case AV_RATING:CallUIHandler.getTemplate(AV_RATING,AV_MINIMIZE);break;case AV_CALLAGAIN:CallUIHandler.getTemplate(AV_CALLAGAIN,AV_MAXIMIZE);break;case AV_RATINGSUCCESS:CallUIHandler.getTemplate(AV_RATINGSUCCESS,AV_MINIMIZE);break;case AV_FDBCK:CallUIHandler.getTemplate(AV_FDBCK,AV_FEDBCK),$(".cal-footer").on("keyup",function(){CallImpl.checkFeedbackMsgHgt()}).focus();break;case AV_FDBCKSUCCESS:CallUIHandler.getTemplate(AV_FDBCKSUCCESS,AV_MAXIMIZE);break;case AV_RECORDING:CallUIHandler.getTemplate(AV_RECORDING,AV_MINIMIZE,-1);break;case AV_PLAY:CallUIHandler.getTemplate(AV_PLAY,AV_MINIMIZE,-1);break;case AV_RECORDSENTSUCCESS:CallUIHandler.getTemplate(AV_RECORDSENTSUCCESS,AV_MINIMIZE,-1)}},CallImpl.handlescroll=function(){var a=$(".cal-bodycont").scrollTop();if($("#call_inptfields").height()+$(".dup_div").height()<a){$(".cal-deflnk").addClass("scrl_fix"),$(".adocal-cont").addClass("scrl_anim");return}$(".adocal-cont").css("padding-top",25-a/15+"px").removeClass("scrl_anim"),$(".cal-visimg ").css("height",60-a/7+"px").css("width",60-a/7+"px"),$(".cal-cmpname").css("font-size",20-a/35+"px"),$(".cal-deflnk").removeClass("scrl_fix"),CallImpl.getTheme()=="theme4"&&$(".thme-bgimg").css("height",60-a/5.8+"px")},CallImpl.handleDeptClick=function(a){$(".cal-bodycont").animate({scrollTop:$(".cal-bodycont").height()-$("#call_inptfields").height()+$(".cal-deflnk").height()+81},"500")},CallImpl.handleDeptSelect=function(a){if(!$(a).attr("status"))return a.title="Offline",!1;$Support.EmbedObj.department=a.id,$("#call_deptlist").children().removeClass("dep-sel"),a.className+=" dep-sel",$(".cal-bodycont").animate({scrollTop:$("#call_deptlist").height()+70},200),$("#dept_strtcall").removeClass("bg-grn").removeClass("bg-ddd").addClass("bg-grn")},CallImpl.startCall=function(){this.isCallWithChat=!0,this.updateUI(AV_BODY)},CallImpl.getAttenderImgHtml=function(){var a=$Support.EmbedObj.attenderimagefkey;return a&&a.split("_")[0]!=0?(a=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+a+"/photo.ls?nps=404",'<div class="cal-visimg "><img src='+a+"></div>"):'<div class="cal-visimg sqico-user"></div>'},CallImpl.compImgHtml=function(){var a=$Support.EmbedObj.clogo;return a?'<div class="cal-visimg "><img src='+a+"></div>":'<div class="cal-visimg sqico-user"></div>'},CallImpl.getCompImgHtmlCALFAQ=function(){return'<div class="faqcal-img"><img src='+$Support.EmbedObj.clogo+"></div>"},CallImpl.getAttenderImgCALFAQHtml=function(){var a=$Support.EmbedObj.attenderimagefkey;return a&&a.split("_")[0]!=0?(a=_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+a+"/photo.ls?nps=404",'<div class="faqcal-img"><img src='+a+"></div>"):'<div class="faqcal-img sqico-user"></div>'},CallImpl.checkAndStartCall=function(a){if($("#dept_strtcall").hasClass("bg-ddd"))return;var b=$("#call_inptfields");if(!$Support.Util.validateFields(b))return $(".cal-bodycont").animate({scrollTop:0},500),!1;$("#visname").val().trim()!=""?$Support.EmbedObj.visitorname=$("#visname").val():"",$("#visemail").val().trim()!=""?$Support.EmbedObj.visitoremail=$("#visemail").val():"",this.isCallWithChat=!0,CallImpl.updateUI(AV_OUTGOINGCALL),$Support.startChat()},CallImpl.checkFeedbackMsgHgt=function(){var a=$Support.container;$("#faqcall")&&(a=$("#faqcall"));var b=a.find(".cal-footer"),c=a.find("#fdbkarea");b.removeAttr("style");var d=c[0].scrollHeight+2,e=d>140?{height:"140px",overflow:"auto"}:d<70?{height:"70px",overflow:"auto"}:{height:d+"px",overflow:"hidden"};b.css(e)},CallImpl.getCompValueForKey=function(a){var b=window.parent.$ZSIQWidget.getEmbedObject().cinfo;return b[a]},CallImpl.isCallAloneEmbed=function(){return CallImpl.isCallWithChat},CallImpl.getAttenderName=function(){var a=$Support.EmbedObj.attendername;return a?a:""},CallImpl.handleSettingUI=function(a){if($("#audio_setting",parent.document).length>0){if($("#audio_setting",parent.document).css("display")==="none"){$("#audio_setting",parent.document).show();return}$("#audio_setting",parent.document).hide();return}avaction.displaySettingUI();return},CallImpl.getTheme=function(){var a=window.parent.$ZSIQWidget.getWidgetObject().calltheme;return a?a:(CallImpl.CALLFAQ=!0,"theme1")},CallImpl.getBackGndImg=function(a){if(this.getTheme()=="theme4"){var b=a=="Comp"?$Support.EmbedObj.clogo:_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+$Support.EmbedObj.attenderimagefkey+"/photo.ls?nps=404";return'<div class="thme-bgimg" style="background-image:url('+b+')"></div>'}return""},CallImpl.checkInputFields=function(){var a=$("#callfaq_inptfields");if(!$Support.Util.validateFields(a))return!1;$("#visname").val().trim()!=""?$Support.EmbedObj.visitorname=$("#visname").val():"",$("#visemail").val().trim()!=""?$Support.EmbedObj.visitoremail=$("#visemail").val():"",CallUIHandler.getTemplate(AV_DEPT,AV_MAXIMIZE)},CallImpl.checkDeptFields=function(){if(!$("#dept_strtcall").parent().hasClass("fcal-enb"))return;this.isCallWithChat=!0,CallImpl.updateUI(AV_OUTGOINGCALL),$Support.startChat()},CallImpl.handleFAQClick=function(a){$("body").find("#faqcall").remove(),a?$("body").append($Temp.getOnCallUI(avimpl.attenderimgurl)):"",$Support.container.find(".sqico-faqico").click(),document.getElementsByClassName("zsembd_audiocl")[0].sdrag()};function CallUIHandler(){}CallUIHandler.classmapp={},CallUIHandler.classmapp[AV_INCOMINGCALL]="",CallUIHandler.classmapp[AV_OUTGOINGCALL]="outcal",CallUIHandler.classmapp[AV_CONNECTING]="cal-recnct",CallUIHandler.classmapp[AV_ONGOING]="outcal",CallUIHandler.classmapp[AV_RECONNECTING]="cal-recnct",CallUIHandler.classmapp[AV_USERBUSY]="",CallUIHandler.classmapp[AV_RATING]="pL25",CallUIHandler.classmapp[AV_USERBUSY]="";var CALLALONE=1,CALLPLUSFAQ=2,CHATPLUSCALLPLUSFAQ=3;CallUIHandler.getTemplate=function(a,b,c){if(CallImpl.getTheme()=="FAQPLUSCALL"){$("body").find("#faqcall").length>0?$("body").find("#faqcall").replaceWith(this.getTempForCALLPLUSFAQ(a,CALLPLUSFAQ)):$("body").prepend(this.getTempForCALLPLUSFAQ(a,CALLPLUSFAQ));return}var d="";c==-1?d=$Support.container.find("#audiorec"):d=$Support.container.find("#audiocal"),d.replaceWith(this.mapTemp(a)),handleDrag(),setTimeout(function(){$(".zsembd_audiocl").hide()},1);switch(b){case AV_MINIMIZE:$Support.getParent().$ZSIQWidgetUI.handleMinimizeCall();break;case AV_MAXIMIZE:$Support.getParent().$ZSIQWidgetUI.handleMinCall();break;case AV_FEDBCK:$Support.getParent().$ZSIQWidgetUI.handlefbCall()}},CallUIHandler.mapTemp=function(a){return CallImpl.getTheme()=="theme5"?this.getTempForSignChat(a):CallUIHandler.classmapp.hasOwnProperty(a)?this.getTempForThemes(a):this.getRequiredHtml(a)},CallUIHandler.getRequiredHtml=function(a,b){var c="";switch(a){case AV_INCOMINGCALL:c=b==CALLPLUSFAQ?this.getFQCALINCallhtml():this.getIncommingCallHtml();break;case AV_OUTGOINGCALL:c=b==CALLPLUSFAQ?this.getFQCALOUTCallhtml():this.getOutgoingCallHtml();break;case AV_CONNECTING:c=b==CALLPLUSFAQ?this.getFQCALConnectingCallhtml():this.getConnectingHtml();break;case AV_ONGOING:c=b==CALLPLUSFAQ?this.getFQCALOnCallhtml():this.getOnGoingCallHtml();break;case AV_RECONNECTING:c=this.getReConnectingHtml();break;case AV_USERBUSY:c=b==CALLPLUSFAQ?this.getFQCALUserBusyhtml():this.getUserBusyHtml();break;case AV_RATING:c=b==CALLPLUSFAQ?this.getFQCALRatinghtml():this.getRatingHtml();break;case AV_BODY:c=b==CALLPLUSFAQ?this.getFQCALBodyhtml():this.getBodyHtml();break;case AV_DEPT:c=this.getFQCALDepthtml();break;case AV_CALLAGAIN:c=b==CALLPLUSFAQ?this.getFQCALCallAgainhtml():this.getCallCancelledHtml();break;case AV_RATINGSUCCESS:c=this.getRatingSuccessHtml();break;case AV_FDBCK:c=b==CALLPLUSFAQ?this.getFQCALFDBKhtml():this.getFdbkratingHtml();break;case AV_FDBCKSUCCESS:c=b==CALLPLUSFAQ?this.getFQCALFDBKSucesshtml():this.getFdbkSuccessHtml();break;case AV_RECORDING:c=b==CALLPLUSFAQ?this.getFQCALRecordhtml():this.getRecordingHtml();break;case AV_PLAY:c=b==CALLPLUSFAQ?this.getFQCALAVPlayhtml():this.getRecordAVPlayHtml();break;case AV_RECORDSENTSUCCESS:c=b==CALLPLUSFAQ?this.getFQCALRecordSuccesshtml():this.getRecordSuccessHtml()}return c},CallUIHandler.getTempForThemes=function(a){var b=a==AV_USERBUSY?"audiorec":"audiocal";return['<div class="cal-wrap" id="'+b+'"><div class="posrel dib-mid">','<div class="cal-widgt '+CallImpl.getTheme()+" "+CallUIHandler.classmapp[a]+'">','<div class="actbtn"><em class="sqico-min sqico-settings" id="call_stngicon" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div>',this.getRequiredHtml(a),"</div>","</div></div>"].join("")},CallUIHandler.getTempForSignChat=function(a){return['<div class="cal-wrap" id="audiocal"><div class="posrel dib-mid">','<div class="cal-widgt '+CallImpl.getTheme()+" "+CallUIHandler.classmapp[a]+'">','<div class="actbtn"><em class="sqico-min sqico-settings" id="call_stngicon" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div>',this.getRequiredHtml(a),"</div></div>"].join("")},CallUIHandler.getTempForCALLPLUSFAQ=function(a,b){return['<div class="faq-cal" id="faqcall"> <div class="fcal-actnbtn"> <em id="call_stngicon" class="sqico-settings dib-mid curP" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI()"></em> <em class="sqico-min siq-minimize-icon dib-mid curP" title="'+LSResource.getRealValue("common.minimize")+'" documentclick="min_iframe"></em> </div><div class="faqcal-wndw">',this.getRequiredHtml(a,b),"</div></div>"].join("")},CallUIHandler.getOutgoingCallHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+" </div> ",'<div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+CallImpl.getCompValueForKey("name")+'</nav> <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.calling")+"</p> </div>",' <div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true);"></span> </div>'].join("")},CallUIHandler.getIncommingCallHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+CallImpl.getAttenderName()+'</nav> <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.reconnecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> </div>'].join("")},CallUIHandler.getOnGoingCallHtml=function(){return[' <div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",' <div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+$Support.EmbedObj.attendername+'</nav> <p class="cal-usrdesc elips" id="sqico-timer">00:00</p> </div>',' <div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall();"></span> </div>'].join("")},CallUIHandler.getConnectingHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+CallImpl.getAttenderName()+'</nav> <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.connecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true)"></span> </div>'].join("")},CallUIHandler.getReConnectingHtml=function(){return['<div class="posrel usr-imginfo"> '+CallImpl.getAttenderImgHtml()+" </div>",'<div class="cal-vstrdetl"> <nav class="cal-actvevstr elips font18">'+CallImpl.getAttenderName()+'</nav> <p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.reconnecting")+"</p> </div> ",'<div class="cal-optns posrel textR"> <span id="audiocall_mute" class="sqico-microphone bg-aaa" onclick="avimpl.toggleMute(this)"></span> <span class="sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> </div>'].join("")},CallUIHandler.getUserBusyHtml=function(){return['<div class="posrel usr-imginfo">'+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><nav class="cal-actvevstr elips font18">'+LSResource.getRealValue("av.info.oprbusy")+'</nav><p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.voicemsg")+"</p></div>",'<div class="cal-optns posrel textR"><span cntrl="startRecord" class="sqico-record bg-aaa"></span></div>'].join("")},CallUIHandler.getRatingHtml=function(){return['<div class="posrel usr-imginfo">'+CallImpl.getAttenderImgHtml()+"</div>",'<div class="cal-vstrdetl textC"><nav class="cal-actvevstr elips font16">'+LSResource.getRealValue("av.info.rating")+'</nav><div class="rating font18">'+this.getStarHTML()+'</div><p class="elips c777 font14">'+LSResource.getRealValue("av.info.ratigclick")+"</p>","</div></div>"].join("")},CallUIHandler.getStarHTML=function(a){var b="",c="",d=a!=undefined?"":'documentclick="sendCallRating"';for(var e=0;e<5;e++)c=e===a?" sel":"",b+='<span class="sqico-star'+c+'" '+d+"></span>";return b},CallUIHandler.getCallCancelledHtml=function(){return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+'"> '+CallImpl.getBackGndImg("Comp")+'<div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+' <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc lH22 font14"></div> </div> </div>',' <div class="cal-bodycont posrel"> <p class="cal-weldesc lH22 c333">'+CallImpl.getCompValueForKey("desc")+'</p> <div class="sqico-call bg-grn mA" onclick="$Support.startChat()"></div> </div> </div> </div>'].join("")},CallUIHandler.getFdbkratingHtml=function(){return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' cal-oflne" style="height:354px;"> '+CallImpl.getBackGndImg()+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> <div class="posrel dib-mid"> '+CallImpl.getAttenderImgHtml()+'<em class="sqico-star usr-rtng"><em class="rtng-val">'+$Support.rating+'</em></em></div> <div> <div class="cal-cmpname font20 fontB">'+$Support.EmbedObj.attendername+"</div> </div> </div>",' <div class="cal-bodycont posrel"> <div class="ofln-msg mT5">'+LSResource.getRealValue("av.info.ratingsuccess")+'</div> </div> <div class="cal-footer" style="height:70px;"> <textarea class="bg-f6 font13 c333 lH20" dockeyup="feedback" dockeydown="textarea" id="fdbkarea" data-validate="required" placeholder="'+LSResource.getRealValue("av.info.fdkbckmsg")+'" autofocus></textarea> <div class="sqico-calsend fdbak-send msg-send" documentclick="sendCallFb"></div> </div> </div> </div>'].join("")},CallUIHandler.getFdbkSuccessHtml=function(){return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' cal-oflne"> '+CallImpl.getBackGndImg()+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> <div class="posrel dib-mid"> '+CallImpl.getAttenderImgHtml()+'<em class="sqico-star usr-rtng"><em class="rtng-val">'+$Support.rating+'</em></em></div> <div> <div class="cal-cmpname font20 fontB">'+$Support.EmbedObj.attendername+"</div> </div> </div>",' <div class="cal-bodycont posrel"> <div class="ofln-msg mT5">'+LSResource.getRealValue("av.info.ratingandfbk")+'</div> <div class="sqico-call bg-grn mT25 mA" onclick="$Support.startChat()"></div> </div> </div> </div>'].join("")},CallUIHandler.getRecordingHtml=function(){return['<div class="cal-wrap ado-rec" id="audiorec"><div class="cal-widgt '+CallImpl.getTheme()+'">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+'</div><div class="cal-vstrdetl"><p class="cal-vstmsg" id="sqico-timer">00:00:00</p><p class="cal-usrdesc elips">'+LSResource.getRealValue("av.info.recordingaudio")+"</p></div>",'<div class="vc-recrd pR10" id="sqico-canvas"></div><div class="cal-optns posrel textR"><div class="recd-optn" cntrl="stopRecord" ></div><em class="font14 rec-timer" id="sqico-remtimer">00:00</em></div></div></div>'].join("")},CallUIHandler.getRecordAVPlayHtml=function(){return['<div class="cal-wrap" id="audiorec"><div class="posrel dib-mid"><div class="cal-widgt '+CallImpl.getTheme()+'">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><div id="slide" ><div id="fill" style="width: 2px;"></div><div id="thumb" style="left: 0px;"></div></div><div class="cal-usrdesc mT5"><div cntrl="playRecord" class="sqico-play font12 mR10 curP"></div><div id="sqico-timer" style="display:inline;">00:00 / 00:00</div></div></div><div class="cal-optns posrel textR"><span class="sqico-record  bg-aaa font19" cntrl="startRecord"></span><span class="sqico-videosend bg-blue mL20" cntrl="uploadRecord"></span></div></div></div></div>'].join("")},CallUIHandler.getRecordSuccessHtml=function(){return['<div class="cal-wrap" id="audiocal"><div class="posrel dib-mid"><div class="cal-widgt '+CallImpl.getTheme()+' pL25">','<div class="actbtn"><em class="sqico-min sqico-settings" title="'+LSResource.getRealValue("common.settings")+'" onclick="CallImpl.handleSettingUI(this)"></em></div><div class="posrel usr-imginfo"> '+CallImpl.compImgHtml()+"</div>",'<div class="cal-vstrdetl"><p class="cal-vstmsg textC">'+LSResource.getRealValue("av.info.voicesent")+'</p></div><div class="cal-optns posrel textR"><span class="sqico-call cal-acpt" onclick="$Support.startChat()"></span></div></div></div></div>'].join("")},CallUIHandler.getBodyHtml=function(){var a=$Support.EmbedObj,b=$Support.EmbedObj.status,c=a.eprops,d=!0;return['<div class="cal-wrap" id="audiocal"> <div class="adocal-cont dtfix '+CallImpl.getTheme()+' ad-dep"> '+CallImpl.getBackGndImg("Comp")+' <div class="header"> <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("ne.title.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+' <div> <div class="cal-cmpname font20 fontB">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc font14">'+LSResource.getRealValue("av.info.welcomemsg")+"</div> </div> </div>",'<div class="cal-bodycont posrel"> <div class="vistr-dtlfld" id=call_inptfields>',JSON.parse(c.isname[0])?this.getNameHTML(c.isname[1].ismandatory):"",JSON.parse(c.isemail[0])?this.getEmailHTML(c.isemail[1].ismandatory):"",'</div> <div class="mT15">',$Support.EmbedObj.deptlist.length>1?' <div class="dup_div posrel mT20"><div class="cal-deflnk mT20 curP font16" onclick="CallImpl.handleDeptClick()">'+LSResource.getRealValue("av.info.deptchoose")+"</div></div>":'<div class="sqico-call bg-grn mA" onclick="CallImpl.checkAndStartCall()"></div>',$Support.EmbedObj.deptlist.length>1&&(a.department==-1||d)?this.getDeptList():"","</div></div> </div>"].join("")},CallUIHandler.getNameHTML=function(a,b){b=b||"";var c="optional",d="",e="";c="required",d=" ("+LSResource.getRealValue("ne.required")+")",e=' docblur="required"';var f=$Support.Util.isInValidVisitorName($Support.EmbedObj.visitorname)?"":$Support.EmbedObj.visitorname,g=f?"dN":"";return'<label class="posrel"><input onkeyup="CallUIHandler.handletextfiled(this)" type="text" value="'+getEncodedText(f)+'" id="visname" class="siq-input-text-box" '+e+b+' info="name" autofocus purpose="visitorname" data-validate="'+c+' charlimit 100"/><span class="ph-mntry '+g+'">'+LSResource.getRealValue("ne.entername")+""+this.getRequiredHTML()+'</span><em class="sqico-invalid" title="'+LSResource.getRealValue("ne.required")+'"></em></label>'},CallUIHandler.getEmailHTML=function(a){a="true";var b=a==="true"?"required":"optional",c=" ("+LSResource.getRealValue("ne.required")+")",d=$Support.EmbedObj.visitoremail||"",e=d?"dN":"";return['<label class="posrel"><input onkeyup="CallUIHandler.handletextfiled(this)" type="text" id="visemail" value="'+d+'" class="siq-input-text-box" info="email" purpose="visitoremail" data-validate="'+b+' email charlimit 100" docblur="email" /><span class="ph-mntry '+e+'">'+LSResource.getRealValue("ne.enteremail")+""+this.getRequiredHTML()+'</span><em class="sqico-invalid" title="'+LSResource.getRealValue("ne.required")+'"></em></label>',this.getFetchMailHTML()].join("")},CallUIHandler.handletextfiled=function(a){$(a).siblings("span").addClass("dN"),a.value==""&&$(a).siblings("span").removeClass("dN")},CallUIHandler.getPhoneHTML=function(a){var b="optional",c="",d="";a==="true"&&(b="required",c=" ("+LSResource.getRealValue("ne.required")+")",d=' docblur="required"');var e=$Support.EmbedObj.visitorphone||"";return'<div custom="phone"><input type="text" value="'+e+'" class="siq-input-text-box" id="visphone" placeholder="'+LSResource.getRealValue("ne.enterphone")+c+'" class="" '+d+' info="phone" purpose="visitorphone"  data-validate="'+b+' phone"/>'+this.getRequiredHTML("*")+"</div>"},CallUIHandler.getRequiredHTML=function(a){return a=a||"",'<em class="req siq-required" title="'+LSResource.getRealValue("ne.required")+'">*</em>'},CallUIHandler.getFetchMailHTML=function(a){return $Support.EmbedObj.fetchid?'<div class="fetchmail" id="fetchmail"><span class="sqico-fb"></span><span class="sqico-gplus"></span></div>':""},CallUIHandler.getDeptList=function(){var a="",b=$Support.EmbedObj.deptlist;for(i in b){var c=b[i].DNAME,d=b[i].STATUS;a+='<span class="depmnt-items font14 curP" onclick="CallImpl.handleDeptSelect(this)" status="'+d+'" id="'+b[i].ID+'">'+c+"</span>"}return['<div class="pL15" id="call_deptlist">',a,'</div> <div class="sqico-call bg-ddd mA mT25" id=dept_strtcall onclick="CallImpl.checkAndStartCall(this)"></div> '].join("")},CallUIHandler.getFQCALINCallhtml=function(){},CallUIHandler.getFQCALBodyhtml=function(){var a=$Support.EmbedObj,b=$Support.EmbedObj.status,c=a.eprops,d=!0;return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="faq-cal-sec font14"> <div class="vistr-dtlfld" id="callfaq_inptfields">',JSON.parse(c.isname[0])?this.getNameHTML(c.isname[1].ismandatory):"",JSON.parse(c.isemail[0])?this.getEmailHTML(c.isemail[1].ismandatory):"",'</div> <div class="faqcal-btn cfff curP" onclick="CallImpl.checkInputFields(this)">'+LSResource.getRealValue("av.info.deptchoose")+"</div></div>"].join("")},CallUIHandler.getFQCALDepthtml=function(){var a="",b=$Support.EmbedObj.deptlist;for(i in b){var c=b[i].DNAME,d=b[i].STATUS;a+='<span status="'+d+'" call-dept="" id="'+b[i].ID+'">'+c+"</span>"}return setTimeout(function(){$("#FQCLdeptlist").on("click","[call-dept]",function(){$("#FQCLdeptlist").find("[call-dept]").removeClass("fcal-sel"),$(this).addClass("fcal-sel"),$Support.EmbedObj.department=this.id,$("#dept_strtcall").parent().removeClass("fcal-dis").addClass("fcal-enb")})},2),['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="faqcal-sec font14 textL"><div class="fcal-dephed dib-mid">'+LSResource.getRealValue("av.info.deptchoose")+'</div><div class="fcal-dept mT15" style="" id="FQCLdeptlist">',a,'</div></div> <div class="fcal-btnoptn dib-mid mT25 fcal-dis"><span class="fcal-btns sqico-call" onclick="CallImpl.checkDeptFields(this)" id="dept_strtcall"></span> <div class="cddd textC mT10">'+LSResource.getRealValue("av.info.call")+"</div> </div>"].join("")},CallUIHandler.getFQCALOUTCallhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.calling")+"</p> </div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span id="audiocall_mute" onclick="avimpl.toggleMute(this)" class="fcal-btns sqico-microphone"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn dib-mid mT40"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true);"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALConnectingCallhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.connecting")+"</p> </div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-microphone" id="audiocall_mute" onclick="avimpl.toggleMute(this)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.terminateAudioCall(true)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALOnCallhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getAttenderImgCALFAQHtml()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+'</div> <p class="cfff lH22 font16 faqcal-desc" id="sqico-timer">00:00</p> </div>','<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-microphone" id="audiocall_mute" onclick="avimpl.toggleMute(this)"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.mute")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick(true)"></span> <div class="cfff textC mT10 fcal-txt" >'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call cal-rjct" onclick="avimpl.stopOngoingCall()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.end")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALRatinghtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",'<div class="fcal-fdback textC"><div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.rating")+'</div> <div class="rating mT30">'+this.getStarHTML()+'</div><p class="elips mT20 cfff font14">'+LSResource.getRealValue("av.info.ratingclick")+"</p>"].join("")},CallUIHandler.getFQCALFDBKhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl">'+CallImpl.getAttenderImgCALFAQHtml()+'<em class="sqico-star usr-rtng bg-999"><em class="rtng-val cfff">'+$Support.rating+'</em></em></div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",'<div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.ratingsuccess")+'</div><div class="cal-footer bgfff" style="height:70px;"> <textarea class="bgfff font13 c333 lH20" dockeyup="feedback" dockeydown="textarea" id="fdbkarea" data-validate="required" placeholder="'+LSResource.getRealValue("av.info.fdkbckmsg")+'" autofocus></textarea> <div class="sqico-calsend fdbak-send msg-send" documentclick="sendCallFb"></div></div>'].join("")},CallUIHandler.getFQCALFDBKSucesshtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getAttenderImgCALFAQHtml()+'</div><div class="font22 cfff faqcal-usr">'+CallImpl.getAttenderName()+"</div></div>",' <div class="ofln-msg mT25">'+LSResource.getRealValue("av.info.ratingandfbk")+' </div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.callback")+"</div></div>"].join("")},CallUIHandler.getFQCALCallAgainhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+CallImpl.getCompValueForKey("desc")+"</p> </div>",'<div class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></div>'].join("")},CallUIHandler.getFQCALUserBusyhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+LSResource.getRealValue("av.info.oprbusy")+' </div><p  class="cfff lH22 font16 faqcal-desc elips">'+LSResource.getRealValue("av.info.voicemsg")+"</p></div>",'<div class="dtfix w100"> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-record" cntrl="startRecord"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div> </div> <div class="fcal-btnoptn"> <span class=" fcal-btns sqico-faqico" onclick="CallImpl.handleFAQClick()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.faq")+'</div> </div> <div class="fcal-btnoptn"> <span class="fcal-btns sqico-call bg-grn" onclick="$Support.startChat()"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.callback")+"</div> </div> </div>"].join("")},CallUIHandler.getFQCALRecordhtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc" id="sqico-timer">00:00:00</p> </div>','<div class="dtfix w100"><div class="vc-recrd" id="sqico-canvas" style="margin:-30px;"></div><div class="posrel" id="faqrcd_play" style="display:none;"> <div class="fcal-btnoptn"><span class="fcal-btns sqico-record  bg-aaa font22" cntrl="startRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div></div> <div class="fcal-btnoptn"><span cntrl="playRecord" class="fcal-btns sqico-play"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.play")+'</div></div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-voicesend cal-send" cntrl="uploadRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.send")+'</div></div></div><div id="faqrcd"> <div class="fcal-btnoptn"><div class="rec-tmr font18 mB10" id="sqico-remtimer">00:00</div><span class="fcal-btns str-recd" cntrl="stopRecord"></span> <div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.stop")+"</div></div> </div></div>"].join("")},CallUIHandler.getFQCALAVPlayhtml=function(){return['<div class="faqcal-head"> <div class="posrel fcal-usrdetl">'+CallImpl.getCompImgHtmlCALFAQ()+'</div> <div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div><p id="sqico-timer" style="display:inline;">00:00</p></div>','<div class="cal-vstrdetl"><div class="vc-recrd" id="sqico-canvas" style="margin:-30px;"></div></div><div class="cal-optns posrel textR"> <div class="fcal-btnoptn"><span class="fcal-btns sqico-record  bg-aaa" cntrl="startRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.voicemsgtxt")+'</div></div> <div class="fcal-btnoptn"><span cntrl="playRecord" class="fcal-btns sqico-play"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.play")+'</div></div> <div class="fcal-btnoptn"><span class="fcal-btns sqico-voicesend cal-send" cntrl="uploadRecord"></span><div class="cfff textC mT10 fcal-txt">'+LSResource.getRealValue("av.info.send")+"</div></div></div></div></div></div>"].join("")},CallUIHandler.getFQCALRecordSuccesshtml=function(){return['<div class="faqcal-head"><div class="posrel fcal-usrdetl"> '+CallImpl.getCompImgHtmlCALFAQ()+' </div><div class="font22 cfff faqcal-usr">'+CallImpl.getCompValueForKey("name")+'</div> <p class="cfff lH22 font16 faqcal-desc">'+LSResource.getRealValue("av.info.voicesent")+"</p> </div>",'<div class="fcal-btns sqico-call bg-grn mT25" onclick="$Support.startChat()"></div>'].join("")},CallUIHandler.getInitialHtml=function(){return['<div class="cal-wrap" id="audiocal"><div class="adocal-cont '+CallImpl.getTheme()+'">'+CallImpl.getBackGndImg("Comp")+' <div class="header">',' <div class="actbtn"><em class="sqico-min siq-minimize-icon" title="'+LSResource.getRealValue("common.minimize")+'" documentclick="min_iframe"></em></div> '+CallImpl.compImgHtml()+" <div> ",'<div class="cal-cmpname font20 fontB elips" title="'+CallImpl.getCompValueForKey("name")+'">'+CallImpl.getCompValueForKey("name")+'</div> <div class="cal-cmpdesc"></div> </div> </div>','<section class="cal-bodycont"> <p class="cal-weldesc c333 lH22">'+CallImpl.getCompValueForKey("desc")+'</p> <div class="cal-deflnk lH22 dib-mid curP" onclick="CallImpl.startCall()">'+LSResource.getRealValue("av.info.callnow")+"</div> </section> </div> </div>"].join("")};var Recorder=function(){function W(a){var b=lamejs.WavHeader.readHeader(a),c=new Int16Array(a.buffer,b.dataOffset,b.dataLen/2);return X(b.channels,b.sampleRate,c)}function X(a,b,c){var d=[],e=new lamejs.Mp3Encoder(a,b,128),f=c.length,g=1152;for(var h=0;f>=g;h+=g){var i=c.subarray(h,h+g),j=e.encodeBuffer(i);j.length>0&&d.push(new Int8Array(j)),f-=g}var k=e.flush();return k.length>0&&d.push(new Int8Array(k)),new Blob(d,{type:"audio/mp3"})}"use strict";var a,b=60,c=0,d=4096,e=1,f,g,h,i,j,k,l,m=!0,n=!1,o,p,q=0,r,s,t,u,o,v=0,w=function(){},x=function(){},y=function(){},z=function(){},A=function(){if(!B()){P();return}F(),o={startRecord:I,stopRecord:J,pauseRecord:K,playRecord:L,uploadRecord:N,cancelRecord:P},CallImpl.isCallWithChat?H():(G(),I())},B=function(){var a=!0;return window.AudioContext=window.AudioContext||window.webkitAudioContext,window.URL=window.URL||window.webkitURL,navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,window.AudioContext&&navigator.getUserMedia&&window.URL&&window.Worker||(support=!1),a},C=function(){a.addEventListener("click",E)},D=function(){a.removeEventListener("click",E)},E=function(a){var b=a.target,c=b.getAttribute("cntrl");o[c]&&o[c](b)},F=function(){var a=URL.createObjectURL(new Blob(["( "+V+" )()"]),{type:"javascript"});f=new Worker(a),f.onmessage=function(a){a.data.key=="view"&&(k=a.data.value)}};z=function(a){var b=u[a];b.trigger.classList.add(b.add),b.trigger.classList.remove(b.remove),b.trigger.setAttribute("cntrl",b.cntrl)};var G=function(){a=document.querySelector(".zsembd_audiocl"),a.sdrag(),C(),s=a.querySelector("#sqico-timer");var d=a.querySelector("#sqico-canvas");d.innerHTML='<canvas id="level_audio2"></canvas>',d=d.querySelector("#level_audio2"),l={elem:d,ctx:d.getContext("2d"),step:-4,bufferLength:null,dataArray:null,stepincrement:2,waveTrigger:null,lineX:0};var e,f,g;e=a.querySelector('[cntrl="settings"]'),f=a.querySelector('[cntrl="playRecord"]'),g=a.querySelector('[cntrl="stopRecord"]'),u={start:{trigger:e,cntrl:"startRecord",add:"sqico-recorder",remove:"sqico-settings"},stop:{trigger:g,cntrl:"stopRecord",add:"sqico-chkbx",remove:"sqico-videosend"},setting:{trigger:e,cntrl:"settings",add:"sqico-settings",remove:"sqico-recorder"},play:{trigger:f,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause"},pause:{trigger:f,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play"},send:{trigger:g,cntrl:"uploadRecord",add:"sqico-videosend",remove:"sqico-chkbx"}},w=function(){q=0,z("setting"),u.play.trigger.style.display="none",z("stop"),bb(!0),c=b*100},x=function(){z("send"),u.play.trigger.style.display="inline-block",z("play"),z("start"),c=q,q=0},y=function(){a.remove()}},H=function(){a=document.querySelector("#audiorec"),a||(a=document.querySelector("#faqcall")),C(),w=function(){q=0,c=b*100,CallImpl.updateUI(AV_RECORDING),a=document.querySelector("#audiorec"),a||(a=document.querySelector("#faqcall")),s=a.querySelector("#sqico-timer"),t=a.querySelector("#sqico-remtimer");var d=a.querySelector("#sqico-canvas");if(CallImpl.getTheme()=="FAQPLUSCALL"){d.innerHTML='<canvas id="level_audio2" style="height:100px;width: 100%;"></canvas>',d=d.querySelector("#level_audio2"),l={elem:d,ctx:d.getContext("2d"),step:-4,bufferLength:null,dataArray:null,stepincrement:2,waveTrigger:null,lineX:0};var e,f,g;e=a.querySelector('[cntrl="settings"]'),f=a.querySelector('[cntrl="playRecord"]'),g=a.querySelector('[cntrl="stopRecord"]'),u={start:{trigger:e,cntrl:"startRecord",add:"sqico-recorder",remove:"sqico-settings"},stop:{trigger:g,cntrl:"stopRecord",add:"sqico-chkbx",remove:"sqico-videosend"},setting:{trigger:e,cntrl:"settings",add:"sqico-settings",remove:"sqico-recorder"},play:{trigger:f,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause"},pause:{trigger:f,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play"},send:{trigger:g,cntrl:"uploadRecord",add:"sqico-videosend",remove:"sqico-chkbx"}}}else d.innerHTML='<canvas id="level_audio"  style="height: 60px;width: 72px;padding: 10px 10px 10px 0px;" ></canvas>',d=d.querySelector("#level_audio"),l={elem:d,ctx:d.getContext("2d"),bufferLength:null,dataArray:null,waveTrigger:null,slider:null,lineX:0};C()},x=function(){function j(a){var b=d.offsetLeft-(f-a.clientX);if(b>l.slider.clientWidth-4||b<-4)return;d.style.left=b+"px",e.style.width=b+"px",q=c/parseInt(l.slider.clientWidth)*b,i&&(i.currentTime=h?q/200:q/100),f=a.clientX}function k(a){document.onmouseup=null,document.onmousemove=null,n&&i&&(bg(),i.play())}c=q,q=0;if(CallImpl.getTheme()=="FAQPLUSCALL"){$("#faqrcd_play").css("display",""),$("#faqrcd").css("display","none");return}CallImpl.updateUI(AV_PLAY),a=document.querySelector("#audiorec"),a||(a=document.querySelector("#faqcall")),C();var b=a.querySelector('[cntrl="playRecord"]');s=a.querySelector("#sqico-timer"),s.innerHTML="00:00 / "+bj(),l.slider=a.querySelector("#slide"),l.slider.style.cursor="pointer";var d=l.slider.querySelector("#thumb"),e=l.slider.querySelector("#fill"),f=0,g=avaction.getBrowserFromUserAgent(navigator.userAgent).split("-")[0],h=g=="Chrome"||g=="Opera";l.slider.onclick=function(a){var b=a.clientX-l.slider.getBoundingClientRect().left-5;if(b>l.slider.clientWidth-4||b<-4)return;d.style.left=b+"px",e.style.width=b+"px",q=c/parseInt(l.slider.clientWidth)*b,i&&(n?i.pause():"",i.currentTime=h?q/200:q/100,n?i.play():"")},d.onmousedown=function(a){a.stopPropagation(),f=a.clientX,document.onmouseup=k,n&&i&&(i.pause(),clearInterval(r)),document.onmousemove=j},u={play:{trigger:b,cntrl:"playRecord",add:"sqico-play",remove:"sqico-pause"},pause:{trigger:b,cntrl:"pauseRecord",add:"sqico-pause",remove:"sqico-play"}}},y=function(){CallImpl.updateUI(AV_RECORDSENTSUCCESS)}},I=function(){!n&&m&&(w(),f.postMessage({command:"clear"}),i=null,Q(),m=!1)},J=function(){m||(x(),h.close(),T(),f.postMessage({command:"getView"}),bb(!0),m=!0)},K=function(){i&&(n=!1,clearInterval(r),i.pause(),!CallImpl.isCallWithChat||CallImpl.getTheme()=="FAQPLUSCALL"?bb(!1):""),z("play")},L=function(){z("pause");if(i){n=!0,!CallImpl.isCallWithChat||CallImpl.getTheme()=="FAQPLUSCALL"?Y(Z,25):"",i.play(),bg();return}i=new Audio,n=!0,CallImpl.getTheme()=="FAQPLUSCALL"?Y(Z,25):"",M(),bg()},M=function(){var a=URL.createObjectURL(new Blob([k],{type:"audio/wav"}));i.src=a;if(!CallImpl.isCallWithChat){h=new AudioContext,h.resume();var b=h.createMediaElementSource(i);j=h.createAnalyser(),b.connect(j),j.connect(h.destination),Y(Z,25)}i.play()},N=function(){var a,b;D(),K(),y(),window.lamejs?(a=W(k),b=new File([a],"Audio.mp3",{type:"audio/mp3"})):(a=new Blob([k],{type:"audio/wav"}),b=new File([a],"Audio.wav",{type:"audio/wav"})),O(b)},O=function(a){LSDragDrop.pos=0,LSDragDrop.nooffiles=1,LSDragDrop.uploadFile($Support.EmbedObj.chatID,[a]),P()},P=function(){clearInterval(r),bb(!0),u=null,o=null,l=null,f&&(f.terminate(),f=null),h&&(h.state!="closed"&&h.close(),h=null),a?a.remove():"",avimpl.audiorecorder=null,avimpl.clear()},Q=function(){h=new AudioContext,h.resume(),f.postMessage({command:"setProperty",audioFormat:"audio/wav",bufferSize:d,channels:e,sampleRate:h.sampleRate}),navigator.getUserMedia({audio:!0,video:!1},R,U),D()},R=function(b){a.onclick||C(),v=h.currentTime,p=b;var c=h.createMediaStreamSource(b),e=c.context,f=(e.createScriptProcessor||e.createJavaScriptNode).call(e,d,2,2);j=h.createAnalyser(),f.onaudioprocess=S,c.connect(j),j.connect(f),f.connect(h.destination),!CallImpl.isCallWithChat||CallImpl.getTheme()=="FAQPLUSCALL"?Y(Z,25):Y(bd,50)},S=function(b){var c=[];bf(h.currentTime-v);for(var d=0;d<e;d++)c.push(b.inputBuffer.getChannelData(d));f.postMessage({command:"record",buffer:c})},T=function(){p&&(p.getTracks().forEach(function(a){a.stop()}),p=null)},U=function(){P()},V=function(){function h(){f=new Float32Array(a.length*c);var b=0,e=1,g=2;if(d==e)for(var h=0;h<a.length;h++)for(var i=0;i<c;i++)f[b++]=a[h][i];else if(d==g)for(var h=0;h<a.length;h+=g)for(var i=0;i<c;i++)f[b++]=a[h][i],f[b++]=a[h+1][i];return f}function i(a){function b(a,b,c){for(var d=0;d<c.length;d++,b+=2){var e=Math.max(-1,Math.min(1,c[d]));a.setInt16(b,e<0?e*32768:e*32767,!0)}}function c(a,b,c){for(var d=0;d<c.length;d++)a.setUint8(b+d,c.charCodeAt(d))}var f=new ArrayBuffer(44+a.length*2),g=new DataView(f);return c(g,0,"RIFF"),g.setUint32(4,36+a.length*2,!0),c(g,8,"WAVE"),c(g,12,"fmt "),g.setUint32(16,16,!0),g.setUint16(20,1,!0),g.setUint16(22,d,!0),g.setUint32(24,e,!0),g.setUint32(28,e*4,!0),g.setUint16(32,d*2,!0),g.setUint16(34,16,!0),c(g,36,"data"),g.setUint32(40,a.length*2,!0),b(g,44,a),g}var a=[],b="",c=0,d=2,e=0,f,g={record:function(b){a.push(b.buffer[0]),b.buffer[1]&&a.push(b.buffer[1])},getView:function(){postMessage({key:"view",value:i(h())})},setProperty:function(a){b=a.audioFormat,c=a.bufferSize,d=a.channels,e=a.sampleRate},clear:function(){a=[]}};self.onmessage=function(a){var b=a.data,c=b.command;g[c]&&g[c](b)}},Y=function(a,b){l.bufferLength=j.frequencyBinCount,l.dataArray=new Uint8Array(l.bufferLength),l.elem.style.backgroundColor="rgba(0,0,0,0)",l.waveTrigger&&clearInterval(l.waveTrigger),l.waveTrigger=setInterval(function(){requestAnimationFrame(a)},b)},Z=function(){j.getByteTimeDomainData(l.dataArray),bc(),m&&(l.lineX=l.elem.width/c*(c-1>q?q:0),_(l.ctx));var a=0;for(var b=0;b<l.bufferLength;b++){var d=l.dataArray[b]/128*(l.elem.height/10)*1.5;a=Math.max(a,d)}l.step+=l.stepincrement;var e=l.step;ba(a/1.5,e),ba(-a/1.5,e*1.5),ba(a/2,e*3)},_=function(a){a.beginPath(),a.moveTo(l.lineX-1,50),a.lineTo(l.lineX-1,100),a.stroke()},ba=function(a,b){var c=l.ctx,d=0,e=0,f=l.elem.width*1.5/10,g=a/(l.elem.height/6);g*=a,l.ctx.strokeStyle="rgb(35, 141, 233)",c.beginPath();while(d<l.lineX)e=l.elem.height/2+g*Math.sin((d+b)/f),c.lineTo(d,e),d+=1;c.stroke(),l.ctx.strokeStyle="white",c.beginPath();while(d<l.elem.width)e=l.elem.height/2+g*Math.sin((d+b)/f),c.lineTo(d,e),d+=1;c.stroke()},bb=function(a){l&&(l.waveTrigger&&clearInterval(l.waveTrigger),a&&(l.lineX=0))},bc=function(){l.ctx.lineWidth=1.5,l.ctx.clearRect(0,0,l.elem.width,l.elem.height),l.ctx.fillStyle="rgba(100,100,100,0)",l.ctx.fillRect(0,0,l.elem.width,l.elem.height),l.ctx.moveTo(0,l.elem.height/2)},bd=function(){var a=l.ctx,b,c=l.dataArray,d=l.bufferLength,e=l.elem.width,f=e/36,g=l.elem.height,h=0;j.getByteFrequencyData(l.dataArray);var i=CallImpl.getTheme();a.fillStyle=i=="theme3"?"rgb(51, 51, 51)":"rgb(255,255,255)",a.fillRect(0,0,e,g);var k=f/4;for(var m=18;m>=0;m--){var n=m>9?18-m:m;b=c[n];var o=g/b;o<1&&b!=0&&(b=g*o),a.fillStyle=i=="theme3"?"white":"rgb(73, 113, 127)",a.lineJoin="round",a.lineWidth=k,a.fillRect(h+k/2,(g-b)/2+k/2,f-k,b-k),h+=2*f}},be=function(){var a=parseInt(l.slider.clientWidth)/c*(c-1>q?q:0);if(a>l.slider.clientWidth-4)return;l.slider.children[1].style.left=a+"px",l.slider.children[0].style.width=a+"px"},bf=function(a){q=parseInt(a*100);var b=parseInt(q/100),d=parseInt(b/60);if(q>=c){q=c,bi(q%100,b%60,d),J();return}bi(q%100,b%60,d)},bg=function(){clearInterval(r),r=setInterval(function(){var a=parseInt(q/100),b=parseInt(a/60);bi(q%100,a%60,b);if(q>=c){bh();return}q++},10)},bh=function(){clearInterval(r),bb(),q=0,n=!1,z("play"),CallImpl.isCallWithChat?s.innerHTML="00:00 / "+bj():""},bi=function(a,b,c){var d=CallImpl.isCallWithChat?bj():"";s.innerHTML=(c<10?"0"+c:c)+":"+(b<10?"0"+b:b),d&&m&&l.slider?(s.innerHTML+=" / "+d,be()):s.innerHTML+=":"+(a<10?"0"+a:a),d&&!m?t.innerHTML=d:""},bj=function(){var a=parseInt(c/100)-parseInt(q/100),b=parseInt(a/60);return a%=60,(b<10?"0"+b:b)+":"+(a<10?"0"+a:a)},bk={init:function(){A()},destroy:function(){P()},isAudioRecordingSupported:function(){return B()}};return bk};function avaction(){}function mediafailureoffer(a,b){if(!a||!a.name){avimpl.StartAfterMediaPermission();return}if(a.name==="NotAllowedError")return;var c="";switch(a.name){case"NotFoundError":case"DevicesNotFoundError":message=LSResource.getRealValue("av.info.microphone.notavailable");break;case"SourceUnavailableError":case"PermissionDeniedError":case"SecurityError":default:message=LSResource.getRealValue("av.info.microphone.blocked")}avimpl.checkMediaPermission(message,avimpl.chid),b?avimpl.rejectCallInvite(avimpl.chid,null):"",LSDebugger.postDebugInfo("Audio Call - Inside Filure media | PeerConnection "+avimpl.pc,null,null,!0)}avaction.TYPE="AUDIO",avaction.supportedbrowsers=["Chrome","Firefox","Opera","Safari","Edge"],avaction.getScreenID=function(){return window.webkitRTCPeerConnection?'{"mandatory": { "chromeMediaSource": "desktop", "maxWidth": 1920, "maxHeight": 1080, "minAspectRatio": 1.77 }, "optional": [] }':'{"mediaSource":"screen"}'},avaction.constraints={AUDIO:{audio:!0,video:!1},VIDEO:{audio:!0,video:!0},SCREEN_SHARE:{audio:!1,video:JSON.parse(avaction.getScreenID())},SCREEN_VIEW:{audio:!0,video:!1}},avaction.init=function(a){a.msg.cbtype==="credential"&&avimpl.setCredentials(a),a.msg.cbtype==="invite"&&(a.msg.credential&&avimpl.setCredentials(a),avimpl.showInvitation(a)),a.msg.cbtype==="accept"&&this.requestStream(a,UPSTREAM),a.msg.cbtype==="reject"&&(avimpl.showRejectedBanner(a),avimpl.handleUserBusy()),a.msg.cbtype==="candidate"&&(avimpl.connection_estb?avaction.addIceCandidate(a):(avimpl.newcandidate||(avimpl.newcandidate=[]),avimpl.newcandidate.push(a)));if(a.msg.cbtype==="answer"){var b=JSON.parse(a.msg.answer);avimpl.pc.setRemoteDescription(new RTCSessionDescription(b)),avimpl.connection_estb=!0;if(avimpl.newcandidate)for(var c in avimpl.newcandidate)avaction.addIceCandidate(avimpl.newcandidate[c]);avimpl.pc.onaddstream=avimpl.pc.ontrack=function(a){if(avimpl.remoteStream&&avimpl.remoteStream.active)return;avimpl.addremotestream(a)}}a.msg.cbtype==="endcall"&&avimpl.endCall(),a.msg.cbtype==="offer"&&this.requestStream(a,DOWNSTREAM)},avaction.setNRSServers=function(a){this.NRSServers=a},avaction.setCredentials=function(a){avaction.setNRSSereverUrls(a.msg.username,a.msg.credential),avimpl.chid=a.msg.entityid},avaction.setNRSSereverUrls=function(a,b){this.NRSServers||(this.NRSServers=_STUN_TURN_URLS);var c=this.NRSServers.split(","),d={iceServers:[]};for(var e in c)d.iceServers.push({urls:c[e],username:a,credential:b});avimpl.iceServerlist=d,LSDebugger.postDebugInfo("Audio Call - Ice Servers "+avimpl.iceServerlist+" | Server urls "+this.NRSServers,null,null,!0)},avaction.requestStream=function(a,b){if(!avimpl.iceServerlist){LSDebugger.postDebugInfo("Audio Call - End on reload| chid |"+avimpl.chid+" | Data "+a+" |type "+b,null,null,!0),avimpl.endOnReload();return}LSDebugger.postDebugInfo("Audio Call - chat id after ice servers"+a.msg.uid+" | type "+b,null,null,!0),avimpl.getMediaApi=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null;if(!avimpl.getMediaApi)return;window.webkitRTCPeerConnection?(avimpl.hostbrowser="Chrome",window.RTCPeerConnection=webkitRTCPeerConnection):window.mozRTCPeerConnection&&(avimpl.hostbrowser="Firefox",window.RTCPeerConnection=mozRTCPeerConnection),avimpl.chid=a.msg.entityid;if(avimpl.mediaStream){var c=avimpl.mediaStream;b==UPSTREAM?avaction.initializeConnection(c,b):b==DOWNSTREAM&&(avimpl.offer=CommonUtil.parseToJSON(a.msg.offer),avaction.initializeConnection(c,b));return}avimpl.getMediaApi.call(navigator,avaction.constraints[avaction.TYPE],function(c){b==UPSTREAM?avaction.initializeConnection(c,b):b==DOWNSTREAM&&(avimpl.offer=CommonUtil.parseToJSON(a.msg.offer),avaction.initializeConnection(c,b))},function(a){mediafailureoffer(a,b)})},avaction.initializeConnection=function(a,b){var c={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}};avimpl.pc=new RTCPeerConnection(avimpl.iceServerlist),avimpl.localStream=localStream=a,avimpl.pc.addStream(a),LSDebugger.postDebugInfo("Audio Call - Added local Stream | Stream "+a+" | PeerConnection "+avimpl.pc+" type "+b,null,null,!0),b==DOWNSTREAM&&avimpl.pc.setRemoteDescription(new RTCSessionDescription(avimpl.offer)),avimpl.connection_estb=!0;if(avimpl.newcandidate)for(var d in avimpl.newcandidate)avaction.addIceCandidate(avimpl.newcandidate[d]);LSDebugger.postDebugInfo("Audio Call - Added candidate in Queue | avmpl.newcandidate "+avimpl.newcandidate+" | PeerConnection "+avimpl.pc+" | connectionstate "+avimpl.connection_estb,null,null,!0),avimpl.pc.onicecandidate=function(a){avimpl.addcandidate(a)},avimpl.pc.onaddstream=avimpl.pc.ontrack=function(a){if(avimpl.remoteStream&&avimpl.remoteStream.active)return;avimpl.addremotestream(a)},LSDebugger.postDebugInfo("Audio Call - Added onicecandidate and onaddstream | Stream "+a+" | PeerConnection "+avimpl.pc+" type "+b,null,null,!0),avimpl.addAudioElemts(),b==UPSTREAM?avimpl.pc.createOffer().then(avimpl.successOffer,avaction.sendLog,c):(avimpl.hostbrowser==="Firefox"&&(c=c.mandatory),avimpl.pc.createAnswer(avimpl.successOffer,avaction.sendLog,c)),avimpl.pc.oniceconnectionstatechange=function(a){var c=avimpl.pc.iceConnectionState;LSDebugger.postDebugInfo("Audio Call - State change event | event "+c+" | PeerConnection "+avimpl.pc,null,null,!0),c==AV_CONNECTED?avimpl.callConnected(a):c==AV_FAILED&&avimpl.callFailure(b)}},avaction.addIceCandidate=function(a){LSDebugger.postDebugInfo("Audio Call - Inside Add Ice Candidate | data "+a+" | PeerConnection "+avimpl.pc,null,null,!0);var b=JSON.parse(a.msg.candidate),c=new RTCIceCandidate({sdpMid:b.id,sdpMLineIndex:b.label,candidate:b.candidate});avimpl.pc.addIceCandidate(c)},avaction.checkMediaPermission=function(){avimpl.getMediaApi=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||null;if(!avimpl.getMediaApi)return!1;avimpl.getMediaApi.call(navigator,avaction.constraints[avaction.TYPE],function(a){mediafailureoffer(null),avimpl.mediaStream=a},function(a){mediafailureoffer(a)})},avaction.sendLog=function(){LSDebugger.postDebugInfo("Audio Call - Inside Filure offer | PeerConnection "+avimpl.pc,null,null,!0)},avaction.getBrowserFromUserAgent=function(a){var b=a.toLowerCase(),c="unknown-unknown";if(b.indexOf("msie")>-1){var d=a.substring(a.indexOf("MSIE")).split(";")[0];c=d.split(" ")[0].replace("MSIE","IE")+"-"+d.split(" ")[1]}else b.indexOf("edge")>-1?c=a.substring(a.indexOf("Edge")).split(" ")[0].replace("/","-"):b.indexOf("safari")>-1&&b.indexOf("version")>-1?c=a.substring(a.indexOf("Safari")).split(" ")[0].split("/")[0]+"-"+a.substring(a.indexOf("Version")).split(" ")[0].split("/")[1]:b.indexOf("opr")>-1||b.indexOf("opera")>-1?b.indexOf("opera")>-1?c=a.substring(a.indexOf("Opera")).split(" ")[0].split("/")[0]+"-"+a.substring(a.indexOf("Version")).split(" ")[0].split("/")[1]:b.indexOf("opr")>-1&&(c=a.substring(a.indexOf("OPR")).split(" ")[0].replace("/","-").replace("OPR","Opera")):b.indexOf("chrome")>-1?c=a.substring(a.indexOf("Chrome")).split(" ")[0].replace("/","-"):b.indexOf("firefox")>-1&&(c=a.substring(a.indexOf("Firefox")).split(" ")[0].replace("/","-"));return c},avaction.isBrowserSupported=function(a){var b=this.getBrowserFromUserAgent(a),c=b.split("-")[0],d=parseInt(b.split("-")[1]),e=!1;switch(c){case"Chrome":e=d>=23?!0:!1;break;case"Firefox":e=d>=22?!0:!1;break;case"Opera":e=d>=18?!0:!1;break;case"Safari":e=d>=11?!0:!1}return e},avaction.displaySettingUI=function(a){var b={camera:[],mic:[],speaker:[]},c={};navigator.mediaDevices.enumerateDevices().then(function(a){a.forEach(function(a){c[a.kind+"&"+a.deviceId]=a,a.kind=="videoinput"?b.camera.push(a):a.kind=="audioinput"?b.mic.push(a):a.kind=="audiooutput"&&b.speaker.push(a)});var d='<div class="siq-setngs-view font16" id="audio_setting"> <div class="setngs-head c666"><span class="sel-bor" mdevice-switch="mic">Audio Input</span> <span mdevice-switch="speaker" >Sound Output</span> </div>';if(b.mic.length){var e=avimpl.localStream?avimpl.localStream.getAudioTracks()[0].label:"default";d+='<div class="setngs-optn c333 font14 mL20" mdevice-cnt="mic">',b.mic.forEach(function(a){var b="";e===a.deviceId&&(b='class="sqico-tick"'),d+="<div "+b+' deviceid="'+a.deviceId+'">'+a.label+"</div>"}),d+="</div>"}if(b.speaker.length){var e="default";d+='<div class="setngs-optn c333 font14 mL20" mdevice-cnt="speaker" style="display:none;">',b.speaker.forEach(function(a){var b="";e===a.deviceId&&(b='class="sqico-tick"'),d+="<div "+b+' deviceid="'+a.deviceId+'">'+a.label+"</div>"}),d+="</div>"}d+="</div>",$(window.parent.document).find("body").append(d),$("#audio_setting",parent.document).on("click","[mdevice-switch]",function(){$("#audio_setting",parent.document).find("[mdevice-switch]").removeClass("sel-bor");var a=$(this).addClass("sel-bor").attr("mdevice-switch");$("#audio_setting",parent.document).find("[mdevice-cnt]").hide(),$("#audio_setting",parent.document).find('[mdevice-cnt="'+a+'"]').show()}),$("#audio_setting",parent.document).on("click","[deviceid]",function(){var a=$(this).parent().attr("mdevice-cnt");$("#audio_setting",parent.document).find('[mdevice-cnt="'+a+'"]').children().removeClass("sqico-tick"),$(this).addClass("sqico-tick");if(a=="mic")return;var b=$(this).attr("deviceid"),c=document.getElementById("remoteaudio");typeof c.sinkId!="undefined"&&c.setSinkId(b).then(function(){})});var f=parent.document.getElementById("siqiframe").getBoundingClientRect(),g=document.getElementById("call_stngicon").getBoundingClientRect(),h=parent.document.getElementById("audio_setting").style;h.left=f.left+g.left-260+"px",h.top=f.top+g.top+15+"px",$(document).click(function(a){!$(a.target).closest("#audio_setting",parent.document).length&&!$(a.target).closest("#call_stngicon",parent.document).length&&$("#audio_setting",parent.document).is(":visible")&&$("#audio_setting",parent.document).hide()})})};$FAQ=function(){_searchtimer=0;var a=function(){return _SCHEMA+"://"+_EMBEDSERVERURL},b=function(b){var c=$Support.LSDB.getFromSession(l());if(c){b(c);return}$("#faqdiv").html($Temp.getLoadingHTML());var d=$Support.EmbedObj.mappeddept,e="";d&&d!=="-1"&&(e="department_id="+d),$Support.getParent().$ZSIQUtil.ajax(a()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages/count?"+e,function(a){var c=JSON.parse(a).data;$Support.LSDB.storeInSession(l(),c),b(c)},"",!0)},c=function(b,c){$Support.getParent().$ZSIQUtil.ajax(a()+"/"+_SCREENNAME+"/searchcanned.ls?query="+b+"&entities=2&mode=listview",function(a){var b=JSON.parse(a);b&&b[0].res_count==0&&(b=[]),c(b)},"",!0)},d=function(b,c){var d=$Support.LSDB.getFromSession("article_"+b)||{},e=d.article_info;if(d&&e&&e.content){c(d);return}$Support.getParent().$ZSIQUtil.ajax(a()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages/"+b,function(a){var d=JSON.parse(a).data;$Support.LSDB.storeInSession("article_"+b,d),c(d)},function(){},!0)},e=function(b,c,d,e){$.ajax({url:a()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages/"+c+"/vote?type="+e,type:"POST",dataType:"json",data:b,success:function(a){d(a)}})},f=function(b,c,d,e){var f=c?"_"+c:"",g=$Support.LSDB.getFromSession("faq_"+b+f);if(!e&&g){d(g);return}var h="",i=99;c?(h="&canned_category_id="+c,i=e?99:15,$("#"+c).html('<div class="cat_loading">'+$Temp.getLoadingHTML()+"</div>")):$("#faqdiv").html($Temp.getLoadingHTML());var h=c?"&canned_category_id="+c:"";$Support.getParent().$ZSIQUtil.ajax(a()+"/visitor/v2/"+_SCREENNAME+"/cannedmessages?limit="+i+"&department_id="+b+h,function(a){var b=JSON.parse(a).data;d(b)},function(){},!0)},g=function(a){var b=$Support.LSDB.getFromSession(l());if(b){var c=[];for(var d=0;d<b.length;d++)if(b[d].department_id===a){c=b[d].categoryinfo;break}var e="",g=[];for(var d=0;d<c.length;d++){var j=c[d].categoryid;e+='<div class="posrel" category_id="'+j+'" data-type="accordian"><div data-type="accordian-item"><div id="'+j+'"></div><div class="artcle-viewal" documentclick="extendview">'+LSResource.getRealValue("faq.article.viewall")+'</div></div><div data-type="accordian-header" class="dsp_table faq-cat"><div>'+c[d].categoryname+'</div><div class="sqico-darrow"></div></div></div>'}}var k=$("#faqdiv"),m=!k.find("#article-wrap").length;k.html('<div id="article-wrap">'+e+"</div>"),m&&k.hide().fadeIn(),$Support.Util.handleAccordian(function(a){var b=k.attr("department_id"),c=a.parent().attr("category_id");f(b,c,function(a){$Support.LSDB.storeInSession("faq_"+b+"_"+c,a),h(b,"",a,c),a.length>15&&i(c)})}),$('[data-type="accordian-header"]:first').trigger("click")},h=function(a,b,c,d){c=c||$Support.LSDB.getFromSession("faq_"+a);var e=k(b),f=0,g="",h=[];for(var i=0;i<c.length;i++){var l={};typeof c[i]=="object"&&(l=$Support.LSDB.getFromSession("article_"+c[i].id)||c[i]);if(getObjectSize(l)===0)continue;var m=CommonUtil.decodeHTML(l.message).replace(/<br *\/?>/gi," "),n=l.visitors_liked?'<em class="sqico-like">'+l.visitors_liked+"</em>":"",o=l.visitors_viewed?"<em viewid="+l.id+">"+l.visitors_viewed+"</em>"+" "+LSResource.getRealValue("faq.views")+"":LSResource.getRealValue("faq.noviews");g+='<div class="dsp_table faqarticle" documentclick="faqpreview" article-id="'+l.id+'">'+'<div class="sqico-faqarticle"></div>'+'<div class="f15">'+getEncodedText(m)+'<p class="font14 article">'+o+n+"</p>"+"</div>"+"</div>",h.push(l.id),f++}e&&$("#"+d).html(g),f&&!e&&$("#faqdiv").html(g),f||$("#faqdiv").html(j(b))},i=function(a){$("#"+a).addClass("view_article"),$(".artcle-viewal").attr("categoryid",a)},j=function(a){a=a||"";var b=a?LSResource.getRealValue("faq.noarticles"):LSResource.getRealValue("faq.empty.articles"),c=$Support.EmbedObj.chatID==-1?LSResource.getRealValue("ne.chatnow"):LSResource.getRealValue("ne.gotochat"),d=$Support.EmbedObj.status?'<div class="chatnw"><em class="wincustom_clr" documentclick="showchatui">'+c+"</em></div>":"";return'<div class="nofaq"><div class="faq-reslt-img"></div><p>'+a+"</p>"+b+d+"</div>"},k=function(a){if(a)return!1;var b=$Support.EmbedObj.faqaccess;return b.length?$Support.EmbedObj.faqaccess[1].orderbycategory=="1":!1},l=function(a){return a?"faq_"+a:"faq_count"},m=function(a,b){var c="";for(var d=0;d<a.length;d++){var e=a[d],f=e.count;if(f===0)continue;var g=e.department_name;if(typeof b!="undefined"&&g.toLowerCase().indexOf(b.toLowerCase())===-1)continue;f=f===1?f+" "+LSResource.getRealValue("faq.article")+"":f+" "+LSResource.getRealValue("faq.articles"),c+='<div class="dsp_table faqlst" documentclick="faqcategory" department="'+g+'" departmentid="'+e.department_id+'">'+'<div class="sqico-faqdept"></div>'+"<div>"+g+'<p class="font14 article">'+f+"</p>"+"</div>"+"</div>"}var h=$("#faqdiv");if(!c){h.html(j(b));return}var i=!h.find(".faqlst").length;h.html(c),i&&h.hide().fadeIn()},n=function(a){$(".faq-srch").remove();var b=a.title||"";b=a.hasarrow?'<span class="sqico-larrow" documentclick="showfaq"></span>'+b:b;var c=a.desc||"",d=a.classname||"";$("#attname").html(b),$("#attabtme").html(c).after('<div class="faq-srch min-view" documentclick="faqsearch"><span class="sqico-search"></span><input type="text" id="faqsearch-field" placeholder="'+LSResource.getRealValue("faq.search.hint")+'" dockeyup="searchfaq" dockeydown="searchfaq"/><em class="sqico-close"></em></div>');var e=$Support.container.attr("themeid")==="2"?$("#cmpylogo"):$("header");e.removeClass("category").addClass(d)},o=function(a){var b=$Support.EmbedObj.status?'<div class="zsiq-cbtn" onclick="$ZSIQChatWindow.startChat(event)">{CHATNOW}</div>':"",c='<div class="zsiq_prv_main" zsiqclose="true" id="zsiqimagepreview" onclick="$ZSIQChatWindow.closeImagePreview(event)"><div id="zsiqfaqpreview" articleid="{ARTICLEID}"><div class="zsiq-prev-body"><div class="zsiq-prev-header" id="zsiq-prev-header">{HEADER}</div><div class="zsiq-prev-content"><div>{CONTENT}</div></div></div><div class="zsiq-footer">'+u()+b+"{VOTE}"+"</div>"+'<em class="sqico-close" zsiqclose="true" onclick="$ZSIQChatWindow.closeImagePreview(event)"></em>'+"</div>"+"</div>";return c},p=function(){var a="https://img.zohostatic.com/salesiq/July_09_2018_1_https/images/articleemptystate.svg",b='<div class="zsiq_prv_main" zsiqclose="true" id="zsiqimagepreview" onclick="$ZSIQChatWindow.closeImagePreview(event)"><div id="zsiqfaqpreview" class="siq-empty-slate" articleid="{ARTICLEID}"><div class="zsiq-prev-body"><div class="siq-emtyimg"><img src="'+a+'"></div>'+'<p class="siq-emtydesc">'+LSResource.getRealValue("faq.empty.desc")+"</p></div>"+'<div class="zsiq-footer">'+u()+"</div>"+'<em class="sqico-close" zsiqclose="true" onclick="$ZSIQChatWindow.closeImagePreview(event)"></em>'+"</div>"+"</div>";return b},q=function(a){var b=a.visitors_liked||"",c=a.visitors_disliked||"";return'<div class="zsiq-aside">'+LSResource.getRealValue("faq.ishelpful")+'<span class="sqico-like" onclick="$ZSIQChatWindow.updateVote(event, this)" data-vote="3">'+b+'</span><span class="sqico-dislike" onclick="$ZSIQChatWindow.updateVote(event, this)"  data-vote="4">'+c+"</span></div>"},r=function(a,b){a=a||"";var c=$Support.LSDB.getFromSession(l(a));if(a)for(var d in c)if(b===c[d].id)return c[d];return c},s=function(a,b){var c=$Support.LSDB.getFromSession("article_"+a.id[0]),d={2:"visitors_viewed",3:"visitors_liked",4:"visitors_disliked"},e=a.type[0];c[d[e]]=parseInt(c[d[e]])+1,$Support.LSDB.storeInSession("article_"+a.id[0],c),b.find("em[viewid="+a.id+"]").text(c[d[e]])},t=function(a){var c=$("#faqdiv").attr("department_id");if(c){if(a===""&&k()){g(c);return}h(c,a)}else b(function(a){m(a)})},u=function(){return'<div id="faqbox" class="siq_content"><div class="zsiq-wrap"><div class="zsiq-wrap-body"><div class="zsiq-wrap-child"><span>Q</span><div class="zsiq-wrp-lne"></div></div><div class="zsiq-wrap-child"><span>A</span><div class="zsiq-wrp-lne"></div></div></div><div class="zsiq-wrap-body2"><div class="zsiq-wrap-child"><span>Q</span><div class="zsiq-wrp-lne"></div></div><div class="zsiq-wrap-child"><span>A</span><div class="zsiq-wrp-lne"></div></div></div></div><div id="faqdiv"></div></div>'};return{showFAQUI:function(a){if($Support.Util.isPreview())return;var c=$("#faqdiv");c.length||($("footer").before(u()),c=$("#faqdiv")),a.addClass("sel").prev(".sel").removeClass("sel"),c.parents(".siqembed").children("section").hide(),b(function(a){m(a)}),$Support.Util.updateViewAttribute("faqview"),n({title:$Support.Util.getFAQLabel(),desc:LSResource.getRealValue("faq.header.desc")}),$Support.Util.calculateContentHeight(),$("#faqdiv").removeAttr("department_id")},showCategory:function(a){if($Support.Util.isPreview())return;var b=a.attr("departmentid");$("#faqdiv").attr("department_id",b),k()?g(b):f(b,"",function(a){$Support.LSDB.storeInSession("faq_"+b,a),h(b,"",a)}),n({title:a.attr("department"),classname:"category",hasarrow:!0})},handleSearch:function(a){if($Support.Util.isPreview())return;a.removeClass("min-view category");var b=a.find("input").focus();a.find(".sqico-close").on("click",function(c){a.addClass("min-view"),b.val(""),$FAQ.searchFAQ(b),c.stopPropagation()})},showFAQPreview:function(a){var b=a.attr("article-id"),c=$Support.getParent().$ZSIQUtil.getCookieValue("Article_"+b);d(b,function(d){if(!d||!d.message){$(window.parent.document).find("body").append(p());return}e(JSON.stringify({type:"2"}),b,function(b){s(b,a)},2);var f=o(),g=$Support.EmbedObj.chatID==-1?LSResource.getRealValue("ne.chatnow"):LSResource.getRealValue("ne.gotochat"),h=c===""?q(d):"";f=f.replace(/{HEADER}/g,d.message).replace(/{ARTICLEID}/g,b).replace(/{VOTE}/g,h).replace(/{CHATNOW}/g,g).replace(/{CONTENT}/g,d.article_info.content),$(window.parent.document).find("body").append(f)})},updateVote:function(a,b){b=$(b);var c=JSON.stringify({type:b.attr("data-vote")}),d=b.parents("#zsiqfaqpreview");e(c,d.attr("articleid"),function(a){s(a,b),b.parent().html(LSResource.getRealValue("faq.feedback"))},b.attr("data-vote"))},getCustomCard:function(a){var b=JSON.parse(CommonUtil.decodeHTML(a)),c="";if(typeof b=="object"){var d=b.owner_imgkey?_SCHEMA+"://"+_EMBEDSERVERURL+"/"+_SCREENNAME+"/userimg/"+b.owner_imgkey+"/photo.ls?nocache=1":"";c='<div class="ext-msg-card" documentclick="faqpreview" article-id="'+b.id+'">'+'<div class="card-header">'+'<em class="ext-icon">?</em><span class="dsplycell">'+b.header+"</span>"+"</div>"+'<div class="card-footer">'+'<img src="'+d+'" />'+LSResource.getRealValue("faq.articleby")+" <em>"+b.ownername+"</em>"+"</div>"+"</div>"}return c},getHeaderMessage:function(a){var b=JSON.parse(CommonUtil.decodeHTML(a));return typeof b=="object"?b.header:""},searchFAQ:function(a,b){clearTimeout(_searchtimer);var d=$Support.Util.getKeyCode(b);if(["37","38","39","40","13","9","16"].indexOf(d)>-1)return;var e=$.trim(a.val()).toLowerCase();if(!e||e.length<3){t(e);return}_searchtimer=setTimeout(function(){c(e,function(b){if(e!==a.val().toLowerCase())return;h("",e,b)})},500)},updateMessageCount:function(a){if(a==="newmsg"||a==="newchat"||a==="triggerchat"){var b=$Support.getUnreadCount();b&&($("#conv-tab").addClass("count").find(".siqc_eletype").show().html(b)[0].className="siqc_eletype")}},showAllArticlesInCategory:function(a){a.parent().find(".view_article").removeAttr("style").removeClass("view_article");var b=$("#faqdiv").attr("department_id"),c=a.attr("categoryid");f(b,c,function(a){h(b,"",a,c)},!0)}}}();